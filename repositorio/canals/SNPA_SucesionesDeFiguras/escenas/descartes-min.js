/*
 joel.espinosa@amite.mx
 @preserve 120810
 @license LGPL - http://www.gnu.org/licenses/lgpl.html
*/
var descartesJS=function(a){if(a.loadLib)return a;var g=2*Math.PI,d=360/g,c=g/360,b=Math.floor;a.rangeOK=1;a.radToDeg=function(a){return a*d};a.degToRad=function(a){return a*c};a.extend=function(a,b){if(a.prototype.__proto__)a.prototype.__proto__=b.prototype;else for(var d in b.prototype)b.prototype.hasOwnProperty(d)&&(a.prototype[d]=b.prototype[d]);a.prototype.uber=b.prototype};a.convertFont=function(a){var b=a.split(","),a="";"bold"==b[1].toLowerCase()?a+="Bold ":"italic"==b[1].toLowerCase()||"italics"==
b[1].toLowerCase()?a+="Italic ":"bold+italic"==b[1].toLowerCase()&&(a+="Italic Bold ");a+=b[2]+"px ";b=b[0].split(" ")[0].toLowerCase();return"serif"==b||"times new roman"==b||"timesroman"==b?a+"'Times New Roman'":"sansserif"==b||"arial"==b||"helvetica"==b?a+"Arial":a+"'Courier New'"};a.drawLine=function(a,d,c,g,i,j,k){a.lineWidth=k||1;a.strokeStyle=j||"black";j=a.lineWidth%2?0.5:0;a.beginPath();a.moveTo(b(d)+j,b(c)+j);a.lineTo(b(g)+j,b(i)+j);a.stroke()};a.getColor=function(a,d){if("string"==typeof d)return d;
var c=a.evalExpression(d),g=b(255*c[0][0]),i=b(255*c[0][1]),j=b(255*c[0][2]);return"rgba("+g+","+i+","+j+","+(1-c[0][3])+")"};a.getFeatures=function(){a.hasJavaSupport=navigator.javaEnabled();var b=navigator.appVersion.toLowerCase();a.hasTouchSupport=window.hasOwnProperty&&window.hasOwnProperty("ontouchstart")||b.match("android")&&!0;a.hasTouchSupport=navigator.userAgent.toLowerCase().match("qt")?!1:a.hasTouchSupport;b=document.createElement("canvas");a.hasCanvasSupport=b.getContext&&b.getContext("2d");
a.hasCanvasSupport&&(a.ctx=document.createElement("canvas").getContext("2d"))};a.openExternalFile=function(a){var b=null,d;d=!1;if(window.XMLHttpRequest)try{d=new XMLHttpRequest}catch(c){d=!1}else if(window.ActiveXObject)try{d=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{d=new ActiveXObject("Microsoft.XMLHTTP")}catch(j){d=!1}}d.open("GET",a,!1);try{d.send(null),b=d.responseText,b.match(String.fromCharCode(65533))&&(d.open("GET",a,!1),d.overrideMimeType("text/plain; charset=ISO-8859-1"),d.send(null),
b=d.responseText)}catch(k){console.log("El archivo ",a," no se pudo abrir"),b=null}return b};a.getCursorPosition=function(a){var b;a.touches?(a=a.touches[0],b=a.pageX,a=a.pageY):void 0!=a.pageX&&void 0!=a.pageY?(b=a.pageX,a=a.pageY):(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=a.clientY+document.body.scrollTop+document.documentElement.scrollTop);return{x:b,y:a}};a.buildSimpleRegularExpressionPattern=function(a){var b=a.trim(),a={ignoreAcents:!1,ignoreCaps:!1,regExp:null};
b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1),"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1)));"`"==b[0]&&"\u00b4"==b[b.length-1]&&(a.ignoreAcents=!0,b=b.substring(1,b.length-1),b[0]==b[b.length-1]&&"'"==b[0]&&(a.ignoreCaps=!0,b=b.substring(1,b.length-1)));"*"==b[0]&&"*"!=b[b.length-1]&&(b=b.substring(1)+"$");"*"!=b[0]&&"*"==b[b.length-1]&&(b="^"+b.substring(0,b.length-1));"*"==b[0]&&"*"==b[b.length-1]&&(b=b.substring(1,b.length-1));
b=b.replace(/\?/g,"[\\S\\s]{1}");a.regExp=b;return a};a.buildRegularExpresionsPatterns=function(b){for(var b=b.replace(/&squot;/g,"'").replace(/&amp;/g,"&").split("|"),d,c,g=0,i=b.length;g<i;g++){d=b[g].split("&");c=[];for(var j=0,k=d.length;j<k;j++)c.push(a.buildSimpleRegularExpressionPattern(d[j]));b[g]=c}return b};removeAcents=function(a){a=a.toString();return a.replace(/\u00e1/g,"a").replace(/\u00e9/g,"e").replace(/\u00ed/g,"i").replace(/\u00f3/g,"o").replace(/\u00fa/g,"u").replace(/\u00c1/g,
"A").replace(/\u00c9/g,"E").replace(/\u00cd/g,"I").replace(/\u00d3/g,"O").replace(/\u00da/g,"U").replace(/\u00f1/g,"n").replace(/\u00d1/g,"N")};a.escorrecto=function(b,d){for(var c=a.buildRegularExpresionsPatterns(b),g,i,d=removeAcents(d).toLowerCase(),j=0,k=c.length;j<k;j++){g=c[j];i=!0;for(var m=0,o=g.length;m<o;m++)g[m].regExp=removeAcents(g[m].regExp).toLowerCase(),i=i&&!!d.match(g[m].regExp);if(i)return 1}return 0};a.esCorrecto=function(b,d){for(var c=a.buildRegularExpresionsPatterns(b),g,i,
j=0,k=c.length;j<k;j++){g=c[j];i=!0;for(var m=0,o=g.length;m<o;m++)g[m].ignoreAcents&&(d=removeAcents(d),g[m].regExp=removeAcents(g[m].regExp)),g[m].ignoreCaps&&(d=d.toLowerCase(),g[m].regExp=g[m].regExp.toLowerCase()),i=i&&!!d.match(g[m].regExp);if(i)return 1}return 0};a.getTextWidth=function(b,d){a.ctx.font=d;return a.ctx.measureText(b).width};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.addCSSrules=function(){var a=document.createElement("meta");a.setAttribute("name",
"viewport");a.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=10.0, user-scalable=yes");document.head.appendChild(a);(a=document.getElementById("StyleDescartesApps2"))&&a.parentNode.removeChild(a);a=document.createElement("style");a.type="text/css";a.id="StyleDescartesApps2";a.setAttribute("rel","stylesheet");document.head.appendChild(a);a.innerHTML="div.DescartesAppContainer{ border: 0px solid black; position: relative; overflow: hidden; top: 0px; left: 0px; }\ndiv.DescartesLoader{ background-color : #efefef; position: absolute; overflow: hidden; -moz-box-shadow: 0px 0px 0px #888; -webkit-box-shadow: 0px 0px 100px #888; box-shadow: 0px 0px 100px #888; background-image: linear-gradient(bottom, rgb(187,187,187) 0%, rgb(239,239,239) 50%, rgb(187,187,187) 100%); background-image: -o-linear-gradient(bottom, rgb(187,187,187) 0%, rgb(239,239,239) 50%, rgb(187,187,187) 100%); background-image: -moz-linear-gradient(bottom, rgb(187,187,187) 0%, rgb(239,239,239) 50%, rgb(187,187,187) 100%); background-image: -webkit-linear-gradient(bottom, rgb(187,187,187) 0%, rgb(239,239,239) 50%, rgb(187,187,187) 100%); background-image: -ms-linear-gradient(bottom, rgb(187,187,187) 0%, rgb(239,239,239) 50%, rgb(187,187,                   187) 100%); top: 0px; left: 0px; }\ndiv.DescartesLoaderImage{ background-repeat: no-repeat; background-position: center; position: absolute; overflow: hidden; top: 0px; left: 0px; }\ncanvas.DescartesLoaderBar{ position: absolute; overflow: hidden; top: 0px; left: 0px; }\ncanvas.DescartesSpace2DCanvas, canvas.DescartesSpace3DCanvas, div.blocker{ position: absolute; overflow: hidden; left: 0px; top: 0px; }\ndiv.DescartesSpace2DContainer, div.DescartesSpace3DContainer{ position: absolute; overflow: hidden; line-height: 0px; }\ncanvas.DescartesButton{ position: absolute; cursor: pointer; }\ndiv.DescartesSpinnerContainer, div.DescartesTextFieldContainer{ background: lightgray; position: absolute; overflow: hidden; }\ninput.DescartesSpinnerField, input.DescartesTextFieldField, input.DescartesMenuField, input.DescartesScrollbarField{ font-family: Arial; padding: 0px; border: 1px inset #666666; position: absolute; top: 0px; }\nlabel.DescartesSpinnerLabel, label.DescartesMenuLabel, label.DescartesScrollbarLabel{ line-height: normal; font-family: Arial; padding-top: 0%; text-align: center; text-overflow: ellipsis; white-space: nowrap; overflow: hidden; background-color: lightgray; position: absolute; left: 0px; top: 0px; }\ndiv.DescartesGraphicControl{ border-style: none; position: absolute; }\nlabel.DescartesTextFieldLabel{ line-height: normal; font-family: Arial; padding-top: 0%; padding-bottom: 0%; text-align: center; text-overflow: ellipsis; white-space: nowrap; overflow: hidden; background-color: #e0e4e8; position: absolute; left: 0px; top: 0px; }\ndiv.DescartesTextAreaContainer{ position: absolute; overflow: hidden; background: #c0d0d8; }\nselect.DescartesMenuSelect{ font-family: Arial; padding-top: 0%; text-align: center; text-overflow: ellipsis; white-space: nowrap; overflow: hidden; background-color: white; position: absolute; left: 0px; top: 0px; }\ndiv.DescartesScrollbarContainer{ background: #eeeeee; overflow: hidden; position: absolute; }\n"};
a.addCSSrules();return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.sin,d=Math.floor,c=Math.random,b=Math.round,f=String.fromCharCode;a.Krypto=function(a){this.key=(a||0).toString()};a.Krypto.prototype.getKey=function(a){for(var b=Array(256),c=0;256>c;c++)b[c]=f(this.alfanum(d(Math.abs(7.5*(g(1*c-a)+g(1.4*c+a)+g(0.6*c-a)+g(2.2*c+a))))));return b.join("")};a.Krypto.prototype.encode=function(a){var b=d(31*c());this.key=this.getKey(b);return f(this.alfanum(b))+this.encripta(a)};
a.Krypto.prototype.decode=function(a){this.key=this.getKey(this.numalfa(a.charCodeAt(0)));return this.desencripta(a.substring(1))};a.Krypto.prototype.encripta=function(a){return this.bytesToString(this.encriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.encriptaAux=function(a){if(null==a||null==this.key)return null;for(var g=Array(3*a.length),f,i=0,j=a.length;i<j;i++)f=256*d(a[i]+128)+b(255*c())+65536*b(255*c()),f=d((f<<this.shift(i))/256),g[3*i]=this.alfanum(f%32),g[3*i+1]=this.alfanum(f/32%
32),g[3*i+2]=this.alfanum(f/1024%32);return g};a.Krypto.prototype.desencripta=function(a){return this.bytesToString(this.desencriptaAux(this.stringToBytes(a)))};a.Krypto.prototype.desencriptaAux=function(a){if(null==a||null==this.key)return null;for(var b=Array(a.length/3),c,g=0,f=b.length;g<f;g++)c=this.numalfa(a[3*g])+32*this.numalfa(a[3*g+1])+1024*this.numalfa(a[3*g+2]),c=d(256*c>>this.shift(g)),c=d(c/256)%256-128,0>c&&(c+=256),b[g]=c;return b};a.Krypto.prototype.alfanum=function(a){a=d(a);return 10>
a?48+a:87+a};a.Krypto.prototype.numalfa=function(a){return 58>a?a-48:a-87};a.Krypto.prototype.stringToBytes=function(a){for(var b=Array(a.length),d=0,c=a.length;d<c;d++)b[d]=a.charCodeAt(d);return b};a.Krypto.prototype.bytesToString=function(a){for(var b=0,d=a.length;b<d;b++)a[b]=f(a[b]);return a.join("")};a.Krypto.prototype.shift=function(a){a=this.numalfa(this.key.charCodeAt(a%this.key.length));a=d(a/2%8);0==a&&(a=4);return a};a.Krypto.prototype.parseByte=function(a){a=parseInt(a);a=0>a?0:a;return 255<
a?255:a};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animation=function(g,d){this.parent=g;var c=g.evaluator,b=c.parser,f=new a.Auxiliary(g);this.delay=d.delay?b.parse(d.delay):b.parse("60");this.loop=d.loop?d.loop:!1;this.auto=void 0==d.auto&&2==this.parent.version?!0:d.auto;this.controls=d.controls;this.init=f.splitInstructions(b,d.init);this.doExpr=f.splitInstructions(b,d.doExpr);d.whileExpr&&(this.whileExpr=b.parse(d.whileExpr));var e=this;this.animationExec=function(){for(var a=
0,b=e.doExpr.length;a<b;a++)c.evalExpression(e.doExpr[a]);e.parent.update();e.playing&&(c.evalExpression(e.whileExpr)||e.loop)?e.timer=setTimeout(e.animationExec,c.evalExpression(e.delay)):e.stop()};this.playing=!1;this.auto&&this.play()};a.Animation.prototype.play=function(){this.playing?this.stop():(this.reinit(),this.playing=!0,this.timer=setTimeout(this.animationExec,this.parent.evaluator.evalExpression(this.delay)))};a.Animation.prototype.stop=function(){this.playing=!1;clearInterval(this.timer)};
a.Animation.prototype.reinit=function(){for(var a=0,d=this.init.length;a<d;a++)this.parent.evaluator.evalExpression(this.init[a])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Action=function(a){this.parent=a;this.evaluator=this.parent.evaluator};a.Action.prototype.execute=function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Message=function(g,d){a.Action.call(this,g,d);this.parameter=d};a.extend(a.Message,a.Action);a.Message.prototype.execute=
function(){alert(this.parameter)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Calculate=function(g,d){a.Action.call(this,g,d);var c=this.evaluator,b=c.parser;this.parameter=d.replace(/&squot;/g,"'");this.parameter=this.parameter.replace(/;/g,"\\n");this.parameter=this.parameter.split("\\n")||[""];for(var f=[],e,l=0,h=this.parameter.length;l<h;l++)(e=b.parse(this.parameter[l],!0))&&f.push(e);this.parameter=f;this.actionExec=function(){for(var a=0,b=this.parameter.length;a<
b;a++)c.evalExpression(this.parameter[a])}};a.extend(a.Calculate,a.Action);a.Calculate.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.OpenURL=function(g,d){a.Action.call(this,g,d);this.parameter=d;this.target="_blank";var c=this.parameter.indexOf("target");-1!=c&&(this.target=this.parameter.substring(c),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,c-1));"javascript"==
this.parameter.substring(0,10)?(this.javascript=!0,this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target)})};a.extend(a.OpenURL,a.Action);a.OpenURL.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),
descartesJS=function(a){if(a.loadLib)return a;a.OpenScene=function(g,d){a.Action.call(this,g,d);this.parameter=d;this.target="_blank";var c=this.parameter.indexOf("target");-1!=c&&(this.target=this.parameter.substring(c),this.target=this.target.substring(this.target.indexOf("=")+1),this.parameter=this.parameter.substring(0,c-1));"javascript"==this.parameter.substring(0,10)?(this.javascript=!0,this.parameter=this.parameter.substring(11).replace(/&squot;/g,"'"),this.actionExec=function(){eval(this.parameter)}):
("http://"!=this.parameter.substring(0,7)&&(this.parameter=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+this.parameter),this.actionExec=function(){window.open(this.parameter,this.target)})};a.extend(a.OpenScene,a.Action);a.OpenScene.prototype.execute=function(){this.actionExec()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.About=function(g,d){a.Action.call(this,g,d);this.urlAbout=null;""!=d&&(this.urlAbout=window.location.href.substring(0,
window.location.href.lastIndexOf("/")+1)+d)};a.extend(a.About,a.Action);a.About.prototype.execute=function(){console.log(this.urlAbout);if(this.urlAbout)var a=window.open(this.urlAbout,"_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes");else a=window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes"),a.document.write("<hmtl><head><title>Cr\u00e9ditos</title></head><body><h1>Aqu\u00ed van los cr\u00e9ditos</h1></body></html>")};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.Config=function(g,d){a.Action.call(this,g,d)};a.extend(a.Config,a.Action);a.Config.prototype.execute=function(){window.open("about:blank","_blank","width=800px,height=600px,location=no,menubar=no,scrollbars=yes").document.write("<xmp style='width:100%; height:100%;'>"+this.parent.applet.outerHTML+"</xmp>")};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Init=function(g,d){a.Action.call(this,g,d)};a.extend(a.Init,a.Action);
a.Init.prototype.execute=function(){this.parent.init()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Clear=function(g,d){a.Action.call(this,g,d)};a.extend(a.Clear,a.Action);a.Clear.prototype.execute=function(){this.parent.clear()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Animate=function(g,d){a.Action.call(this,g,d)};a.extend(a.Animate,a.Action);a.Animate.prototype.execute=function(){this.parent.play()};return a}(descartesJS||{}),descartesJS=
function(a){if(a.loadLib)return a;a.InitAnimation=function(g,d){a.Action.call(this,g,d)};a.extend(a.InitAnimation,a.Action);a.InitAnimation.prototype.execute=function(){this.parent.reinitAnimation()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.PlayAudio=function(g,d){a.Action.call(this,g,d);this.filenameExpr=this.evaluator.parser.parse("'"+d.split(" ")[0].trim()+"'");this.filename=this.evaluator.evalExpression(this.filenameExpr);this.theAudio=this.parent.getAudio(this.filename)};
a.extend(a.PlayAudio,a.Action);a.PlayAudio.prototype.execute=function(){this.filename=this.evaluator.evalExpression(this.filenameExpr);theAudio=this.parent.getAudio(this.filename);theAudio.paused?theAudio.play():(theAudio.pause(),theAudio.currentTime=0.1)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Auxiliary=function(a,d){this.parent=a;this.evaluator=this.parent.evaluator;var c=a.evaluator.parser;this.expresion=this.id="";this.evaluate="onlyOnce";this.size=c.parse("3");
this.rows=c.parse("3");this.columns=c.parse("3");for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b])};a.Auxiliary.prototype.firstRun=function(){};a.Auxiliary.prototype.update=function(){};a.Auxiliary.prototype.splitInstructions=function(a,d){for(var c,b=[],d=d?d.split(";"):[""],f=0,e=d.length;f<e;f++)(c=a.parse(d[f],!0))&&b.push(c);return b};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Variable=function(g,d){a.Auxiliary.call(this,g,d);var c=this.evaluator.parser;this.expresionString=
this.expresion;(this.expresion=c.parse(this.expresionString))&&c.setVariable(this.id,this.expresion);this.editable&&this.registerTextField()};a.extend(a.Variable,a.Auxiliary);a.Variable.prototype.registerTextField=function(){var a=document.createElement("div"),d=document.createElement("label");d.appendChild(document.createTextNode("_"+this.id+"=_"));var c=document.createElement("input");c.value=this.expresionString;c.disabled=!this.editable;a.appendChild(d);a.appendChild(c);var b=this;c.onkeydown=
function(a){13==a.keyCode&&(b.expresion=b.evaluator.parser.parse(this.value),b.evaluator.parser.setVariable(b.id,b.expresion),b.parent.update())};this.parent.editableRegion.textFields.push({container:a,type:"div"})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Constant=function(g,d){a.Auxiliary.call(this,g,d);this.expresion=this.evaluator.parser.parse(this.expresion);this.update()};a.extend(a.Constant,a.Auxiliary);a.Constant.prototype.update=function(){this.evaluator.setVariable(this.id,
this.evaluator.evalExpression(this.expresion))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector=function(g,d){a.Auxiliary.call(this,g,d);var c=this.evaluator,b=c.parser;this.expresion=this.expresion.split(";");var f;if(this.file){var e=document.getElementById(this.file);e&&"descartes/vectorFile"==e.type?(f=e.text,"\n"==f[0]&&(f=f.substring(1))):f=a.openExternalFile(this.file);null!=f&&(f=f.split("\n"));null==f||1==f.length&&""==f[0]?(f=[],this.size=0):(this.expresion=
[],this.size=b.parse(f.length.toString()));for(var l,e=0,h=f.length;e<h;e++)this.expresion[e]=this.id+"["+e+"]="+f[e],(l=f[e].match(/[\w-//]*(.png|.jpg|.gif|.svg|.PNG|.JPG|.GIF|.SVG)/g))&&this.parent.getImage(l)}e=0;for(h=this.expresion.length;e<h;e++)(f=b.parse(this.expresion[e],!0))&&"asign"!=f.type&&(f=b.parse(this.id+"["+e+"]="+this.expresion[e],!0)),this.expresion[e]=f;h=c.evalExpression(this.size);b=[];for(e=0;e<h;e++)b.push(0);c.vectors[this.id]=b;this.update()};a.extend(a.Vector,a.Auxiliary);
a.Vector.prototype.update=function(){var a=this.evaluator;a.setVariable(this.id+".long",a.evalExpression(this.size));for(var d=0,c=this.expresion.length;d<c;d++)a.evalExpression(this.expresion[d])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Matrix=function(g,d){a.Auxiliary.call(this,g,d);var c=this.evaluator;this.expresion=this.splitInstructions(c.parser,this.expresion);for(var b=c.evalExpression(this.rows),f=[],e,l=0,h=c.evalExpression(this.columns);l<h;l++){e=[];
for(var i=0,j=b;i<j;i++)e.push(0);f[l]=e}c.matrices[this.id]=f;this.update()};a.extend(a.Matrix,a.Auxiliary);a.Matrix.prototype.update=function(){var a=this.evaluator;a.setVariable(this.id+".filas",a.evalExpression(this.rows));a.setVariable(this.id+".columnas",a.evalExpression(this.columns));for(var d=0,c=this.expresion.length;d<c;d++)a.evalExpression(this.expresion[d])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Function=function(g,d){a.Auxiliary.call(this,g,d);var c=
this.evaluator,b=c.parser,f=this.id.indexOf("(");this.name=this.id.substring(0,f);this.params=this.id.substring(f+1,this.id.length-1);this.domain=this.range?b.parse(this.range):b.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.init=this.splitInstructions(b,this.init);this.doExpr=this.splitInstructions(b,this.doExpr);this.whileExpr&&(this.whileExpr=b.parse(this.whileExpr));this.expresion=b.parse(this.expresion);var e=this;this.functionExec=
this.algorithm?function(){if(e.numberOfParams==arguments.length){for(var b=[],d=0,f=e.params.length;d<f;d++){b[d]=c.getVariable(e.params[d]);c.setVariable(e.params[d],arguments[d])}d=0;for(f=e.init.length;d<f;d++)c.evalExpression(e.init[d]);do{d=0;for(f=e.doExpr.length;d<f;d++)c.evalExpression(e.doExpr[d])}while(c.evalExpression(e.whileExpr));var g=c.evalExpression(e.expresion);a.rangeOK=c.evalExpression(e.domain);d=0;for(f=e.params.length;d<f;d++)c.setVariable(e.params[d],b[d]);return g}return 0}:
function(){if(e.numberOfParams==arguments.length){for(var b=[],d=0,f=e.params.length;d<f;d++){b[d]=c.getVariable(e.params[d]);c.setVariable(e.params[d],arguments[d])}var g=c.evalExpression(e.expresion);a.rangeOK=c.evalExpression(e.domain);d=0;for(f=e.params.length;d<f;d++)c.setVariable(e.params[d],b[d]);return g}return 0};c.setFunction(this.name,this.functionExec)};a.extend(a.Function,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.AuxSequence=function(g,d){a.Auxiliary.call(this,
g,d);var c=this.evaluator,b=c.parser,f=this.id.indexOf("(");this.name=this.id.substring(0,f);this.params=this.id.substring(f+1,this.id.length-1);this.domain=this.range?b.parse(this.range):b.parse("1");this.params=""==this.params?[]:this.params.split(",");this.numberOfParams=this.params.length;this.init=this.splitInstructions(b,this.init);this.doExpr=this.splitInstructions(b,this.doExpr);this.whileExpr&&(this.whileExpr=b.parse(this.whileExpr));this.expresion=b.parse(this.expresion);var e=this;this.functionExec=
this.algorithm?function(){if(e.numberOfParams==arguments.length){for(var b=[],d=0,f=e.params.length;d<f;d++){b[d]=c.getVariable(e.params[d]);c.setVariable(e.params[d],arguments[d])}d=0;for(f=e.init.length;d<f;d++)c.evalExpression(e.init[d]);do{d=0;for(f=e.doExpr.length;d<f;d++)c.evalExpression(e.doExpr[d])}while(c.evalExpression(e.whileExpr));var g=c.evalExpression(e.expresion);a.rangeOK=c.evalExpression(e.domain);d=0;for(f=e.params.length;d<f;d++)c.setVariable(e.params[d],b[d]);return g}return 0}:
function(){if(e.numberOfParams==arguments.length){for(var b=[],d=0,f=e.params.length;d<f;d++){b[d]=c.getVariable(e.params[d]);c.setVariable(e.params[d],arguments[d])}var g=c.evalExpression(e.expresion);a.rangeOK=c.evalExpression(e.domain);d=0;for(f=e.params.length;d<f;d++)c.setVariable(e.params[d],b[d]);return g}return 0};c.setFunction(this.name,this.functionExec)};a.extend(a.AuxSequence,a.Auxiliary);return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Algorithm=function(g,d){a.Auxiliary.call(this,
g,d);var c=this.evaluator,b=c.parser;this.init=this.splitInstructions(b,this.init);this.doExpr=this.splitInstructions(b,this.doExpr);this.whileExpr&&(this.whileExpr=b.parse(this.whileExpr));this.algorithmExec=function(){for(var a=0,b=this.init.length;a<b;a++)c.evalExpression(this.init[a]);do{a=0;for(b=this.doExpr.length;a<b;a++)c.evalExpression(this.doExpr[a])}while(c.evalExpression(this.whileExpr))}};a.extend(a.Algorithm,a.Auxiliary);a.Algorithm.prototype.update=function(){this.algorithmExec();"onlyOnce"==
this.evaluate&&(this.update=function(){})};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Event=function(g,d){a.Auxiliary.call(this,g,d);var c=this.evaluator;this.condition=c.parser.parse(this.condition);this.lastEvaluation=!1;this.action=this.parent.lessonParser.parseAction(this);"onlyOnce"==this.execution&&(this.eventExec=function(){c.evalExpression(this.condition)&&!this.lastEvaluation&&(this.lastEvaluation=!0,this.action.execute())});"alternate"==this.execution&&(this.eventExec=
function(){var a=c.evalExpression(this.condition);if(this.parent.version==3){if(a!=this.lastEvaluation){this.action.execute();this.lastEvaluation=a?true:false}}else if(a&&!this.lastEvaluation){this.action.execute();this.lastEvaluation=true}else if(!a&&this.lastEvaluation)this.lastEvaluation=false});"always"==this.execution&&(this.eventExec=function(){c.evalExpression(this.condition)&&this.action.execute()})};a.extend(a.Event,a.Auxiliary);a.Event.prototype.update=function(){this.eventExec()};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.Graphic=function(g,d){this.parent=g;var c=this.parent.evaluator.parser;this.evaluator=g.evaluator;this.spaceID="E0";this.type="";this.background=!1;2!=this.parent.version?(this.color="#20303a",this.parent.arquimedes&&(this.color="black")):this.color="blue";this.drawif=c.parse("1");this.abs_coord=!1;this.family=this.trace="";this.family_interval=c.parse("[0,1]");this.family_steps=c.parse("8");this.parameter="t";this.parameter_interval=c.parse("[0,1]");
this.parameter_steps=c.parse("8");this.fillM=this.fillP=this.fill="";this.width=-1;this.editable=!1;this.info="";this.font="Monospaced,PLAIN,12";this.fixed=!0;this.size=c.parse("2");this.text="";this.decimals=c.parse("2");this.spear=c.parse("8");this.arrow="#ee0022";this.center=c.parse("(0,0)");this.radius=c.parse("1");this.init=c.parse("0");this.end=c.parse("90");this.file="";this.inirot=c.parse("0");for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b]);void 0==this.expresion&&"macro"!=this.type&&(this.expresion=
c.parse("(0,0)"));this.space=this.getSpace();this.canvas=this.background?this.space.backgroundCanvas:this.space.canvas;this.ctx=this.canvas.getContext("2d");this.trace&&(this.traceCtx=this.space.backgroundCanvas.getContext("2d"));this.font=a.convertFont(this.font)};a.Graphic.prototype.getSpace=function(){for(var a=this.parent.spaces,d,c=0,b=a.length;c<b;c++)if(d=a[c],d.id==this.spaceID)return d;return a[0]};a.Graphic.prototype.getFamilyValues=function(){var a=this.evaluator,d=a.evalExpression(this.family_interval);
this.familyInf=d[0][0];this.familySup=d[0][1];this.fSteps=Math.round(a.evalExpression(this.family_steps));this.family_sep=0<this.fSteps?(this.familySup-this.familyInf)/this.fSteps:0};a.Graphic.prototype.drawFamilyAux=function(a,d,c){var b=this.evaluator;this.getFamilyValues();var f=b.getVariable(this.family);if(0<=this.fSteps)for(var e=0,l=this.fSteps;e<=l;e++)b.setVariable(this.family,this.familyInf+e*this.family_sep),b.evalExpression(this.drawif)&&(this.update(),this.drawAux(a,d,c));b.setVariable("_Text_H_",
0);b.setVariable(this.family,f)};a.Graphic.prototype.draw=function(a,d){""!=this.family?this.drawFamilyAux(this.ctx,a,d):this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.ctx,a,d))};a.Graphic.prototype.drawTrace=function(a,d){""!=this.family?this.drawFamilyAux(this.traceCtx,a,d):this.evaluator.evalExpression(this.drawif)&&(this.update(),this.drawAux(this.traceCtx,a,d))};a.Graphic.prototype.drawText=function(g,d,c,b,f,e,l,h,i,j){if("rtfNode"==d.type)g.fillStyle=f,g.strokeStyle=
f,g.textBaseline="alphabetic",d.draw(g,c,b,i,j,l);else{var c=c+(e.match("Arial")?-2:e.match("Times")?-2:0),k=this.evaluator;g.fillStyle=a.getColor(k,f);g.font=e;g.textAlign=l;g.textBaseline=h;this.fontSize=(this.fontSize=e.match(/(\d+)px/))?this.fontSize[1]:"10";this.border&&(g.strokeStyle=a.getColor(k,this.border),g.lineWidth=parseFloat(this.fontSize)/12);e=1.2*this.fontSize;if(d[0]&&d[0].type){l=0;for(h=d.length;l<h;l++)f=k.evalExpression(d[l],i,j),this.border&&g.strokeText(f,c,b+e*l),g.fillText(f,
c,b+e*l)}else{l=0;for(h=d.length;l<h;l++)f=d[l],this.border&&g.strokeText(f,c,b+e*l),g.fillText(f,c,b+e*l)}}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor,d=2*Math.PI;a.Equation=function(d,b){a.Graphic.call(this,d,b);this.width=-1==this.width?this.evaluator.parser.parse("1"):this.width;this.generateStroke();this.parseExpresion();(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Equation,a.Graphic);a.Equation.prototype.parseExpresion=
function(){if("compOperator"==this.expresion.type){var d=this.expresion.childs[0],b=this.expresion.childs[1];"identifier"==d.type&&"y"==d.value&&!b.contains("y")?(this.funExpr=b,this.drawAux=this.drawAuxFunY):"identifier"==b.type&&"y"==b.value&&!d.contains("y")?(this.funExpr=d,this.drawAux=this.drawAuxFunY):"identifier"==d.type&&"x"==d.value&&!b.contains("x")?(this.funExpr=b,this.drawAux=this.drawAuxFunX):"identifier"==b.type&&"x"==b.value&&!d.contains("x")&&(this.funExpr=b,this.drawAux=this.drawAuxFunX)}this.newt=
new a.R2Newton(this.evaluator,this.expresion)};a.Equation.prototype.generateStroke=function(){this.auxCanvas=document.createElement("canvas");var a=parseInt(this.evaluator.evalExpression(this.width));this.width_2=parseInt(a/2)||1;this.auxCanvas.setAttribute("width",a);this.auxCanvas.setAttribute("height",a);this.auxCtx=this.auxCanvas.getContext("2d");this.auxCtx.beginPath();this.auxCtx.arc(this.width_2,this.width_2,this.width_2,0,2*Math.PI,!1);this.auxCtx.fill()};a.Equation.prototype.update=function(){};
a.Equation.prototype.draw=function(){""!=this.family?this.drawFamilyAux(this.ctx,this.fill,this.color):(this.update(),this.drawAux(this.ctx,this.fill,this.color))};a.Equation.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Equation.prototype.drawAux=function(d,b,f){d.lineWidth=1;var b=this.evaluator,e=b.parser,l=this.space;a.getColor(b,this.color);d.fillStyle=f;f=b.evalExpression(this.width);g(f);e.getVariable("x");e.getVariable("y");var f=l.w,e=l.h,h=g(f/8);
3>h&&(h=3);var i=g(e/8);3>i&&(i=3);for(var j=[],k=new a.R2,m=new a.R2,o=new a.R2,q,p,r,n,t,v,u,s,y,x=g(i/2);x<e;x+=i)for(var z=g(h/2);z<f;z+=h)if(this.abs_coord?(p=this.newt.findZero(new a.R2(z,x)),b.setVariable("x",p.x),b.setVariable("y",p.y),q=new a.R2(p.x,p.y)):(p=this.newt.findZero(new a.R2(l.getRelativeX(z),l.getRelativeY(x))),b.setVariable("x",p.x),b.setVariable("y",p.y),q=new a.R2(l.getAbsoluteX(p.x),l.getAbsoluteY(p.y))),r=g(q.ix()),n=g(q.iy()),!(0>r||r>=f||0>n||n>=e||j[r+n*l.w]))if(j[r+n*
l.w]=!0,k.x=p.x,k.y=p.y,m.x=p.x,m.y=p.y,t=this.newt.getUnitNormal(),!(0==t.x&&0==t.y)){t.rotL90();o.x=t.x;o.y=t.y;u=v=0;for(s=!1;2>u;){s&&(o.x=-t.x,o.y=-t.y,p.x=k.x,p.y=k.y,m.x=p.x,m.y=p.y,q=this.abs_coord?new a.R2(p.x,p.y):new a.R2(l.getAbsoluteX(p.x),l.getAbsoluteY(p.y)),r=q.ix(),n=q.iy(),s=!1,v=0);this.abs_coord?(p.x+=o.x,p.y+=o.y):(p.x+=o.x/l.scale,p.y+=o.y/l.scale);p=this.newt.findZero(p);b.setVariable("x",p.x);b.setVariable("y",p.y);o.x=p.x-m.x;o.y=p.y-m.y;o.normalize();if(0==o.x&&0==o.y)break;
m.x=p.x;m.y=p.y;q=this.abs_coord?new a.R2(p.x,p.y):new a.R2(l.getAbsoluteX(p.x),l.getAbsoluteY(p.y));y=g(q.ix());q=g(q.iy());if(y!=r||q!=n)if(r=y,n=q,0<=r&&r<f&&0<=n&&n<e)if(v=0,j[r+n*l.w])break;else j[r+n*l.w]=!0,a.rangeOK&&d.drawImage(this.auxCanvas,r-this.width_2,n-this.width_2);else s=!0,u++;else 4<++v&&(s=!0,u++)}}};a.Equation.prototype.drawAuxFunY=function(d){var b=this.evaluator,f=this.space,e=f.w,g=1/f.scale,h=f.getAbsoluteY(0),i=b.evalExpression(this.width),j=a.getColor(b,this.color),k=a.getColor(b,
this.fillM),m=a.getColor(b,this.fillP);d.fillStyle=j;var o=f.getRelativeX(0),q,p,r,n;b.setVariable("x",o);for(var t=f.getAbsoluteX(o),v=f.getAbsoluteY(b.evalExpression(this.funExpr)),u=0,s,y,x=1;x<e;x++){q=o+x*g;b.setVariable("x",q);p=b.evalExpression(this.funExpr);b.setVariable("y",p);r=f.getAbsoluteX(q);n=f.getAbsoluteY(p);s=Math.min(u,p);y=Math.max(u,p);s={min:s,max:y};if(void 0!==p&&a.rangeOK&&b.evalExpression(this.drawif)&&!this.hasSingularity(g,q,"x",q-g,u,q,p,s)){if(this.fillM||this.fillP)d.lineWidth=
1,d.strokeStyle=n>h?k:m,d.beginPath(),d.moveTo(r+0.5,n),d.lineTo(r+0.5,h),d.stroke();d.lineWidth=i;d.strokeStyle=j;d.beginPath();d.moveTo(t,v);d.lineTo(r,n);d.stroke()}u=p||0;t=r;v=n}};a.Equation.prototype.drawAuxFunX=function(d){var b=this.evaluator,f=this.space,e=f.w,g=1/f.scale,h=f.getAbsoluteX(0),i=b.evalExpression(this.width),j=a.getColor(b,this.color),k=a.getColor(b,this.fillM),m=a.getColor(b,this.fillP);d.fillStyle=j;var o=f.getRelativeX(0),q,p,r,n;b.setVariable("x",o);for(var t=f.getAbsoluteX(b.evalExpression(this.funExpr)),
v=f.getAbsoluteY(o),u=0,s,y,x=1;x<e;x++)if(q=o+x*g,b.setVariable("y",q),p=b.evalExpression(this.funExpr),b.setVariable("x",p),r=f.getAbsoluteX(p),n=f.getAbsoluteY(q),s=Math.min(u,p),y=Math.max(u,p),s={min:s,max:y},void 0!==q&&a.rangeOK&&b.evalExpression(this.drawif)){if(!this.hasSingularity(g,q,"y",q-g,u,q,p,s)){if(this.fillM||this.fillP)d.lineWidth=1,d.strokeStyle=r>h?k:m,d.beginPath(),d.moveTo(r,n+0.5),d.lineTo(h,n+0.5),d.stroke();d.lineWidth=i;d.strokeStyle=j;d.beginPath();d.moveTo(t,v);d.lineTo(r,
n);d.stroke()}u=p||0;t=r;v=n}};a.Equation.prototype.hasSingularity=function(a,b,d,e,g,h,i,j){if(1.0E-12>Math.abs(h-e)||1.0E-8>Math.abs(h-e)&&Math.abs(i-g)>Math.abs(a))return!0;var k=!1,k=(e+h)/2;this.evaluator.setVariable(d,k);var m=this.evaluator.evalExpression(this.funExpr);j.min<=m&&m<=j.max?k=!1:(j.x=Math.min(j.min,m),j.y=Math.max(j.max,m),k=this.hasSingularity(a,b,d,e,g,k,m,j)||this.hasSingularity(a,b,d,k,m,h,i,j));this.evaluator.setVariable(d,b);return k};a.drawPixel=function(a,b,f,e){a.moveTo(b,
f);a.arc(b,f,e,0,d,!1)};a.Equation.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var b=this;a.onkeydown=function(a){13==a.keyCode&&(b.expresion=b.evaluator.parser.parse(this.value),b.parseExpresion(),b.parent.update())};this.parent.editableRegion.textFields.push(a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Curve=function(g,d){a.Graphic.call(this,g,d);this.width=-1==this.width?this.evaluator.parser.parse("1"):
this.width;(this.visible=2==this.parent.version&&void 0==this.visible?!0:!1)&&this.registerTextField()};a.extend(a.Curve,a.Graphic);a.Curve.prototype.update=function(){var a=this.evaluator,d=a.evalExpression(this.parameter_interval);this.paraInf=d[0][0];this.paraSup=d[0][1];this.pSteps=a.evalExpression(this.parameter_steps);this.paraSep=0<this.pSteps?Math.abs(this.paraSup-this.paraInf)/this.pSteps:0};a.Curve.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Curve.prototype.drawTrace=
function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Curve.prototype.drawAux=function(g,d,c){var b=this.evaluator,f=this.space,e=this.evaluator.evalExpression(this.width);0>=e&&(e=1.0E-6);g.lineWidth=e;g.lineCap="round";g.lineJoin="round";g.fillStyle=a.getColor(b,d);g.strokeStyle=a.getColor(b,c);d=b.getVariable(this.parameter);g.beginPath();b.setVariable(this.parameter,this.paraInf);e=b.evalExpression(this.expresion);this.exprX=this.abs_coord?e[0][0]:f.getAbsoluteX(e[0][0]);this.exprY=
this.abs_coord?e[0][1]:f.getAbsoluteY(e[0][1]);var l,h,i;this.rotateExp&&(l=a.degToRad(this.evaluator.evalExpression(this.rotateExp)),h=Math.cos(l),l=Math.sin(l),e=this.exprX*h-this.exprY*l,i=this.exprX*l+this.exprY*h,this.exprX=e,this.exprY=i);g.moveTo(this.exprX+0.5,this.exprY+0.5);for(c=1;c<=this.pSteps;c++)b.setVariable(this.parameter,this.paraInf+c*this.paraSep),e=b.evalExpression(this.expresion),this.exprX=this.abs_coord?e[0][0]:f.getAbsoluteX(e[0][0]),this.exprY=this.abs_coord?e[0][1]:f.getAbsoluteY(e[0][1]),
this.rotateExp&&(e=this.exprX*h-this.exprY*l,i=this.exprX*l+this.exprY*h,this.exprX=e,this.exprY=i),g.lineTo(this.exprX+0.5,this.exprY+0.5);this.fill&&g.fill();g.stroke();b.setVariable(this.parameter,d)};a.Curve.prototype.registerTextField=function(){var a=document.createElement("input");a.value=this.expresionString;a.disabled=!this.editable;var d=this;a.onkeydown=function(a){13==a.keyCode&&(d.expresion=d.evaluator.parser.parse(this.value),d.parent.update())};this.parent.editableRegion.textFields.push(a)};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=2*Math.PI;a.Sequence=function(d,c){a.Graphic.call(this,d,c)};a.extend(a.Sequence,a.Graphic);a.Sequence.prototype.update=function(){var d=this.evaluator,c=d.evalExpression(this.expresion);this.exprX=c[0][0];this.exprY=c[0][1];if(this.rotateExp){var b=a.degToRad(d.evalExpression(this.rotateExp)),c=Math.cos(b),f=Math.sin(b),b=this.exprX*c-this.exprY*f,c=this.exprX*f+this.exprY*c;this.exprX=b;this.exprY=c}d=d.evalExpression(this.range);
this.rangeInf=d[0][0];this.rangeMax=d[0][1]};a.Sequence.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Sequence.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Sequence.prototype.drawAux=function(d,c){var b=this.evaluator,f,e,l,h=Math.ceil(b.evalExpression(this.size)-0.4);d.fillStyle=a.getColor(b,c);d.beginPath();this.rangeInf>this.rangeMax&&(l=this.rangeInf,this.rangeInf=this.rangeMax,this.rangeMax=l);for(var i=b.getVariable("n"),
j=this.rangeInf,k=this.rangeMax;j<=k;j++)b.setVariable("n",j),l=b.evalExpression(this.expresion),this.exprX=l[0][0],this.exprY=l[0][1],this.abs_coord?f=l[0][1]:(f=this.space.getAbsoluteX(l[0][0]),e=this.space.getAbsoluteY(l[0][1])),d.moveTo(f,e),d.arc(f,e,h,0,g,!0);b.setVariable("n",i);d.fill();this.text!=[""]&&this.uber.drawText.call(this,d,this.text,f+h,e-h,this.color,this.font,"start","alphabetic",b.evalExpression(this.decimals),this.fixed)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var g=2*Math.PI;a.Point=function(d,c){a.Graphic.call(this,d,c)};a.extend(a.Point,a.Graphic);a.Point.prototype.update=function(){var d=this.evaluator,c=d.evalExpression(this.expresion);this.exprX=c[0][0];this.exprY=c[0][1];if(this.rotateExp){var c=a.degToRad(d.evalExpression(this.rotateExp)),d=Math.cos(c),b=Math.sin(c),c=this.exprX*d-this.exprY*b,d=this.exprX*b+this.exprY*d;this.exprX=c;this.exprY=d}};a.Point.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Point.prototype.drawTrace=
function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Point.prototype.drawAux=function(d,c){var b=this.evaluator,f=this.abs_coord?this.exprX:this.space.getAbsoluteX(this.exprX),e=this.abs_coord?this.exprY:this.space.getAbsoluteY(this.exprY),l=Math.ceil(b.evalExpression(this.size)-0.4);d.fillStyle=a.getColor(b,c);d.beginPath();d.arc(f,e,l,0,g,!0);d.fill();this.text!=[""]&&this.uber.drawText.call(this,d,this.text,f+l,e-l,this.color,this.font,"start","alphabetic",b.evalExpression(this.decimals),
this.fixed)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=2*Math.PI;a.Segment=function(d,c){a.Graphic.call(this,d,c);this.width=-1==this.width?this.evaluator.parser.parse("1"):this.width};a.extend(a.Segment,a.Graphic);a.Segment.prototype.update=function(){var d=this.evaluator,c=d.evalExpression(this.expresion);this.endPoints=[];for(var b=0,f=c.length;b<f;b++)this.endPoints[b]={x:c[b][0],y:c[b][1]};if(this.rotateExp)for(var b=a.degToRad(d.evalExpression(this.rotateExp)),
d=Math.cos(b),c=Math.sin(b),e,g,b=0,f=this.endPoints.length;b<f;b++)e=this.endPoints[b].x*d-this.endPoints[b].y*c,g=this.endPoints[b].x*c+this.endPoints[b].y*d,this.endPoints[b].x=e,this.endPoints[b].y=g};a.Segment.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Segment.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Segment.prototype.drawAux=function(d,c,b){var f=this.evaluator,e=f.evalExpression(this.width);0>=e&&(e=1.0E-6);d.lineWidth=
e;e=f.evalExpression(this.size);d.fillStyle=a.getColor(f,c);d.strokeStyle=a.getColor(f,b);d.lineCap="round";var c=10+d.lineWidth,b=0==d.lineWidth%2?0:0.5,l,h,i,j;this.abs_coord?(l=this.endPoints[0].x,h=this.endPoints[0].y,i=this.endPoints[1].x,j=this.endPoints[1].y):(l=this.space.getAbsoluteX(this.endPoints[0].x),h=this.space.getAbsoluteY(this.endPoints[0].y),i=this.space.getAbsoluteX(this.endPoints[1].x),j=this.space.getAbsoluteY(this.endPoints[1].y));e=f.evalExpression(this.size);0>e&&(e=0);d.beginPath();
d.moveTo(l+b,h+b);d.lineTo(i+b,j+b);this.text!=[""]&&this.uber.drawText.call(this,d,this.text,(l+i)/2+c,(h+j)/2-c,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed);d.stroke();d.beginPath();d.arc(l,h,e,0,g,!0);d.arc(i,j,e,0,g,!0);d.fill()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.Arrow=function(d,c){a.Graphic.call(this,d,c);this.width=-1==this.width?this.evaluator.parser.parse("5"):this.width};a.extend(a.Arrow,a.Graphic);
a.Arrow.prototype.update=function(){var d=this.evaluator,c=d.evalExpression(this.expresion);this.endPoints=[];for(var b=0,f=c.length;b<f;b++)this.endPoints[b]={x:c[b][0],y:c[b][1]};if(this.rotateExp)for(var b=a.degToRad(d.evalExpression(this.rotateExp)),d=Math.cos(b),c=Math.sin(b),e,g,b=0,f=this.endPoints.length;b<f;b++)e=this.endPoints[b].x*d-this.endPoints[b].y*c,g=this.endPoints[b].x*c+this.endPoints[b].y*d,this.endPoints[b].x=e,this.endPoints[b].y=g};a.Arrow.prototype.draw=function(){this.uber.draw.call(this,
this.arrow,this.color)};a.Arrow.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.arrow,this.trace)};a.Arrow.prototype.drawAux=function(d,c,b){var f=this.evaluator,e=this.space;f.evalExpression(this.size);var l=f.evalExpression(this.width);1>l&&(l=1);var h=Math.ceil(l/2),i=e.scale;this.vect=new a.Vector2D(this.endPoints[1].x-this.endPoints[0].x,this.endPoints[1].y-this.endPoints[0].y);var j=this.vect.vectorLength();this.angle=this.vect.angleBetweenVectors(a.Vector2D.AXIS_X);d.fillStyle=
a.getColor(f,c);d.strokeStyle=a.getColor(f,b);d.lineWidth=1;var k,m,o;this.abs_coord?(c=this.endPoints[0].x,k=this.endPoints[0].y,m=this.endPoints[1].x,e=this.endPoints[1].y):(c=e.getAbsoluteX(this.endPoints[0].x),k=e.getAbsoluteY(this.endPoints[0].y),m=e.getAbsoluteX(this.endPoints[1].x),e=e.getAbsoluteY(this.endPoints[1].y));o=f.evalExpression(this.spear);0>o&&(o=0);d.save();d.translate(c,k,j);this.abs_coord?0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?d.rotate(this.angle):d.rotate(-this.angle):
(j*=i,0<=this.vect.x&&0<=this.vect.y||0>=this.vect.x&&0<=this.vect.y?d.rotate(-this.angle):d.rotate(this.angle));d.beginPath();d.moveTo(-h+0.5,g(-h)+0.5);d.lineTo(g(j-o-l)+0.5,g(-h)+0.5);d.lineTo(g(j-2*o)+0.5,g(-o-h)+0.5);d.lineTo(g(j)+0.5,0);d.lineTo(g(j-2*o)+0.5,g(o+h)-0.5);d.lineTo(g(j-o-l)+0.5,g(h)-0.5);d.lineTo(-h+0.5,g(h)-0.5);d.closePath();d.stroke();d.fill();d.restore();this.text!=[""]&&this.uber.drawText.call(this,d,this.text,(c+m)/2,(k+e)/2,b,this.font,"start","alphabetic",f.evalExpression(this.decimals),
this.fixed)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Polygon=function(g,d){a.Graphic.call(this,g,d);this.width=-1==this.width?this.evaluator.parser.parse("1"):this.width};a.extend(a.Polygon,a.Graphic);a.Polygon.prototype.update=function(){var g=this.evaluator,d=g.evalExpression(this.expresion);this.endPoints=[];for(var c=0,b=d.length;c<b;c++)this.endPoints[c]={x:d[c][0],y:d[c][1]};if(this.rotateExp)for(var c=a.degToRad(g.evalExpression(this.rotateExp)),g=Math.cos(c),
d=Math.sin(c),f,e,c=0,b=this.endPoints.length;c<b;c++)f=this.endPoints[c].x*g-this.endPoints[c].y*d,e=this.endPoints[c].x*d+this.endPoints[c].y*g,this.endPoints[c].x=f,this.endPoints[c].y=e};a.Polygon.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Polygon.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Polygon.prototype.drawAux=function(g,d,c){var b=this.evaluator,f=b.evalExpression(this.width);0>=f&&(f=1.0E-6);g.lineWidth=f;g.fillStyle=
a.getColor(b,d);g.strokeStyle=a.getColor(b,c);g.lineCap="round";g.lineJoin="round";d=0==this.ctx.lineWidth%2?0:0.5;c=this.abs_coord?this.endPoints[0].x:this.space.getAbsoluteX(this.endPoints[0].x);b=this.abs_coord?this.endPoints[0].y:this.space.getAbsoluteY(this.endPoints[0].y);g.beginPath();g.moveTo(c+d,b+d);for(var f=1,e=this.endPoints.length;f<e;f++)c=this.abs_coord?this.endPoints[f].x:this.space.getAbsoluteX(this.endPoints[f].x),b=this.abs_coord?this.endPoints[f].y:this.space.getAbsoluteY(this.endPoints[f].y),
g.lineTo(c+d,b+d);this.fill&&g.fill();g.stroke()};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.Arc=function(d,c){a.Graphic.call(this,d,c);this.width=-1==this.width?this.evaluator.parser.parse("1"):this.width};a.extend(a.Arc,a.Graphic);a.Arc.prototype.update=function(){var d=this.evaluator,c=d.evalExpression(this.center);this.exprX=c[0][0];this.exprY=c[0][1];if(this.rotateExp){var b=a.degToRad(d.evalExpression(this.rotateExp)),c=Math.cos(b),f=Math.sin(b),
b=this.exprX*c-this.exprY*f,c=this.exprX*f+this.exprY*c;this.exprX=b;this.exprY=c}b=d.evalExpression(this.init);c=d.evalExpression(this.end);if("(expr)"==this.init.type&&"(expr)"==this.end.type||"[expr]"==this.init.type&&"[expr]"==this.end.type||"(expr)"==this.init.type&&"[expr]"==this.end.type||"[expr]"==this.init.type&&"(expr)"==this.end.type){this.vectors=!0;var d=b[0][0],f=b[0][1],e=c[0][0],g=c[0][1],c=Math.acos((1*d+0*f)/Math.sqrt(d*d+f*f)),b=Math.acos((1*e+0*g)/Math.sqrt(e*e+g*g));0<d&&0<f&&
!this.abs_coord&&(c=2*Math.PI-c);0<d&&0>f&&this.abs_coord&&(c=2*Math.PI-c);0>d&&0>f&&this.abs_coord&&(c=2*Math.PI-c);0>d&&0<f&&!this.abs_coord&&(c=2*Math.PI-c);0<e&&0<g&&!this.abs_coord&&(b=2*Math.PI-b);0<e&&0>g&&this.abs_coord&&(b=2*Math.PI-b);0>e&&0>g&&this.abs_coord&&(b=2*Math.PI-b);0>e&&0<g&&!this.abs_coord&&(b=2*Math.PI-b);d=Math.min(c,b);f=Math.max(c,b);c=d;b=f;b-c>Math.PI&&this.abs_coord&&(c=f,b=d);b-c<=Math.PI&&!this.abs_coord&&(c=f,b=d);this.iniAng=c;this.endAng=b}else this.vectors=!1,this.iniAng=
a.degToRad(b),this.endAng=a.degToRad(c)};a.Arc.prototype.draw=function(){this.uber.draw.call(this,this.fill,this.color)};a.Arc.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.fill,this.trace)};a.Arc.prototype.drawAux=function(d,c,b){var f=this.evaluator,e=this.space,l=this.abs_coord?g(this.exprX)+0.5:g(e.getAbsoluteX(this.exprX))+0.5,h=this.abs_coord?g(this.exprY)+0.5:g(e.getAbsoluteY(this.exprY))+0.5,i=f.evalExpression(this.radius);if(!this.vectors&&this.iniAng>this.endAng){var j=
this.iniAng;this.iniAng=this.endAng;this.endAng=j}0>i&&(i=0);j=!1;this.abs_coord||(i*=e.scale,this.vectors||(this.iniAng=-this.iniAng,this.endAng=-this.endAng,j=!0));this.vectors&&(j=this.abs_coord?!1:!0);e=f.evalExpression(this.width);0>=e&&(e=1.0E-6);d.lineWidth=e;d.lineCap="round";d.fillStyle=a.getColor(f,c);d.strokeStyle=a.getColor(f,b);this.fill&&(d.beginPath(),d.moveTo(l,h),d.arc(l,h,i,this.iniAng,this.endAng,j),d.fill());d.beginPath();d.arc(l,h,i,this.iniAng,this.endAng,j);d.stroke();this.text!=
[""]&&this.uber.drawText.call(this,d,this.text,l+1,h-1,this.color,this.font,"start","alphabetic",f.evalExpression(this.decimals),this.fixed)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Fill=function(g,d){a.Graphic.call(this,g,d)};a.extend(a.Fill,a.Graphic);a.Fill.prototype.update=function(){};a.Fill.prototype.draw=function(){this.uber.draw.call(this,this.color,this.color)};a.Fill.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.trace,this.trace)};a.Fill.prototype.drawAux=
function(){};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Text=function(g,d){a.Graphic.call(this,g,d);this.align||(this.align="start");-1==this.width&&(this.width=this.evaluator.parser.parse("0"));this.abs_coord=!0};a.extend(a.Text,a.Graphic);a.Text.prototype.update=function(){var g=this.evaluator,d=g.evalExpression(this.expresion);this.exprX=d[0][0];this.exprY=d[0][1];if(this.rotateExp){var d=a.degToRad(g.evalExpression(this.rotateExp)),g=Math.cos(d),c=Math.sin(d),d=
this.exprX*g-this.exprY*c,g=this.exprX*c+this.exprY*g;this.exprX=d;this.exprY=g}};a.Text.prototype.draw=function(){this.uber.draw.call(this,this.color)};a.Text.prototype.drawTrace=function(){this.uber.drawTrace.call(this,this.color)};a.Text.prototype.drawAux=function(a,d){var c=this.splitText(this.text);this.text!=[""]&&this.uber.drawText.call(this,a,c,parseFloat(this.exprX)+5,parseFloat(this.exprY),d,this.font,this.align,"hanging",this.evaluator.evalExpression(this.decimals),this.fixed)};a.Text.prototype.splitText=
function(a){var d=this.evaluator.evalExpression(this.width),c,b,f=[];this.ctx.font=this.font;this.fontSize=(this.fontSize=this.font.match(/(\d+)px/))?this.fontSize[1]:"10";if(20<=d&&"undefined"!=a.type){for(var e=0,l=a.length;e<l;e++)c=this.evaluator.evalExpression(a[e],this.evaluator.evalExpression(this.decimals),this.fixed).trim(),b=this.ctx.measureText(c).width,b>d?f=f.concat(this.splitWords(c,d)):f.push(c);a=Math.floor(1.2*this.fontSize)*f.length;this.evaluator.setVariable("_Text_H_",a);return f}this.evaluator.setVariable("_Text_H_",
0);this.evaluator.setVariable("_Text_W_",1E3);return a};a.Text.prototype.splitWords=function(a,d){var c=a,b=[],f,e,l,h,i=!1;do l=Math.floor(c.length*(d/this.ctx.measureText(c).width))+1,f=c.slice(0,l),""!=f&&" "==f[0]&&(c=c.slice(1),f=c.slice(0,l)),i=c[l-1]&&c[l]&&" "!=c[l-1]&&" "!=c[l],h=f.lastIndexOf(" "),e=this.ctx.measureText(f).width,e>=d?(l=-1!=h?h:l-1,f=c.slice(0,l)):i&&-1!=h&&(l=h,f=c.slice(0,l)),b.push(f),c=c.slice(l);while(""!=c);return b};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
a.Image=function(g,d){a.Graphic.call(this,g,d);this.img=new Image;this.img.ready=0;this.img.onload=function(){this.ready=1;this.onload=function(){}};this.img.src=this.evaluator.evalExpression(this.file);this.scaleY=this.scaleX=1};a.extend(a.Image,a.Graphic);a.Image.prototype.update=function(){var g=this.evaluator,d=g.evalExpression(this.expresion);this.exprX=d[0][0];this.exprY=d[0][1];if(this.rotateExp){var c=a.degToRad(g.evalExpression(this.rotateExp)),b=Math.cos(c),f=Math.sin(c),c=this.exprX*b-
this.exprY*f,b=this.exprX*f+this.exprY*b;this.exprX=c;this.exprY=b}if(4==d[0].length&&(this.centered=!0,this.scaleX=d[0][2],0==this.scaleX&&(this.scaleX=1.0E-5),this.scaleY=d[0][3],0==this.scaleY))this.scaleY=1.0E-5;if(d[1]&&2==d[1].length&&(this.centered=!0,this.scaleX=d[1][0],0==this.scaleX&&(this.scaleX=1.0E-5),this.scaleY=d[1][1],0==this.scaleY))this.scaleY=1.0E-5;if((g=g.evalExpression(this.file))||""==g)this.img=this.parent.getImage(g)};a.Image.prototype.draw=function(){this.uber.draw.call(this)};
a.Image.prototype.drawTrace=function(){this.uber.drawTrace.call(this)};a.Image.prototype.drawAux=function(g){var d=this.evaluator;if(this.img&&this.img.ready&&this.img.complete){var c=this.centered?0:this.img.width/2,b=this.centered?0:this.img.height/2,f=this.abs_coord?this.exprX:this.space.getAbsoluteX(this.exprX),e=this.abs_coord?this.exprY:this.space.getAbsoluteY(this.exprY),l=a.degToRad(-d.evalExpression(this.inirot));g.translate(f+c,e+b);g.rotate(l);g.scale(this.scaleX,this.scaleY);this.opacity&&
(g.globalAlpha=d.evalExpression(this.opacity));g.drawImage(this.img,-this.img.width/2,-this.img.height/2);g.setTransform(1,0,0,1,0,0);g.globalAlpha=1}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Macro=function(g,d){a.Graphic.call(this,g,d);this.graphics=[];var c=g.lessonParser,b=new a.Tokenizer,f;for(f in d)d.hasOwnProperty(f)&&(this[f]=d[f]);if(void 0!=this.expresion){this.expresion.match("'")||(this.expresion="'"+this.expresion+"'");this.expresion=this.evaluator.parser.parse(this.expresion);
f=this.expresion.value;var e,l=2;f&&((e=document.getElementById(f))&&"descartes/macro"==e.type?(e=e.text,l=3):(e=a.openExternalFile(f),e.match("tipo_de_macro")||(e=null)));var h="|";if(e){e=e.replace(/&aacute;/g,"\u00e1").replace(/&eacute;/g,"\u00e9").replace(/&iacute;/g,"\u00ed").replace(/&oacute;/g,"\u00f3").replace(/&uacute;/g,"\u00fa").replace(/&Aacute;/g,"\u00c1").replace(/&Eacute;/g,"\u00c9").replace(/&Iacute;/g,"\u00cd").replace(/&Oacute;/g,"\u00d3").replace(/&Uacute;/g,"\u00da").replace(/&ntilde;/g,
"\u00f1").replace(/&Ntilde;/g,"\u00d1").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/\&amp;/g,"&").split("\n").slice(l);var i,j;f=0;for(l=e.length;f<l;f++)e[f]&&(e[f]=c.split(e[f]),e[f]&&e[f][0]&&e[f][0][0]&&"id"==e[f][0][0]&&(i=e[f][0][1],j=i.indexOf("("),-1!=j&&(i=i.substring(0,j)),h+=i+"|"));var k,m,o,q;f=0;for(l=e.length;f<l;f++){k=e[f]||[];i=0;for(j=k.length;i<j;i++)if(m=babel[k[i][0]],o=k[i][0].indexOf("."),-1!=o&&(m=babel[k[i][0].substring(o+1)]),!("id"!=m&&"text"!=m&&"expresion"!=
m&&"interval"!=m&&"steps"!=m&&"drawif"!=m&&"size"!=m&&"width"!=m&&"center"!=m&&"radius"!=m&&"init"!=m&&"end"!=m&&"inirot"!=m&&"do"!=m&&"while"!=m&&"file"!=m&&"fill"!=m&&"color"!=m))if("text"==m)if(k[i][1].match(/\{\\rtf1/)){m=k[i][1];var p=this;q=function(a,d){for(var c=b.tokenize(d.replace(/\&squot;/g,"'")),e=0,f=c.length;e<f;e++)if(c[e].type=="identifier"&&h.match("\\|"+c[e].value+"\\|"))c[e].value=p.name+"."+c[e].value;else if(c[e].type=="identifier"&&(o=c[e].value.indexOf("."))!=-1&&h.match("\\|"+
c[e].value.substring(0,o)+"\\|"))c[e].value=p.name+"."+c[e].value;return(a.match(/^\\expr/)?"\\expr ":"\\decimals ")+b.flatTokens(c)};m=m.replace(/\\expr ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,q);m=m.replace(/\\decimals ([a-zA-Z_0-9\u00C0-\u021B+*/%|&^#!?:()><.']*)/gi,q);k[i][1]=m}else{q=c.parseText(k[i][1]);for(var r=0,n=q.length;r<n;r++){m=b.tokenize(q[r].replace(/\&squot;/g,"'"));for(var t=0,v=m.length;t<v;t++)"identifier"==m[t].type&&h.match("\\|"+m[t].value+"\\|")&&(m[t].value=this.name+
"."+m[t].value);m=b.flatTokens(m).replace(/&squot;/g,"'").replace(/'\+\(/g,"[").replace(/\)\+'/g,"]");q[r]=m.substring(1,m.length-1)}k[i][1]=q.join("\\n")}else{m=b.tokenize(k[i][1].replace(/\&squot;/g,"'"));q=0;for(r=m.length;q<r;q++)if("identifier"==m[q].type&&h.match("\\|"+m[q].value+"\\|"))m[q].value=this.name+"."+m[q].value;else if("identifier"==m[q].type&&-1!=(o=m[q].value.indexOf("."))&&h.match("\\|"+m[q].value.substring(0,o)+"\\|"))m[q].value=this.name+"."+m[q].value;k[i][1]=b.flatTokens(m)}}f=
0;for(l=e.length;f<l;f++)if(e[f][0]){k="";i=0;for(j=e[f].length;i<j;i++)e[f][i]="type"!=babel[e[f][i][0]]?e[f][i][0]+"='"+e[f][i][1]+"' ":"espacio='"+this.spaceID+"' "+e[f][i][0]+"='"+e[f][i][1]+"' ",k+=e[f][i];e[f]=k;k.match(/^espacio/)?this.graphics.push(c.parseGraphic(e[f],this.abs_coord,this.background,this.inirot)):c.parseAuxiliar(e[f])}}}};a.extend(a.Macro,a.Graphic);a.Macro.prototype.update=function(){if(this.inipos){var a=this.evaluator.evalExpression(this.inipos);this.iniPosX=a[0][0];this.iniPosY=
a[0][1]}};a.Macro.prototype.drawAux=function(a){for(var d=0,c=this.graphics.length;d<c;d++)this.inipos&&(this.graphics[d].abs_coord?a.translate(this.iniPosX,this.iniPosY):a.translate(this.iniPosX*this.space.scale,-this.iniPosY*this.space.scale)),this.graphics[d].draw(),a.setTransform(1,0,0,1,0,0)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.max,d=Math.min;a.R2=function(a,b){this.x=a||0;this.y=b||0};a.R2.prototype.copy=function(){return new a.R2(this.x,this.y)};
a.R2.prototype.ix=function(){return Math.round(g(d(this.x,32E3),-32E3))};a.R2.prototype.iy=function(){return Math.round(g(d(this.y,32E3),-32E3))};a.R2.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};a.R2.prototype.norm2=function(){return this.x*this.x+this.y*this.y};a.R2.prototype.norm=function(){return Math.sqrt(this.norm2())};a.R2.prototype.distance=function(a){var b=this.copy();b.sub(a);return b.norm()};a.R2.prototype.dot=function(a){return this.x*a.x+this.y*a.y};a.R2.prototype.det=
function(a){return this.x*a.y-this.y*a.x};a.R2.prototype.mul=function(a){this.x*=a;this.y*=a};a.R2.prototype.div=function(a){this.x/=a;this.y/=a};a.R2.prototype.add=function(a){this.x+=a.x;this.y+=a.y};a.R2.prototype.sub=function(a){this.x-=a.x;this.y-=a.y};a.R2.prototype.normalize=function(){var a=this.norm();0!=a&&this.div(a)};a.R2.prototype.rotR90=function(){var a=this.x;this.x=this.y;this.y=-a};a.R2.prototype.rotL90=function(){var a=this.x;this.x=-this.y;this.y=a};a.R2.prototype.rot=function(a){var b=
this.copy(),d=Math.cos(a),a=Math.sin(a);this.x=b.x*d-b.y*a;this.y=b.x*a+b.y*d};a.R2.prototype.rot=function(a){this.rot(a*Math.PI/180)};a.R2.prototype.intersection=function(c,b,f,e){var l=b.x-c.x,h=f.x-e.x,i=f.x-c.x,j=b.y-c.y,k=f.y-e.y,m=f.y-c.y,o=l*k-h*j;return 1.0E-6<Math.abs(o)?(b=(i*k-m*h)/o,f=(-i*j+m*l)/o,0<=b&&1>=b&&0<=f&&1>=f?new a.R2(c.x+l*b,c.y+j*b):null):(b.x-f.x)*m!=(b.y-f.y)*i?null:c.x!=b.x?(l=d(c.x,b.x),c=g(c.x,b.x),l<=f.x&&f.x<=c?f:l<=e.x&&e.x<=c?e:null):f.x!=e.x?(l=d(f.x,e.x),f=g(f.x,
e.x),l<=c.x&&c.x<=f?c:l<=b.x&&b.x<=f?b:null):c.y!=b.y?(l=d(c.y,b.y),c=g(c.y,b.y),l<=f.y&&f.y<=c?f:l<=e.y&&e.y<=c?e:null):f.y!=e.y?(l=d(f.y,e.y),f=g(f.y,e.y),l<=c.y&&c.y<=f?c:l<=b.y&&b.y<=f?b:null):c.x==f.x&&c.y==f.y?c:null};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.R2Newton=function(a,d){this.evaluator=a;this.constraint=d;if("=="==this.constraint.value||"<"==this.constraint.value||"<="==this.constraint.value||">"==this.constraint.value||">="==this.constraint.value)this.sign=
"<"==this.constraint.value||"<="==this.constraint.value?"menor":">"==this.constraint.value||">="==this.constraint.value?"mayor":"igual",this.constraint=this.constraint.equalToMinus(),this.constraint=this.constraint.childs[0]};a.R2Newton.prototype.getUnitNormal=function(){this.normal.normalize();return this.normal.copy()};a.R2Newton.prototype.gradient=function(g){var d=this.evaluator,c=new a.R2(0,0),b=d.getVariable("x"),f=d.getVariable("y");d.setVariable("x",g.x);d.setVariable("y",g.y);this.f0=d.evalExpression(this.constraint);
d.setVariable("x",d.getVariable("x")+1.0E-12);g=d.evalExpression(this.constraint);c.x=(g-this.f0)/1.0E-12;c.x=NaN!=c.x?c.x:Infinity;d.setVariable("x",d.getVariable("x")-1.0E-12);d.setVariable("y",d.getVariable("y")+1.0E-12);g=d.evalExpression(this.constraint);c.y=(g-this.f0)/1.0E-12;c.y=NaN!=c.y?c.y:Infinity;d.setVariable("x",b);d.setVariable("y",f);return c};a.R2Newton.prototype.findZero=function(a){var d=this.evaluator,c=a.copy(),b=d.getVariable("x"),f=d.getVariable("y");d.setVariable("x",a.x);
d.setVariable("y",a.y);this.f0=d.evalExpression(this.constraint);if("menor"==this.sign&&0>=this.f0||"mayor"==this.sign&&0<=this.f0)return c;d.setVariable("x",b);d.setVariable("y",f);for(f=0;256>f;f++)if(d=c.x,b=c.y,this.normal=this.gradient(c),0!=this.normal.norm2()&&this.normal.mul(-this.f0/this.normal.norm2()),c.x=d+this.normal.x,c.y=b+this.normal.y,1.0E-6>this.normal.norm()){0==this.normal.x&&0==this.normal.y&&(this.normal.x=c.x-a.x,this.normal.y=c.y-a.y);break}return c};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;var g=2*Math.PI;a.GraphicControl=function(d,c){this.parent=d;this.evaluator=d.evaluator;var b=this.evaluator.parser;this.id="G";this.type="";this.spaceID="E0";this.text="";this.expresion=b.parse("(0,0)");this.y=this.x=0;this.size=b.parse("4");this.fixed=2!=this.parent.version?!1:!0;this.color="#0000ff";this.colorInt="#ff0000";this.font="Monospaced,PLAIN,12";this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.drawif=
b.parse("1");this.activeif=b.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont="Monospace 12px";this.decimals=b.parse("2");this.zIndex=-1;for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.font=a.convertFont(this.font);this.constraintExpr&&(this.constraint=b.parse(this.constraintExpr),"(expr)"==this.constraint.type&&(this.constraint=b.parse(this.constraintExpr.substring(1,this.constraintExpr.length-1))),"compOperator"==this.constraint.type?
this.newt=new a.R2Newton(this.evaluator,this.constraint):this.constraint=null);this.container=this.getContainer();this.space=this.getSpace();this.mouseCacher=document.createElement("div");this.mouseCacher.setAttribute("class","DescartesGraphicControl");this.mouseCacher.setAttribute("id",this.id);this.mouseCacher.setAttribute("tabindex","-1");this.ctx=this.space.ctx;this.container.appendChild(this.mouseCacher);this.init();this.registerMouseEvents()};a.GraphicControl.prototype.init=function(){var d=
this.evaluator;this.mouseCacher.style.display=d.evalExpression(this.drawif)?"block":"none";var c=d.evalExpression(this.expresion);this.x=c[0][0];this.y=c[0][1];d.setVariable(this.id+".x",this.x);d.setVariable(this.id+".y",this.y);""!=this.imageSrc&&!this.imageSrc.toLowerCase().match(/vacio.gif$/)?(this.image=this.parent.getImage(this.imageSrc),this.width=this.image.width,this.height=this.image.height):(this.width=2*d.evalExpression(this.size),this.height=2*d.evalExpression(this.size));this._w=a.hasTouchSupport&&
70>this.width?70:this.width;this._h=a.hasTouchSupport&&70>this.height?70:this.height;this.constraint&&(c=this.newt.findZero(new a.R2(this.x,this.y)),this.x=c.x,this.y=c.y,d.setVariable(this.id+".x",this.x),d.setVariable(this.id+".y",this.y));this.mouseCacher.setAttribute("style","background-color: rgba(255, 255, 255, 0); width: "+this._w+"px; height: "+this._h+"px; z-index: "+this.zIndex+";");this.mouseCacher.style.left=parseInt(this.space.getAbsoluteX(this.x)-this._w/2)+"px";this.mouseCacher.style.top=
parseInt(this.space.getAbsoluteY(this.y)-this._h/2)+"px";d.setVariable(this.id+".activo",0)};a.GraphicControl.prototype.update=function(){var d=this.evaluator;this.x=d.getVariable(this.id+".x");this.y=d.getVariable(this.id+".y");var c=this.space.getAbsoluteX(this.x),b=this.space.getAbsoluteY(this.y);this.mouseCacher.style.left=c-this._w/2+"px";this.mouseCacher.style.top=b-this._h/2+"px";this.mouseCacher.style.display=d.evalExpression(this.activeif)?"block":"none";this.constraint&&(c=this.newt.findZero(new a.R2(this.x,
this.y)),this.x=c.x,this.y=c.y,d.setVariable(this.id+".x",this.x),d.setVariable(this.id+".y",this.y));this.draw()};a.GraphicControl.prototype.draw=function(){var d=this.evaluator;if(d.evalExpression(this.drawif)){var c=this.ctx,b=this.space.backgroundCtx,f=this.space.getAbsoluteX(this.x),e=this.space.getAbsoluteY(this.y);""!=this.text&&this.drawText(f,e);if(this.image.ready)this.image.complete&&c.drawImage(this.image,f-this.image.width/2,e-this.image.height/2),this.trace&&(b.save(),b.translate(f,
e),b.scale(this.image.width/2,this.image.height/2),b.beginPath(),b.arc(0,0,1,0,g,!1),b.restore(),b.lineWidth=1,b.strokeStyle=a.getColor(d,this.trace),b.stroke());else if(c.beginPath(),c.arc(f,e,this.width/2,0,g,!1),c.fillStyle=a.getColor(d,this.colorInt),c.fill(),c.lineWidth=1,c.strokeStyle=a.getColor(d,this.color),c.stroke(),this.active&&(c.beginPath(),c.arc(f,e,this.width/2-2,0,g,!1),c.strokeStyle="black",c.stroke()),this.trace)b.lineWidth=1,b.strokeStyle=a.getColor(d,this.trace),b.beginPath(),
b.arc(f,e,this.width/2,0,g,!1),b.stroke()}};a.GraphicControl.prototype.drawText=function(d,c){var b=this.ctx,f=this.evaluator;b.fillStyle=a.getColor(f,this.color);b.font=this.font;b.textBaseline="alphabetic";f=f.evalExpression(this.text[0],f.evalExpression(this.decimals),this.fixed);b.fillText(f,d+1+this.width/2,c-1-this.height/2)};a.GraphicControl.prototype.getContainer=function(){for(var a=this.parent.spaces,c,b=0,f=a.length;b<f;b++)if(c=a[b],c.id==this.spaceID)return c.addCtr(this),this.zIndex=
c.zIndex,c.graphicControlContainer;a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].graphicControlContainer};a.GraphicControl.prototype.getSpace=function(){for(var a=this.parent.spaces,c=0,b=a.length;c<b;c++)if(a[c].id==this.spaceID)return a[c];return a[0]};a.GraphicControl.prototype.deactivate=function(){this.active=!1;this.evaluator.setVariable(this.id+".activo",0)};a.GraphicControl.prototype.registerMouseEvents=function(){function d(d){d.preventDefault();h.whichButton=null==d.which?2>d.button?
"LEFT":4==d.button?"MIDDLE":"RIGHT":2>d.which?"LEFT":2==d.which?"MIDDLE":"RIGHT";"LEFT"==h.whichButton&&h.evaluator.evalExpression(h.activeif)&&h.over&&(h.parent.deactivateGraphiControls(),h.click=!0,h.active=!0,h.evaluator.setVariable(h.id+".activo",1),h.posAnte=h.getCursorPosition(d),h.prePos={x:h.space.getAbsoluteX(h.x),y:h.space.getAbsoluteY(h.y)},a.hasTouchSupport?(window.addEventListener("touchmove",f,!1),window.addEventListener("touchend",b,!1)):(window.addEventListener("mouseup",b,!1),window.addEventListener("mousemove",
f,!1)))}function c(d){h.evaluator.evalExpression(h.activeif)&&(h.parent.deactivateGraphiControls(),h.click=!0,h.active=!0,h.posAnte=h.getCursorPosition(d),h.prePos={x:h.space.getAbsoluteX(h.x),y:h.space.getAbsoluteY(h.y)},a.hasTouchSupport?(window.addEventListener("touchmove",f,!1),window.addEventListener("touchend",b,!1)):(window.addEventListener("mouseup",b,!1),window.addEventListener("mousemove",f,!1)));d.preventDefault()}function b(d){if(h.evaluator.evalExpression(h.activeif)||h.active)h.click=
!1,d.preventDefault(),a.hasTouchSupport?(window.removeEventListener("touchmove",f,!1),window.removeEventListener("touchend",b,!1)):(window.removeEventListener("mouseup",b,!1),window.removeEventListener("mousemove",f,!1)),h.parent.update(),h.mouseCacher.style.left=h.space.getAbsoluteX(h.x)-h._w/2+"px",h.mouseCacher.style.top=h.space.getAbsoluteY(h.y)-h._h/2+"px"}function f(b){var d=h.getCursorPosition(b);h.posX=h.prePos.x-(h.posAnte.x-d.x);h.posY=h.prePos.y-(h.posAnte.y-d.y);if(h.constraint){var d=
h.space.getRelativeX(h.posX),c=h.space.getRelativeY(h.posY),d=h.newt.findZero(new a.R2(d,c));h.x=d.x;h.y=d.y;h.evaluator.setVariable(h.id+".x",h.x);h.evaluator.setVariable(h.id+".y",h.y)}else h.evaluator.setVariable(h.id+".x",h.space.getRelativeX(h.posX)),h.evaluator.setVariable(h.id+".y",h.space.getRelativeY(h.posY));h.parent.updateControls();h.parent.update();b.preventDefault()}function e(){h.over=!0;h.mouseCacher.style.cursor="pointer"}function g(){h.over=!1;h.mouseCacher.style.cursor="";h.click=
!1}this.active=this.over=this.click=!1;this.mouseCacher.oncontextmenu=function(){return!1};var h=this;a.hasTouchSupport?this.mouseCacher.addEventListener("touchstart",c,!1):(this.mouseCacher.addEventListener("mousedown",d,!1),this.mouseCacher.addEventListener("mouseover",e,!1),this.mouseCacher.addEventListener("mouseout",g,!1));this.mouseCacher.addEventListener("blur",function(){console.log("en blur")},!1)};a.GraphicControl.prototype.getCursorPosition=function(d){d=a.getCursorPosition(d);return{x:d.x-
(this.space.container.offsetLeft+this.space.container.parentNode.offsetLeft),y:d.y-(this.space.container.offsetTop+this.space.container.parentNode.offsetTop)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Control=function(a,d){this.parent=a;this.evaluator=a.evaluator;var c=this.parser=a.evaluator.parser;this.id="C";this.gui=this.type="";this.region="south";this.y=this.x=0;this.w=100;this.h=23;"text"!=d.type?this.expresion=c.parse("(0,0,100,23)"):(this.expresion=c.parse("(0,0,300,200)"),
this.w=300,this.h=200);this.fixed=2!=this.parent.version?!1:!0;this.visible=!0;this.color="#222222";this.colorInt="#f0f8ff";this.underlined=this.italics=this.bold="";this.font_size=c.parse("12");this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.imageOver=new Image;this.imageOver.onload=function(){this.ready=1};this.imageDown=new Image;this.imageDown.onload=function(){this.ready=1};this.parameter=this.action="";this.parameterFont="Monospace 12px";this.drawif=c.parse("1");
this.activeif=c.parse("1");this.tooltip="";this.tooltipFont="Monospace 12px";this.Explanation="";this.ExplanationFont="Monospace 12px";this.cID=this.msg_pos="";this.valueExpr=c.parse("0");this.decimals=c.parse("2");this.min=c.parse("-Infinity");this.max=c.parse("Infinity");this.incr=c.parse("0.1");this.exponentialif=this.discrete=!1;this.zIndex=-1;for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b]);void 0==this.name&&(this.name=2==this.parent.version?this.id:"_nada_");c=this.evaluator.evalExpression(this.expresion);
this.x=c[0][0];this.y=c[0][1];4==c[0].length&&(this.w=c[0][2],this.h=c[0][3]);this.name="_._"==this.name||"_nada_"==this.name||"_void_"==this.name?"":this.name;this.actionExec=this.parent.lessonParser.parseAction(this)};a.Control.prototype.init=function(){};a.Control.prototype.update=function(){};a.Control.prototype.draw=function(){};a.Control.prototype.getContainer=function(){var a=this.parent.spaces,d;if("interior"==this.region)for(var c=0,b=a.length;c<b;c++){if(d=a[c],d.id==this.spaceID)return d.addCtr(this),
this.zIndex=d.zIndex,d.numericalControlContainer}else{if("external"==this.region)return this.parent.externalSpace.container;if("scenario"==this.region)return this.parent.scenarioRegion.scenarioSpace.addCtr(this),this.zIndex=this.parent.scenarioRegion.scenarioSpace.zIndex,this.parent.scenarioRegion.scenarioSpace.numericalControlContainer;if("north"==this.region)return this.parent.northSpace.controls.push(this),this.parent.northSpace.container;if("south"==this.region)return this.parent.southSpace.controls.push(this),
this.parent.southSpace.container;if("east"==this.region)return this.parent.eastSpace.controls.push(this),this.parent.eastSpace.container;if("west"==this.region)return this.parent.westSpace.controls.push(this),this.parent.westSpace.container;if("special"==this.region)return this.parent.specialSpace.controls.push(this),this.parent.specialSpace.container}a[0].addCtr(this);this.zIndex=a[0].zIndex;return a[0].numericalControlContainer};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;
var g=Math.floor;a.Button=function(d,c){a.Control.call(this,d,c);this.name="["==this.name.charAt(0)&&this.name.charAt(this.name.length-1)?this.parser.parse(this.name.substring(1,this.name.length-1)):this.parser.parse("'"+this.name+"'");var b;this.imageSrc.match("_COLORES_")&&(b=this.imageSrc.split("_"),this.colorInt=b[2],this.color=b[3],this.font_size=this.parser.parse(b[5]),this.imageSrc="");this.imageSrc="["==this.imageSrc.charAt(0)&&this.imageSrc.charAt(this.imageSrc.length-1)?this.parser.parse(this.imageSrc.substring(1,
this.imageSrc.length-1)):this.parser.parse("'"+this.imageSrc+"'");b=this.evaluator.evalExpression(this.imageSrc);if(""!=b){var f=b.substr(0,b.lastIndexOf(".")),e=b.substr(b.lastIndexOf("."));b.toLowerCase().match(/vacio.gif$/)?(this.image.ready=1,3==this.parent.version&&(this.name=this.parser.parse("")),this.parser.parse("'vacio.gif'")):(this.image=this.parent.getImage(b),this.imageOver=this.parent.getImage(f+"_over"+e),this.imageDown=this.parent.getImage(f+"_down"+e))}b=this.getContainer();this.canvas=
document.createElement("canvas");this.canvas.setAttribute("class","DescartesButton");this.canvas.setAttribute("id",this.id);this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.canvas.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none";this.ctx=this.canvas.getContext("2d");b.childNodes[0]?b.insertBefore(this.canvas,b.childNodes[0]):b.appendChild(this.canvas);
this.registerMouseEvents();this.init()};a.extend(a.Button,a.Control);a.Button.prototype.init=function(){var a=this.canvas,c=this.evaluator.evalExpression(this.expresion);this.x=c[0][0];this.y=c[0][1];4==c[0].length&&(this.w=parseInt(c[0][2]),this.h=parseInt(c[0][3]));a.setAttribute("width",this.w+"px");a.setAttribute("height",this.h+"px");a.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.createGradient(this.w,this.h);this.draw()};a.Button.prototype.update=
function(){var a=!1,c=!1,b=!1,f=!1;this.evaluator.evalExpression(this.drawif)?(this.canvas.style.display="block",this.draw()):(this.click=!1,this.canvas.style.display="none");this.evaluator.evalExpression(this.activeif);var e=this.evaluator.evalExpression(this.expresion),a=this.x!=e[0][0],c=this.y!=e[0][1];this.x=e[0][0];this.y=e[0][1];4==e[0].length&&(b=this.w!=e[0][2],f=this.h!=e[0][3],this.w=e[0][2],this.h=e[0][3]);(b||f)&&this.createGradient(this.canvas.width,this.canvas.height);if(b||f||a||c)this.canvas.setAttribute("width",
this.w+"px"),this.canvas.setAttribute("height",this.h+"px"),this.canvas.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";"),this.draw()};a.Button.prototype.createGradient=function(a,c){this.linearGradient=this.ctx.createLinearGradient(0,0,0,c);for(var b=c*c,f,e=0;e<c;e++)f=g(e-35*c/100),this.linearGradient.addColorStop(e/c,"rgba(0,0,0,"+192*f*f/b/255+")")};a.Button.prototype.draw=function(){var d=this.evaluator.evalExpression(this.font_size),c=this.evaluator.evalExpression(this.name),
b=this.evaluator.evalExpression(this.imageSrc),f;f="vacio.gif"==b?{ready:!0}:this.parent.getImage(b);var e=this.ctx;e.clearRect(0,0,this.w,this.h);var l=0,h=0;this.click&&(h=l=1);f&&f.ready?(""!=f.src||!b.toLowerCase().match(/vacio.gif$/))&&f.complete&&e.drawImage(f,(this.w-f.width)/2+l,(this.h-f.height)/2+h):(e.fillStyle=a.getColor(this.evaluator,this.colorInt),e.fillRect(0,0,this.w,this.h),this.click||(a.drawLine(e,this.w-1,0,this.w-1,this.h,"rgba(0,0,0,"+128/255+")"),a.drawLine(e,0,0,0,this.h,
"rgba(0,0,0,"+24/255+")"),a.drawLine(e,1,0,1,this.h,"rgba(0,0,0,"+8/255+")")),e.fillStyle=this.linearGradient,e.fillRect(0,0,this.w,this.h));""!=this.imageOver.src&&this.imageOver.ready&&this.over&&e.drawImage(this.imageOver,(this.w-f.width)/2+l,(this.h-f.height)/2+h);""!=this.imageDown.src&&this.imageDown.ready&&this.click?e.drawImage(this.imageDown,(this.w-f.width)/2+l,(this.h-f.height)/2+h):this.click&&(e.save(),a.drawLine(e,0,0,0,this.h-2,"gray"),a.drawLine(e,0,0,this.w-1,0,"gray"),e.fillStyle=
"rgba(0, 0, 0,"+24/255+")",e.fillRect(0,0,this.w,this.h),e.restore());e.fillStyle=a.getColor(this.evaluator,this.color);e.font=this.italics+" "+this.bold+" "+d+"px Arial";e.textAlign="center";e.textBaseline="middle";e.strokeStyle=a.getColor(this.evaluator,this.colorInt);e.lineWidth=d/12;this.stroke!=this.fillStyle&&e.strokeText(c,g(this.w/2+l)+0.5,g(this.h/2+h)+0.5);e.fillText(c,g(this.w/2+l)+0.5,g(this.h/2+h)+0.5);this.underlined&&(c=e.measureText(c).width,e.strokeStyle=a.getColor(this.evaluator,
this.color),e.lineWidth=g(d/10),e.lineCap="round",e.beginPath(),e.moveTo((this.w-c)/2+l,g(this.h+d)/2+e.lineWidth/2-1.5+h),e.lineTo((this.w+c)/2+l,g(this.h+d)/2+e.lineWidth/2-1.5+h),e.stroke());this.evaluator.evalExpression(this.activeif)||(e.fillStyle="rgba(240,240,240,"+160/255+")",e.fillRect(0,0,this.w,this.h))};a.Button.prototype.bottonPressed=function(){this.parent.updateControls();"init"==this.action&&(this.click=!1);this.actionExec.execute();this.parent.updateControls();"animate"!=this.action&&
this.parent.update()};a.Button.prototype.registerMouseEvents=function(){function d(a,b,c){h.click?(b.call(h),a=c?a:30,j=setTimeout(function(){d(a,b)},a)):clearInterval(j)}function c(a){a.preventDefault();h.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==h.whichButton&&h.evaluator.evalExpression(h.activeif)&&(h.click=!0,h.draw(),h.evaluator.setVariable(h.id,h.evaluator.evalExpression(h.valueExpr)),"calculate"==h.action&&
d(i,h.bottonPressed,!0),g?window.addEventListener("touchend",b,!1):window.addEventListener("mouseup",b,!1))}function b(a){if(h.evaluator.evalExpression(h.activeif)||h.click)h.click=!1,h.draw(),"calculate"!=h.action&&h.bottonPressed(),a.preventDefault(),g?window.removeEventListener("touchend",b,!1):window.removeEventListener("mouseup",b,!1)}function f(){h.over=!0;h.draw()}function e(){h.over=!1;h.click=!1;h.draw()}var g=a.hasTouchSupport;this.canvas.oncontextmenu=function(){return!1};var h=this,i=
900,j;this.over=this.click=!1;g?this.canvas.addEventListener("touchstart",c,!1):(this.canvas.addEventListener("mousedown",c,!1),this.canvas.addEventListener("mouseover",f,!1),this.canvas.addEventListener("mouseout",e,!1))};return a}(descartesJS||{}),descartesJS=function(a){function g(a,c,b,f){a.fillStyle=f||"black";a.beginPath();a.moveTo(c[0],b[0]);for(var f=1,e=c.length;f<e;f++)a.lineTo(c[f],b[f]);a.fill()}if(a.loadLib)return a;a.Spinner=function(d,c){a.Control.call(this,d,c);this.tabindex=++this.parent.tabindex;
var b=this.getContainer();this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);""!=this.name&&this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.canvas);
this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);b.childNodes[0]?b.insertBefore(this.containerControl,b.childNodes[0]):b.appendChild(this.containerControl);this.init();this.registerMouseEvents();this.draw()};a.extend(a.Spinner,a.Control);a.Spinner.prototype.init=function(){var d=this.evaluator;this.value=this.validateValue(d.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value);this.fieldFontSize=Math.floor(this.h-0.25*this.h);var b=
a.getTextWidth(c+"0",this.fieldFontSize+"px Arial"),f=2+this.h/2,e=this.w/2-f/2,g=a.getTextWidth(this.name,this.fieldFontSize+"px Arial");this.visible||(e=this.w-f,b=0);e<g&&(e=g);""==this.name&&(e=0);this.w-e-f<b&&(e=this.w-f-b);0>e&&(e=0);b=this.w-(e+f);this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=
d.evalExpression(this.drawif)?"block":"none";this.canvas.setAttribute("width",f+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","position: absolute; left: "+e+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+f+"px; height : "+this.h/2+"px; left: "+e+"px; top: 0px;");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
f+"px; height : "+this.h/2+"px; left: "+e+"px; top: "+this.h/2+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"_spinner");this.field.value=c;this.field.setAttribute("class","DescartesSpinnerField");this.field.setAttribute("style","font-family: Arial; font-size: "+this.fieldFontSize+"px; width : "+(b-2)+"px; height : "+(this.h-2)+"px; left: "+(f+e)+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.disabled=d.evalExpression(this.activeif)?!1:!0;
this.label.setAttribute("class","DescartesSpinnerLabel");this.label.setAttribute("style","font-family: Arial; font-size:"+this.fieldFontSize+"px; width: "+e+"px; height: "+this.h+"px;");d.setVariable(this.id,this.value);this.createGradient(this.h/2,this.h)};a.Spinner.prototype.update=function(){var a=this.evaluator,c=!1,b=!1,f=!1,e=!1;this.field.disabled=a.evalExpression(this.activeif)?!1:!0;a.evalExpression(this.drawif)?(this.containerControl.style.display="block",this.draw()):(this.click=!1,this.containerControl.style.display=
"none");var g=a.evalExpression(this.expresion),c=this.x!=g[0][0],b=this.y!=g[0][1];this.x=g[0][0];this.y=g[0][1];4==g[0].length&&(f=this.w!=g[0][2],e=this.h!=g[0][3],this.w=g[0][2],this.h=g[0][3]);(f||e)&&this.createGradient(this.canvas.width,this.canvas.height);var g=this.field.value,h=this.value;this.value=this.validateValue(a.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value==h&&this.field.value!=g&&(this.value=this.validateValue(g),this.field.value=this.formatOutputValue(this.value));
if(f||e||c||b)this.init(),this.draw();a.setVariable(this.id,this.value)};a.Spinner.prototype.createGradient=function(a,c){this.linearGradient=this.ctx.createLinearGradient(0,0,0,c);for(var b=c*c,f,e=0;e<c;e++)f=Math.floor(e-40*c/100),this.linearGradient.addColorStop(e/c,"rgba(0,0,0,"+192*f*f/b/255+")")};a.Spinner.prototype.draw=function(){var d=this.ctx,c=this.canvas.width,b=this.canvas.height;d.save();d.fillStyle="#f0f8ff";d.fillRect(0,0,c,b);d.fillStyle=this.linearGradient;d.fillRect(0,0,c,b);var f,
e;this.up?(f="gray",e="#f0f8ff"):(f="#f0f8ff",e="gray");a.drawLine(d,0,0,c,0,f);a.drawLine(d,0,0,0,b/2,f);a.drawLine(d,0,b/2,c,b/2,e);this.down?(f="gray",e="#f0f8ff"):(f="#f0f8ff",e="gray");a.drawLine(d,0,b/2+1,c,b/2+1,f);a.drawLine(d,0,b/2+1,0,b,f);a.drawLine(d,0,b-1,c,b-1,e);f=[c/2,c/5-1,c-c/5+1];e=[b/8+1,b/8+1+b/4,b/8+1+b/4];var l=this.evaluator.evalExpression(this.activeif);g(d,f,e,l?"#2244cc":"#8888aa");e=[b-b/8,b-b/8-b/4,b-b/8-b/4];g(d,f,e,l?"#d00018":"#aa8888");d.fillStyle="rgba(0,0,0,"+24/
255+")";this.up&&d.fillRect(0,0,c,b/2);this.down&&d.fillRect(0,b/2,c,b)};a.Spinner.prototype.validateValue=function(a){var c=this.evaluator;(a=parseFloat(c.evalExpression(c.parser.parse(a.toString().replace(this.parent.decimal_symbol,".")))))||(a=0);a<c.evalExpression(this.min)&&(a=c.evalExpression(this.min));a>c.evalExpression(this.max)&&(a=c.evalExpression(this.max));if(this.discrete)var b=c.evalExpression(this.incr),a=0==b?0:b*Math.round(a/b);return a=parseFloat(parseFloat(a).toFixed(c.evalExpression(this.decimals)))};
a.Spinner.prototype.formatOutputValue=function(a){var c=a+"",b=this.evaluator.evalExpression(this.decimals),f=c.indexOf(".");-1!=f&&c.substring(f+1).length>b&&(c=parseFloat(c).toFixed(b));if(this.fixed&&(2!=this.parent.version||2==this.parent.version&&!this.exponentialif))c=parseFloat(a).toFixed(b);this.exponentialif&&0!=parseFloat(c)&&(c=this.fixed&&2!=this.parent.version?parseFloat(c).toExponential(b):parseFloat(c).toExponential(),c=c.toUpperCase(),c=c.replace("+",""));return c=c.replace(".",this.parent.decimal_symbol)};
a.Spinner.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-this.evaluator.evalExpression(this.incr))};a.Spinner.prototype.changeValue=function(a){this.evaluator.evalExpression(this.activeif)&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),this.evaluator.setVariable(this.id,this.value),this.parent.updateControls(),"init"==
this.action&&(this.click=!1),this.actionExec.execute(),this.parent.updateControls(),"animate"!=this.action&&this.parent.update())};a.Spinner.prototype.registerMouseEvents=function(){function d(a,b,c){j.up||j.down?(b.call(j),a=c?a:30,m=setTimeout(function(){d(a,b)},a)):clearInterval(m)}function c(a){a.preventDefault();j.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==j.whichButton&&j.evaluator.evalExpression(j.activeif)&&
(j.up=!0,d(k,j.increase,!0),j.draw())}function b(a){a.preventDefault();j.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==j.whichButton&&j.evaluator.evalExpression(j.activeif)&&(j.down=!0,d(k,j.decrease,!0),j.draw())}function f(a){j.up=!1;clearInterval(m);j.draw();a.preventDefault()}function e(a){j.down=!1;clearInterval(m);j.draw();a.preventDefault()}function g(a){j.up=!1;clearInterval(m);j.draw();a.preventDefault()}function h(a){j.down=
!1;clearInterval(m);j.draw();a.preventDefault()}var i=a.hasTouchSupport;this.divUp.oncontextmenu=function(){return!1};this.divDown.oncontextmenu=function(){return!1};var j=this,k=i?500:200,m;this.field.addEventListener("keydown",function(a){13==a.keyCode&&j.changeValue(j.field.value)},!1);i?this.divUp.addEventListener("touchstart",c,!1):this.divUp.addEventListener("mousedown",c,!1);i?this.divDown.addEventListener("touchstart",b,!1):this.divDown.addEventListener("mousedown",b,!1);i||this.divUp.addEventListener("mouseout",
f,!1);i||this.divDown.addEventListener("mouseout",e,!1);i?(this.divUp.addEventListener("touchend",g,!1),window.addEventListener("touchend",g,!1)):(this.divUp.addEventListener("mouseup",g,!1),window.addEventListener("mouseup",g,!1));i?(this.divDown.addEventListener("touchend",h,!1),window.addEventListener("touchend",h,!1)):(this.divDown.addEventListener("mouseup",h,!1),window.addEventListener("mouseup",h,!1))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.TextField=function(g,
d){a.Control.call(this,g,d);this.emptyString=!1;this.ok=0;this.tabindex=++this.parent.tabindex;if(this.answer)if(this.answer.match("krypto_")&&(this.answer=(new a.Krypto).decode(this.answer.substring(7))),this.answerPattern=this.answer,this.onlyText){this.answer=a.buildRegularExpresionsPatterns(this.answer);var c=this.answerPattern.indexOf("|");this.firstAnswer=-1==c?this.answerPattern:this.answerPattern.substring(0,c)}else this.buildRangeExpresions(),this.firstAnswer=this.parser.parse(this.answerPattern.substring(1,
this.answerPattern.indexOf(",")));this.onlyText&&(this.validateValue=function(a){return"''"==a||"'"==a?"":a},this.formatOutputValue=function(a){return a.toString()},this.evaluateAnswer=this.evaluateTextualAnswer);c=this.getContainer();this.containerControl=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.label);
this.containerControl.appendChild(this.field);c.childNodes[0]?c.insertBefore(this.containerControl,c.childNodes[0]):c.appendChild(this.containerControl);this.init();this.registerMouseEvents();this.draw()};a.extend(a.TextField,a.Control);a.TextField.prototype.init=function(){evaluator=this.evaluator;this.value=evaluator.evalExpression(this.valueExpr);this.value=this.validateValue(this.value);var g=this.formatOutputValue(this.value);this.fieldFontSize=Math.floor(this.h-0.25*this.h);var d=this.w/2,c=
a.getTextWidth(g+"0",this.fieldFontSize+"px Arial"),b=a.getTextWidth(this.name,this.fieldFontSize+"px Arial");d<b&&(d=b);""==this.name&&(d=0);this.w-d<c&&(d=this.w-c);0>d&&(d=0);c=this.w-d;this.containerControl.setAttribute("class","DescartesTextFieldContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=evaluator.evalExpression(this.drawif)?"block":"none";
this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"TextField");this.field.value=g;this.field.setAttribute("class","DescartesTextFieldField");this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+c+"px; height : "+(this.h-2)+"px; left: "+d+"px;");this.field.setAttribute("tabindex",this.tabindex);this.field.disabled=evaluator.evalExpression(this.activeif)?!1:!0;this.label.setAttribute("class","DescartesTextFieldLabel");this.label.setAttribute("style",
"font-size:"+this.fieldFontSize+"px; width: "+d+"px; height: "+this.h+"px;");evaluator.setVariable(this.id,this.value);this.oldValue=this.value};a.TextField.prototype.update=function(){evaluator=this.evaluator;var a=!1,d=!1,c=!1,b=!1;this.field.disabled=evaluator.evalExpression(this.activeif)?!1:!0;evaluator.evalExpression(this.drawif)?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";var f=evaluator.evalExpression(this.expresion),a=this.x!=f[0][0],
d=this.y!=f[0][1];this.x=f[0][0];this.y=f[0][1];4==f[0].length&&(c=this.w!=f[0][2],b=this.h!=f[0][3],this.w=f[0][2],this.h=f[0][3]);(c||b||a||d)&&this.init();a=this.field.value;d=this.value;this.value=this.validateValue(evaluator.getVariable(this.id));this.field.value=this.formatOutputValue(this.value);this.value===d&&this.field.value!=a&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value));evaluator.setVariable(this.id,this.value)};a.TextField.prototype.validateValue=
function(a){if(""===a||"''"==a)return"";var d=this.evaluator;(a=parseFloat(d.evalExpression(d.parser.parse(a.toString().replace(this.parent.decimal_symbol,".")))))||(a=0);a<d.evalExpression(this.min)&&(a=d.evalExpression(this.min));a>d.evalExpression(this.max)&&(a=d.evalExpression(this.max));if(this.discrete)var c=d.evalExpression(this.incr),a=0==c?0:c*Math.round(a/c);return a=parseFloat(parseFloat(a).toFixed(d.evalExpression(this.decimals)))};a.TextField.prototype.formatOutputValue=function(a){if(""===
a)return"";var d=a+"",c=this.evaluator.evalExpression(this.decimals),b=d.indexOf(".");-1!=b&&d.substring(b+1).length>c&&(d=parseFloat(d).toFixed(c));this.fixed&&(d=parseFloat(a).toFixed(c));this.exponentialif&&(d=d.toExponential(c),d=d.toUpperCase(),d=d.replace("+",""));return d=d.replace(".",this.parent.decimal_symbol)};a.TextField.prototype.changeValue=function(a){this.evaluator.evalExpression(this.activeif)&&(this.value=this.validateValue(a),this.field.value=this.formatOutputValue(this.value),
this.evaluate&&(this.ok=this.evaluateAnswer()),this.evaluator.setVariable(this.id,this.value),this.evaluator.setVariable(this.id+".ok",this.ok),this.parent.updateControls(),"init"==this.action&&(this.click=!1),this.actionExec.execute(),this.parent.updateControls(),"animate"!=this.action&&this.parent.update())};a.TextField.prototype.evaluateAnswer=function(){var a=this.evaluator;parseFloat(this.value);for(var d,c,b,f,e,l,h,i=0,j=this.answer.length;i<j;i++)if(f=this.answer[i][0],l=this.answer[i][1],
d=a.evalExpression(f.expression),c=a.evalExpression(l.expression),b="("==f.type,f="["==f.type,e=")"==l.type,l="]"==l.type,h=this.value,b&&e&&h>d&&h<c||b&&l&&h>d&&h<=c||f&&e&&h>=d&&h<c||f&&l&&h>=d&&h<=c)return 1;return 0};a.TextField.prototype.buildRangeExpresions=function(){var a;this.answer=this.answer.split("|");for(var d=0,c=this.answer.length;d<c;d++)this.answer[d]=this.answer[d].trim(),this.answer[d]=this.answer[d].split(","),a=this.answer[d][0].trim(),this.answer[d][0]={type:a[0],expression:this.evaluator.parser.parse(a.substring(1))},
a=this.answer[d][1].trim(),this.answer[d][1]={type:a[a.length-1],expression:this.evaluator.parser.parse(a.substring(0,a.length-1))}};a.TextField.prototype.evaluateTextualAnswer=function(){for(var g=this.value,d,c,b,f=0,e=this.answer.length;f<e;f++){c=this.answer[f];b=!0;for(var l=0,h=c.length;l<h;l++)d=c[l],d.ignoreAcents&&(g=a.replaceAcents(g),d.regExp=a.replaceAcents(d.regExp)),d.ignoreCaps&&(g=g.toLowerCase(),d.regExp=d.regExp.toLowerCase()),b=b&&!!g.match(d.regExp);if(b)return 1}return 0};a.TextField.prototype.getFirstAnswer=
function(){return this.answer?this.onlyText?this.firstAnswer:this.evaluator.evalExpression(this.firstAnswer):""};a.TextField.prototype.registerMouseEvents=function(){var a=this;this.field.addEventListener("blur",function(){a.update()},!1);this.field.addEventListener("keydown",function(d){a.evaluator.evalExpression(a.activeif)&&13==d.keyCode&&a.changeValue(a.field.value,!0)},!1)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Menu=function(g,d){a.Control.call(this,g,d);
var c=this.parser;this.options=this.options?this.options.split(","):[];this.menuOptions=[];this.strValue=[];for(var b,f=0,e=this.options.length;f<e;f++)b=this.options[f].split(/[\[\]]/,2),1==b.length?(this.menuOptions.push(b[0]),this.strValue.push(f.toString())):2==b.length&&(this.menuOptions.push(b[0]),""==b[1]?this.strValue.push(f.toString()):this.strValue.push(b[1]));f=0;for(e=this.strValue.length;f<e;f++)this.strValue[f]=c.parse(this.strValue[f]);c=this.getContainer();this.containerControl=document.createElement("div");
this.label=document.createElement("label");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.select=document.createElement("select");f=0;for(e=this.menuOptions.length;f<e;f++)b=document.createElement("option"),b.innerHTML=this.menuOptions[f],this.select.appendChild(b);this.field=document.createElement("input");this.init();this.containerControl.appendChild(this.label);this.containerControl.appendChild(this.select);this.visible&&this.containerControl.appendChild(this.field);
c.childNodes[0]?c.insertBefore(this.containerControl,c.childNodes[0]):c.appendChild(this.containerControl);this.registerMouseEvents()};a.extend(a.Menu,a.Control);a.Menu.prototype.init=function(){var g=this.evaluator;this.fieldFontSize=Math.floor(this.h-3-0.25*(this.h-3));var d=0,c=0,b=0;this.value=g.evalExpression(this.valueExpr);this.indexValue=this.getIndex(this.value);for(var f=0,e=this.menuOptions.length;f<e;f++)b=a.getTextWidth(this.menuOptions[f],this.fieldFontSize+"px Arial"),b>d&&(d=b,c=f);
d+=25;b=a.getTextWidth(this.formatOutputValue(g.evalExpression(this.strValue[c])),this.fieldFontSize+"px Arial")+7;c=a.getTextWidth(this.name,this.fieldFontSize+"px Arial")+10;""==this.name&&(c=0);this.visible||(b=0);for(f=this.w-b-c;f<d&&0<c;)c--,f++;for(;f<d&&0<b;)b--,f++;for(;c+f+b+1<this.w;)f++,b++;var d=c,e=d+f,b=this.w-e,l=this.formatOutputValue(g.evalExpression(this.strValue[this.indexValue]));this.containerControl.setAttribute("class","DescartesSpinnerContainer");this.containerControl.setAttribute("style",
"width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=g.evalExpression(this.drawif)?"block":"none";this.label.setAttribute("class","DescartesMenuLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+c+"px; height: "+this.h+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"menu");this.field.value=l;this.field.setAttribute("class","DescartesMenuField");
this.field.setAttribute("style","font-size: "+this.fieldFontSize+"px; width : "+b+"px; height : "+(this.h-2)+"px; left: "+e+"px;");this.field.disabled=g.evalExpression(this.activeif)?!1:!0;this.select.setAttribute("id",this.id+"menuSelect");this.select.setAttribute("class","DescartesMenuSelect");this.select.setAttribute("style","text-align: left; font-size: "+this.fieldFontSize+"px; width : "+f+"px; height : "+this.h+"px; left: "+d+"px; border-color: #7a8a99; border-width: 1.5px; border-style: solid; background-color: #eeeeee;");
this.select.selectedIndex=this.indexValue;this.select.disabled=g.evalExpression(this.activeif)?!1:!0;g.setVariable(this.id,parseFloat(l))};a.Menu.prototype.update=function(){var a=this.evaluator,d=!1,c=!1,b=!1,f=!1,d=a.evalExpression(this.activeif);this.field.disabled=d?!1:!0;this.select.disabled=d?!1:!0;a.evalExpression(this.drawif)?(this.containerControl.style.display="block",this.draw()):(this.click=!1,this.containerControl.style.display="none");var e=a.evalExpression(this.expresion),d=this.x!=
e[0][0],c=this.y!=e[0][1];this.x=e[0][0];this.y=e[0][1];4==e[0].length&&(b=this.w!=e[0][2],f=this.h!=e[0][3],this.w=e[0][2],this.h=e[0][3]);if(b||f||d||c)this.init(),this.draw();this.value=a.getVariable(this.id);this.field.value=this.formatOutputValue(this.value);a.setVariable(this.id,parseFloat(this.value));this.select.selectedIndex=parseFloat(this.getIndex(this.value))};a.Menu.prototype.getIndex=function(a){for(var a=parseFloat(a.toString().replace(this.parent.decimal_symbol,".")),d=-1,c=Infinity,
b,f=0,e=this.strValue.length;f<e;f++)b=Math.abs(a-parseFloat(this.evaluator.evalExpression(this.strValue[f]))),b<=c&&(c=b,d=f);return d};a.Menu.prototype.formatOutputValue=function(a){var d=a+"",c=this.evaluator.evalExpression(this.decimals),b=d.indexOf(".");-1!=b&&d.substring(b+1).length>c&&(d=parseFloat(d).toFixed(c));this.fixed&&(d=parseFloat(a).toFixed(c));this.exponentialif&&(d=d.toExponential(c),d=d.toUpperCase(),d=d.replace("+",""));return d=d.replace(".",this.parent.decimal_symbol)};a.Menu.prototype.changeValue=
function(){this.evaluator.evalExpression(this.activeif)&&(this.evaluator.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.updateControls(),"animate"!=this.action&&this.parent.update())};a.Menu.prototype.registerMouseEvents=function(){var a=this;this.select.oncontextmenu=function(){return!1};this.select.addEventListener("change",function(d){a.value=a.evaluator.evalExpression(a.strValue[this.selectedIndex]);a.field.value=a.formatOutputValue(a.value);
a.evaluator.setVariable(a.id,a.field.value);a.changeValue();d.preventDefault()},!1);this.field.addEventListener("keydown",function(d){13==d.keyCode&&(a.indexValue=a.getIndex(a.field.value),a.value=a.evaluator.evalExpression(a.strValue[a.indexValue]),a.field.value=a.formatOutputValue(a.indexValue),a.select.selectedIndex=a.indexValue,a.changeValue())},!1)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.Scrollbar=function(d,c){a.Control.call(this,d,c);this.orientation=
this.w>=this.h?"horizontal":"vertical";var b=this.getContainer();this.containerControl=document.createElement("div");this.canvas=document.createElement("canvas");this.divUp=document.createElement("div");this.divDown=document.createElement("div");this.field=document.createElement("input");this.label=document.createElement("label");this.scrollManipulator=document.createElement("div");this.txtLabel=document.createTextNode(this.name);this.label.appendChild(this.txtLabel);this.containerControl.appendChild(this.label);
this.containerControl.appendChild(this.canvas);this.containerControl.appendChild(this.divUp);this.containerControl.appendChild(this.divDown);this.containerControl.appendChild(this.field);this.containerControl.appendChild(this.scrollManipulator);b.childNodes[0]?b.insertBefore(this.containerControl,b.childNodes[0]):b.appendChild(this.containerControl);this.init();this.registerMouseEvents();this.draw()};a.extend(a.Scrollbar,a.Control);a.Scrollbar.prototype.init=function(){var a=this.evaluator;this.incr=
0==a.evalExpression(this.decimals)?1:(a.evalExpression(this.max)-a.evalExpression(this.min))/100;this.value=this.validateValue(a.evalExpression(this.valueExpr));var c=this.formatOutputValue(this.value),b=this.evaluator.evalExpression(this.expresion);this.x=b[0][0];this.y=b[0][1];4==b[0].length&&(this.w=b[0][2],this.h=b[0][3]);this.orientation=this.w>=this.h?"horizontal":"vertical";"vertical"==this.orientation?this.initVertical(c):this.initHorizontal(c);a.setVariable(this.id,this.value);a=this.value;
this.value=null;this.changeValue(a);this.prePos=this.pos;this.draw()};a.Scrollbar.prototype.initVertical=function(d){this.fieldFontSize=g(this.w-0.25*this.w);this.fieldFontSize=17.25;a.getTextWidth(d+"0",this.fieldFontSize+"px Arial");this.labelHeight=""==this.name?0:23;var c=""==this.visible?0:23;this.canvasHeight=this.h-this.labelHeight-c;var b=c+this.canvasHeight;this.downHeight=this.upHeight=15;this.scrollManipulatorHeight=parseInt((this.canvasHeight-this.upHeight-this.downHeight)/10);this.scrollManipulatorHeight=
15>this.scrollManipulatorHeight?15:this.scrollManipulatorHeight;this.scrollManipulatorLimInf=c+this.canvasHeight-this.upHeight-this.downHeight;this.scrollManipulatorLimSup=c+this.downHeight;this.containerControl.setAttribute("class","DescartesScrollbarContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=this.evaluator.evalExpression(this.drawif)?"block":
"none";this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",this.canvasHeight+"px");this.canvas.setAttribute("style","position: absolute; left: 0px; top: "+c+"px;");this.ctx=this.canvas.getContext("2d");this.divDown.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+this.w+"px; height : "+this.upHeight+"px; left: 0px; top: "+(b-this.downHeight)+"px;");this.divUp.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
this.w+"px; height : "+this.downHeight+"px; left: 0px; top: "+this.labelHeight+"px;");this.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+this.w+"px; height : "+this.scrollManipulatorHeight+"px; left: 0px; top: "+this.scrollManipulatorLimInf+"px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"scrollbar");this.field.value=d;this.field.setAttribute("class","DescartesScrollbarField");this.field.setAttribute("style",
"font-size: "+this.fieldFontSize+"px; width : "+this.w+"px; height : "+c+"px; left: 0px; top: 0px;");this.field.disabled=this.evaluator.evalExpression(this.activeif)?!1:!0;this.label.setAttribute("class","DescartesScrollbarLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+this.w+"px; height: "+this.labelHeight+"px; left: 0px; top: "+b+"px;");this.txtLabel=document.createTextNode(this.name)};a.Scrollbar.prototype.initHorizontal=function(d){this.fieldFontSize=g(this.h-
0.25*this.h);var c=a.getTextWidth(d+"0",this.fieldFontSize+"px Arial");this.labelWidth=a.getTextWidth(this.name,this.fieldFontSize+"px Arial");""==this.name&&(this.labelWidth=0);this.visible||(c=0);for(var b=this.w-c-this.labelWidth;58>b&&0<this.labelWidth;)this.labelWidth--,b++;for(;58>b&&0<c;)c--,b++;var f=this.labelWidth,e=f+b,c=this.w-e;this.canvasWidth=b;this.downWidth=this.upWidth=15;this.scrollManipulatorWidth=parseInt((this.canvasWidth-this.upWidth-this.downWidth)/10);this.scrollManipulatorWidth=
15>this.scrollManipulatorWidth?15:this.scrollManipulatorWidth;this.scrollManipulatorLimInf=f+this.downWidth;this.scrollManipulatorLimSup=f+this.canvasWidth-this.downWidth-this.scrollManipulatorWidth;this.containerControl.setAttribute("class","DescartesScrollbarContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=this.evaluator.evalExpression(this.drawif)?
"block":"none";this.canvas.setAttribute("width",this.canvasWidth+"px");this.canvas.setAttribute("height",this.h+"px");this.canvas.setAttribute("style","position: absolute; left: "+f+"px; top: 0px;");this.ctx=this.canvas.getContext("2d");this.divUp.setAttribute("style","cursor: pointer; position: absolute; width : "+this.upWidth+"px; height : "+this.h+"px; left: "+(e-this.downWidth)+"px; top: 0px;");this.divDown.setAttribute("style","cursor: pointer; position: absolute; width : "+this.downWidth+"px; height : "+
this.h+"px; left: "+this.labelWidth+"px; top: 0px;");this.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+this.scrollManipulatorWidth+"px; height : "+this.h+"px; left: "+this.scrollManipulatorLimInf+"px; top: 0px;");this.field.setAttribute("type","text");this.field.setAttribute("id",this.id+"scrollbar");this.field.value=d;this.field.setAttribute("class","DescartesScrollbarField");this.field.setAttribute("style","font-size: "+
this.fieldFontSize+"px; width : "+c+"px; height : "+(this.h-2)+"px; left: "+(this.canvasWidth+this.labelWidth)+"px;");this.field.disabled=this.evaluator.evalExpression(this.activeif)?!1:!0;this.label.setAttribute("class","DescartesScrollbarLabel");this.label.setAttribute("style","font-size:"+this.fieldFontSize+"px; width: "+this.labelWidth+"px; height: "+this.h+"px;");this.txtLabel=document.createTextNode(this.name)};a.Scrollbar.prototype.update=function(){var a=this.evaluator,c=!1,b=!1,f=!1,e=!1;
this.incr=0==a.evalExpression(this.decimals)?1:(a.evalExpression(this.max)-a.evalExpression(this.min))/100;this.field.disabled=a.evalExpression(this.activeif)?!1:!0;a.evalExpression(this.drawif)?(this.containerControl.style.display="block",this.draw()):this.containerControl.style.display="none";var g=a.evalExpression(this.expresion),c=this.x!=g[0][0],b=this.y!=g[0][1];this.x=g[0][0];this.y=g[0][1];4==g[0].length&&(f=this.w!=g[0][2],e=this.h!=g[0][3],this.w=g[0][2],this.h=g[0][3]);this.value=this.validateValue(a.getVariable(this.id));
this.field.value=this.formatOutputValue(this.value);if(f||e||c||b)this.init(),this.draw();a.setVariable(this.id,this.value);this.draw()};a.Scrollbar.prototype.createGradient=function(a,c){this.linearGradient=this.ctx.createLinearGradient(0,0,0,c);for(var b=c*c,f,e=0;e<c;e++)f=g(e-40*c/100),this.linearGradient.addColorStop(e/c,"rgba(0,0,0,"+192*f*f/b/255+")")};a.Scrollbar.prototype.draw=function(){var a=this.ctx;if("horizontal"==this.orientation){var c=g(this.h),b=g(this.upWidth),f=g(this.canvasWidth-
this.upWidth);a.clearRect(0,0,this.canvasWidth,this.h);a.strokeStyle="#7a8a99";a.strokeRect(0,0,b+0.5,c);a.strokeRect(f+0.5,0,b,c);var e=4;a.fillStyle=this.up?"black":"#333333";a.beginPath();a.moveTo(e,c/2);a.lineTo(b-e,c/2-7);a.lineTo(b-e,c/2+7);a.closePath();a.moveTo(f+1+b-e,c/2);a.lineTo(f+1+e,c/2-7);a.lineTo(f+1+e,c/2+7);a.closePath();a.fill();a.strokeRect(0,0.5,this.canvasWidth+0.5,c-1);e=g(this.pos-this.labelWidth);a.fillStyle="#ccdcec";a.fillRect(e+0.5,0,g(this.scrollManipulatorWidth),c);a.strokeStyle=
"#6382bf";a.strokeRect(e+0.5,0,g(this.scrollManipulatorWidth),c);b=g(this.scrollManipulatorWidth/2);a.beginPath();a.moveTo(e+b+0.5-2,3);a.lineTo(e+b+0.5-2,c-3);a.moveTo(e+b+0.5,3);a.lineTo(e+b+0.5,c-3);a.moveTo(e+b+0.5+2,3);a.lineTo(e+b+0.5+2,c-3)}else c=g(this.w),b=g(this.upHeight),f=g(this.canvasHeight-this.upHeight),a.clearRect(0,0,this.w,this.canvasHeight),a.strokeStyle="#7a8a99",a.strokeRect(0.5,2.5,c-0.5,b),a.strokeRect(0.5,f-0.5,c-0.5,b),e=4,a.fillStyle=this.down?"black":"#333333",a.beginPath(),
a.moveTo(c/2,e+2),a.lineTo(c/2-7,b-e+2),a.lineTo(c/2+7,b-e+2),a.closePath(),a.moveTo(c/2,f+b-e),a.lineTo(c/2-7,f+e),a.lineTo(c/2+7,f+e),a.closePath(),a.fill(),a.strokeRect(0.5,1.5,c-0.5,this.canvasHeight-1.5),e=g(this.pos-this.labelHeight),a.fillStyle="#ccdcec",a.fillRect(0,e+0.5,this.w,g(this.scrollManipulatorHeight)),a.strokeStyle="#6382bf",a.strokeRect(0,e+0.5,this.w,g(this.scrollManipulatorHeight)),b=g(this.scrollManipulatorHeight/2),a.beginPath(),a.moveTo(3,e+b+0.5-2),a.lineTo(c-3,e+b+0.5-2),
a.moveTo(3,e+b+0.5),a.lineTo(c-3,e+b+0.5),a.moveTo(3,e+b+0.5+2),a.lineTo(c-3,e+b+0.5+2);a.stroke()};a.Scrollbar.prototype.validateValue=function(a){var c=this.evaluator,a=a.toString();(a=parseFloat(a.replace(this.parent.decimal_symbol,".")))||(a=0);this.minimo=c.evalExpression(this.min);a<this.minimo&&(this.value=null,a=this.minimo);this.maximo=c.evalExpression(this.max);a>this.maximo&&(this.value=null,a=this.maximo);var b=this.incr,a=0!=b?a*b/b:0;this.fixed&&(a=parseFloat(parseFloat(a).toFixed(c.evalExpression(this.decimals))));
return a};a.Scrollbar.prototype.formatOutputValue=function(a){var c=a+"",b=this.evaluator.evalExpression(this.decimals),f=c.indexOf(".");-1!=f&&c.substring(f+1).length>b&&(c=parseFloat(c).toFixed(b));this.fixed&&(c=parseFloat(a).toFixed(b));this.exponentialif&&(c=c.toExponential(b),c=c.toUpperCase(),c=c.replace("+",""));return c=c.replace(".",this.parent.decimal_symbol)};a.Scrollbar.prototype.increase=function(){this.changeValue(parseFloat(this.value)+this.incr)};a.Scrollbar.prototype.decrease=function(){this.changeValue(parseFloat(this.value)-
this.incr)};a.Scrollbar.prototype.increase10=function(){var a=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;"horizontal"==this.orientation?this.clickPos.x>this.prePos&&this.changeValue(parseFloat(this.value)+a):this.clickPos.y<this.prePos&&this.changeValue(parseFloat(this.value)+a)};a.Scrollbar.prototype.decrease10=function(){var a=(this.evaluator.evalExpression(this.max)-this.evaluator.evalExpression(this.min))/10;"horizontal"==this.orientation?this.clickPos.x<
this.prePos&&this.changeValue(parseFloat(this.value)-a):this.clickPos.y>this.prePos&&this.changeValue(parseFloat(this.value)-a)};a.Scrollbar.prototype.changeValue=function(a){this.evaluator.evalExpression(this.activeif)&&(a=this.validateValue(a),a!=this.value&&(this.value=a,this.field.value=this.formatOutputValue(a),this.changeScrollPositionFromValue(),this.prePos=this.pos,this.evaluator.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.updateControls(),
"animate"!=this.action&&this.parent.update()))};a.Scrollbar.prototype.changeValueForScrollMovement=function(){var a=this.evaluator,c=this.scrollManipulatorLimInf,b=this.scrollManipulatorLimSup,f=a.evalExpression(this.min),e=a.evalExpression(this.max),l=this.incr,c=g((this.pos-c)*(e-f)/(b-c)/l)*l+f;c!=this.value&&(this.value=c,this.field.value=this.formatOutputValue(c),a.setVariable(this.id,this.value),this.parent.updateControls(),this.actionExec.execute(),this.parent.update())};a.Scrollbar.prototype.changeScrollPositionFromValue=
function(){var a=this.evaluator,c=this.scrollManipulatorLimInf,b=this.scrollManipulatorLimSup,f=a.evalExpression(this.min),a=a.evalExpression(this.max);this.pos=(this.value-f)*(b-c)/(a-f)+c;"horizontal"==this.orientation?this.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+this.scrollManipulatorWidth+"px; height : "+this.h+"px; left: "+this.pos+"px; top: 0px;"):this.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+
this.w+"px; height : "+this.scrollManipulatorHeight+"px; left: 0px; top: "+this.pos+"px;")};a.Scrollbar.prototype.registerMouseEvents=function(){function d(a,b,c,e){(n.up||n.down||n.canvasClick)&&1.0E-7<Math.abs(n.value-e)?(b.call(n),a=c?a:30,u=setTimeout(function(){d(a,b,!1,e)},a)):clearInterval(u)}function c(a){a.preventDefault();n.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==n.whichButton&&n.evaluator.evalExpression(n.activeif)&&
(n.clickPos=n.getCursorPosition(a),n.canvasClick=!0,"horizontal"==n.orientation?n.clickPos.x<n.prePos?d(v,n.decrease10,!0,n.minimo):d(v,n.increase10,!0,n.maximo):n.clickPos.y<n.prePos?d(v,n.increase10,!0,n.maximo):d(v,n.decrease10,!0,n.minimo))}function b(a){n.canvasClick=!1;clearInterval(u);a.preventDefault()}function f(a){!0==n.canvasClick&&(n.clickPos=n.getCursorPosition(a),a.preventDefault())}function e(a){n.evaluator.evalExpression(n.activeif)&&(n.scrollClick=!0,n.initPos=n.getCursorPosition(a),
window.addEventListener("mouseup",h,!1),window.addEventListener("mousemove",j,!1),a.preventDefault())}function g(a){n.evaluator.evalExpression(n.activeif)&&(n.scrollClick=!0,n.initPos=n.getCursorPosition(a),window.addEventListener("touchend",i,!1),window.addEventListener("touchmove",onToucheMove_scrollManipulator,!1),a.preventDefault())}function h(a){n.scrollClick=!1;n.prePos=n.pos;window.removeEventListener("mouseup",h,!1);window.removeEventListener("mousemove",j,!1);a.preventDefault()}function i(a){n.scrollClick=
!1;n.prePos=n.pos;window.removeEventListener("touchend",i,!1);window.removeEventListener("touchmove",j,!1);a.preventDefault()}function j(a){var b=n.getCursorPosition(a);"horizontal"==n.orientation?(n.pos=n.prePos-(n.initPos.x-b.x),n.pos<n.scrollManipulatorLimInf&&(n.pos=n.scrollManipulatorLimInf),n.pos>n.scrollManipulatorLimSup&&(n.pos=n.scrollManipulatorLimSup),n.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+n.scrollManipulatorWidth+
"px; height : "+n.h+"px; left: "+n.pos+"px; top: 0px;")):(n.pos=n.prePos-(n.initPos.y-b.y),n.pos>n.scrollManipulatorLimInf&&(n.pos=n.scrollManipulatorLimInf),n.pos<n.scrollManipulatorLimSup&&(n.pos=n.scrollManipulatorLimSup),n.scrollManipulator.setAttribute("style","background-color: rgba(255, 255, 255, 0); cursor: pointer; position: absolute; width : "+n.w+"px; height : "+n.scrollManipulatorHeight+"px; left: 0px; top: "+n.pos+"px;"));n.changeValueForScrollMovement();a.preventDefault()}function k(a){a.preventDefault();
n.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==n.whichButton&&n.evaluator.evalExpression(n.activeif)&&(n.up=!0,d(v,n.increase,!0,n.maximo))}function m(a){a.preventDefault();n.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"LEFT"==n.whichButton&&n.evaluator.evalExpression(n.activeif)&&(n.down=!0,d(v,n.decrease,!0,n.minimo))}function o(a){n.up=!1;clearInterval(u);
a.preventDefault()}function q(a){n.down=!1;clearInterval(u);a.preventDefault()}function p(a){n.up=!1;clearInterval(u);a.preventDefault()}function r(a){n.down=!1;clearInterval(u);a.preventDefault()}var n=this,t=a.hasTouchSupport,v=t?500:200,u;this.canvas.oncontextmenu=function(){return!1};this.divUp.oncontextmenu=function(){return!1};this.divDown.oncontextmenu=function(){return!1};this.field.addEventListener("keydown",function(a){13==a.keyCode&&n.changeValue(n.field.value)},!1);t?this.canvas.addEventListener("touchstart",
c,!1):this.canvas.addEventListener("mousedown",c,!1);t||this.divDown.addEventListener("mouseout",q,!1);t?window.addEventListener("touchend",b,!1):window.addEventListener("mouseup",b,!1);t?this.canvas.addEventListener("touchmove",f,!1):this.canvas.addEventListener("mousemove",f,!1);t?this.scrollManipulator.addEventListener("touchstart",g,!1):this.scrollManipulator.addEventListener("mousedown",e,!1);t?this.divUp.addEventListener("touchstart",k,!1):this.divUp.addEventListener("mousedown",k,!1);t?this.divDown.addEventListener("touchstart",
m,!1):this.divDown.addEventListener("mousedown",m,!1);t||this.divUp.addEventListener("mouseout",o,!1);t||this.divDown.addEventListener("mouseout",q,!1);t?window.addEventListener("touchend",p,!1):window.addEventListener("mouseup",p,!1);t?window.addEventListener("touchend",r,!1):window.addEventListener("mouseup",r,!1)};a.Scrollbar.prototype.getCursorPosition=function(d){d=a.getCursorPosition(d);return{x:d.x-(this.containerControl.offsetLeft+this.containerControl.parentNode.offsetLeft),y:d.y-(this.containerControl.offsetTop+
this.containerControl.parentNode.offsetTop)}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Audio=function(g,d){a.Control.call(this,g,d);var c=this.getContainer(),b=this.evaluator.evalExpression(this.expresion);4==b[0].length?(this.w=b[0][2],this.h=b[0][3]):(this.w=100,this.h=28);if(b=navigator.userAgent.toLowerCase().match("firefox")&&!0)this.audioContainer=document.createElement("div"),this.audioContainer.setAttribute("style","overflow: hidden; position: absolute; width: "+
this.w+"px; height: 35px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.audio=this.parent.getAudio(this.file);this.autoplay&&(this.audio.setAttribute("autoplay","autoplay"),this.audio.play());this.loop&&this.audio.setAttribute("loop","loop");this.audio.setAttribute("controls","controls");b?(this.audio.setAttribute("style","position: absolute; width: "+this.w+"px; height: 100px; left: 0px; top: -65px;"),this.audioContainer.appendChild(this.audio)):this.audio.setAttribute("style",
"position: absolute; width: "+this.w+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");c.childNodes[0]?b?c.insertBefore(this.audioContainer,c.childNodes[0]):c.insertBefore(this.audio,c.childNodes[0]):b?c.appendChild(this.audioContainer):c.appendChild(this.audio)};a.extend(a.Audio,a.Control);a.Audio.prototype.update=function(){var a=this.evaluator;a.evalExpression(this.drawif)?this.audio.style.display="block":(this.audio.style.display="none",this.audio.pause());a=a.evalExpression(this.expresion);
this.x=a[0][0];this.y=a[0][1];4==a[0].length&&(this.w=a[0][2],this.h=a[0][3])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Video=function(g,d){a.Control.call(this,g,d);var c=this.evaluator,b=this.getContainer(),f=this.evaluator.evalExpression(this.expresion);4==f[0].length?(this.w=f[0][2],this.h=f[0][3]):this.h=this.w=null;this.video=document.createElement("video");c.evalExpression(this.drawif)?this.video.style.display="block":(this.video.style.display="none",this.video.pause());
this.autoplay&&this.video.setAttribute("autoplay","autoplay");this.loop&&this.video.setAttribute("loop","loop");this.video.setAttribute("controls","controls");this.poster&&this.video.setAttribute("poster",this.poster);this.w&&(this.video.setAttribute("width",this.w),this.video.setAttribute("height",this.h));this.video.setAttribute("style","position: absolute; overflow: hidden; left: "+this.x+"px; top: "+this.y+"px;");c=this.file;f=this.file.lastIndexOf(".");-1!=f&&(c=this.file.substring(0,f));f=document.createElement("source");
f.setAttribute("src",c+".ogg");f.setAttribute("type","video/ogg");this.video.appendChild(f);f=document.createElement("source");f.setAttribute("src",c+".mp4");f.setAttribute("type","video/mp4");this.video.appendChild(f);f=document.createElement("source");f.setAttribute("src",c+".webm");f.setAttribute("type","video/webm");this.video.appendChild(f);b.childNodes[0]?b.insertBefore(this.video,b.childNodes[0]):b.appendChild(this.video)};a.extend(a.Video,a.Control);a.Video.prototype.update=function(){var a=
this.evaluator;a.evalExpression(this.drawif)?this.video.style.display="block":(this.video.style.display="none",this.video.pause());a=a.evalExpression(this.expresion);this.x=a[0][0];this.y=a[0][1];4==a[0].length&&(this.w=a[0][2],this.h=a[0][3])};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.TextArea=function(d,c){a.Control.call(this,d,c);this.region="interior";this.tabindex=++this.parent.tabindex;this.answer&&this.answer.match("krypto_")&&(this.answer=
(new a.Krypto).decode(this.answer.substring(7)));var b=this.getContainer();this.containerControl=document.createElement("div");this.textArea=document.createElement("div");this.textAreaAnswer=document.createElement("div");this.showButton=document.createElement("div");this.activeCover=document.createElement("div");this.containerControl.appendChild(this.textArea);this.containerControl.appendChild(this.textAreaAnswer);this.containerControl.appendChild(this.showButton);this.containerControl.appendChild(this.activeCover);
b.childNodes[0]?b.insertBefore(this.containerControl,b.childNodes[0]):b.appendChild(this.containerControl);this.showAnswer=!1;this.text=void 0==this.text.type?this.rawText:this.text.hasFormula?this.rawText:this.text.toHTML();b=this.parent.lessonParser.parseText(this.answer);void 0!=b.type&&!this.text.hasFormula&&(this.answer=b.toHTML());this.evaluator.setVariable(this.id,this.text);this.drawButton();this.init();this.registerMouseEvents()};a.extend(a.TextArea,a.Control);a.TextArea.prototype.init=function(){var d=
this.answer?28:8;evaluator=this.evaluator;this.text=evaluator.getVariable(this.id);this.containerControl.setAttribute("class","DescartesTextAreaContainer");this.containerControl.setAttribute("style","width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.containerControl.style.display=evaluator.evalExpression(this.drawif)?"block":"none";this.containerControl.setAttribute("spellcheck","false");this.textArea.setAttribute("class","DescartesTextAreaContainer");
this.textArea.setAttribute("style","width: "+(this.w-8)+"px; height: "+(this.h-d)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textArea.setAttribute("contenteditable","true");this.textArea.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;' >"+this.text+"</span>";this.textAreaAnswer.setAttribute("class","DescartesTextAreaContainer");this.textAreaAnswer.setAttribute("style","width: "+(this.w-8)+
"px; height: "+(this.h-d)+"px; left: 4px; top: 4px; background-color: white; text-align: left; font: "+a.convertFont(this.font)+";");this.textAreaAnswer.style.display=this.showAnswer?"block":"none";this.textAreaAnswer.innerHTML="<span style='position: relative; top: 10px; left: 10px; white-space: nowrap;'>"+this.answer+"</span>";this.showButton.setAttribute("style","width: 20px; height: 16px; position: absolute; bottom: 4px; right: 4px; cursor: pointer;");this.showButton.style.backgroundImage="url("+
this.imageUnPush+")";this.showButton.innerHTML="<span style='position: relative; top: 2px; text-align: center; font: 9px Arial'> S </span>";this.activeCover.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.activeCover.style.display=evaluator.evalExpression(this.activeif)?"none":"block"};a.TextArea.prototype.drawButton=function(){var d=document.createElement("canvas");d.setAttribute("width",20);d.setAttribute("height",
16);for(var c=d.getContext("2d"),b=c.createLinearGradient(0,0,0,16),f,e=0;16>e;e++)f=g(e-5.6),b.addColorStop(e/16,"rgba(0,0,0,"+192*f*f/256/255+")");c.lineWidth=1;c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=b;c.fillRect(0,0,20,16);a.drawLine(c,19,0,19,16,"rgba(0,0,0,"+128/255+")");a.drawLine(c,0,0,0,16,"rgba(0,0,0,"+24/255+")");a.drawLine(c,1,0,1,16,"rgba(0,0,0,"+8/255+")");this.imageUnPush=d.toDataURL();c.fillStyle="white";c.fillRect(0,0,20,16);c.fillStyle=b;c.fillRect(0,0,20,16);a.drawLine(c,
0,0,0,14,"gray");a.drawLine(c,0,0,19,0,"gray");c.fillStyle="rgba(0, 0, 0,"+24/255+")";c.fillRect(0,0,this.w,this.h);this.imagePush=d.toDataURL()};a.TextArea.prototype.update=function(){evaluator=this.evaluator;evaluator.setVariable(this.id,this.text);var a=!1,c=!1,b=!1,f=!1;this.activeCover.style.display=evaluator.evalExpression(this.activeif)?"none":"block";this.containerControl.style.display=evaluator.evalExpression(this.drawif)?"block":"none";var e=evaluator.evalExpression(this.expresion),a=this.x!=
e[0][0],c=this.y!=e[0][1];this.x=e[0][0];this.y=e[0][1];4==e[0].length&&(b=this.w!=e[0][2],f=this.h!=e[0][3],this.w=e[0][2],this.h=e[0][3]);(b||f||a||c)&&this.init()};a.TextArea.prototype.registerMouseEvents=function(){function a(b){b.preventDefault();c.showButton.style.backgroundImage="url("+c.imageUnPush+")"}var c=this;this.showButton.addEventListener("mousedown",function(a){a.preventDefault();c.showAnswer=!c.showAnswer;c.textAreaAnswer.style.display=c.showAnswer?"block":"none";c.showButton.childNodes[0].childNodes[0].textContent=
c.showAnswer?"T":"S";c.showButton.style.backgroundImage="url("+c.imagePush+")"});this.showButton.addEventListener("mouseup",a);this.showButton.addEventListener("mouseout",a)};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.LessonParser=function(a){this.parent=a;this.parser=this.parent.evaluator.parser};a.LessonParser.prototype.parseButtonsConfig=function(a){for(var d={rowsNorth:0,rowsSouth:0,widthEast:125,widthWest:125,height:23},a=this.split(a),c,b,f=0,e=a.length;f<e;f++)switch(c=
a[f][0],b=a[f][1],babel[c]){case "rowsNorth":d.rowsNorth=parseInt(b);break;case "rowsSouth":d.rowsSouth=parseInt(b);break;case "widthEast":d.widthEast=parseInt(b);break;case "widthWest":d.widthWest=parseInt(b);break;case "height":d.height=parseInt(b);break;case "about":d.about="true"==babel[b];break;case "config":d.config="true"==babel[b];break;case "init":d.init="true"==babel[b];break;case "clear":d.clear="true"==babel[b];break;default:console.log("----- attributo de Espacio no identificado: <"+
c+"> valor: <"+b+"> -----")}return d};a.LessonParser.prototype.parseSpace=function(g){for(var d={},c,g=this.split(g),b,f=0,e=g.length;f<e;f++)switch(c=g[f][0],b=g[f][1],babel[c]){case "type":d.type=b;break;case "id":d.id=b;break;case "x":c=b;c="%"==c[c.length-1]?(this.parent.container.width*parseFloat(c)/100).toString():b;d.xExpr=this.parser.parse(c);break;case "y":c=b;c="%"==c[c.length-1]?(this.parent.container.height*parseFloat(c)/100).toString():b;d.yExpr=this.parser.parse(c);break;case "width":c=
b;"%"==c[c.length-1]?c=this.parent.container.width*parseFloat(c)/100:(c=parseFloat(b),c!=b&&(c=this.parent.container.width));d.w=c;break;case "height":c=b;"%"==c[c.length-1]?c=this.parent.container.height*parseFloat(c)/100:(c=parseFloat(b),c!=b&&(c=this.parent.container.height));d.h=c;break;case "drawif":d.drawif=this.parser.parse(b);break;case "fixed":d.fixed="true"==babel[b];break;case "scale":c=parseFloat(b);c!=b&&(c=48);d.scale=c;break;case "O.x":d.OxExpr=b;break;case "O.y":d.OyExpr=b;break;case "image":d.imageSrc=
b;break;case "bg_display":d.bg_display=babel[b];break;case "background":d.background=this.convertColor(b);break;case "net":d.net="false"==babel[b]?"":this.convertColor(b);break;case "net10":d.net10="false"==babel[b]?"":this.convertColor(b);break;case "axes":d.axes="false"==babel[b]?"":this.convertColor(b);break;case "text":d.text="false"==babel[b]?"":this.convertColor(b);break;case "numbers":d.numbers="true"==babel[b];break;case "x-axis":d.x_axis=b;break;case "y-axis":d.y_axis=b;break;case "sensitive_to_mouse_movements":d.sensitive_to_mouse_movements=
"true"==babel[b];break;case "cID":d.cID=b;break;case "R3":d.R3="true"==babel[b];break;case "render":d.render=babel[b];break;case "split":d.split="true"==babel[b];break;case "file":d.file=b;break;default:console.log("----- attributo de Espacio no identificado: <"+c+"> valor: <"+b+"> -----")}if("R2"==d.type||2==this.parent.version)return new a.Space2D(this.parent,d);if("R3"==d.type)return new a.Space3D(this.parent,d);if("AP"==d.type)return new a.SpaceAP(this.parent,d);if("HTMLIFrame"==d.type)return new a.SpaceHTML_IFrame(this.parent,
d)};a.LessonParser.prototype.parseControl=function(g){for(var d={},g=this.split(g),c,b,f=0,e=g.length;f<e;f++)switch(c=g[f][0],b=g[f][1],babel[c]){case "id":d.id=b;break;case "type":d.type=babel[b];break;case "gui":d.gui=babel[b];break;case "region":d.region=babel[b];break;case "space":d.spaceID=b;break;case "name":d.name=b;break;case "expresion":d.expresion=this.parser.parse(b.replace(")(",","));break;case "fixed":d.fixed="true"==babel[b];break;case "visible":d.visible="true"==babel[b];break;case "color":d.color=
this.convertColor(b);break;case "colorInt":d.colorInt=this.convertColor(b);break;case "bold":"false"!=babel[b]&&(d.bold="bold");break;case "italics":"false"!=babel[b]&&(d.italics="italic");break;case "underlined":"false"!=babel[b]&&(d.underlined=!0);break;case "font_size":d.font_size=this.parser.parse(b);break;case "image":d.imageSrc=b;break;case "action":d.action=babel[b];break;case "parameter":d.parameter=b;break;case "drawif":d.drawif=this.parser.parse(b);break;case "activeif":d.activeif=this.parser.parse(b);
break;case "tooltip":d.tooltip=b;break;case "tooltipFont":d.tooltipFont=b;break;case "Explanation":d.Explanation=b;break;case "ExplanationFont":d.ExplanationFont=b;break;case "msg_pos":d.msg_pos=babel[b];break;case "cID":d.cID=b;break;case "value":c=b.replace(/&squot;/g,"'");c.match(/^\|/)&&(c="'"+c.substring(1),c.match(/\|$/)&&(c=c.substring(0,c.length-1)+"'"));d.valueExpr=this.parser.parse(c);break;case "decimals":d.decimals=this.parser.parse(b);break;case "min":d.min=this.parser.parse(b);break;
case "max":d.max=this.parser.parse(b);break;case "incr":d.incr=this.parser.parse(b);break;case "discrete":d.discrete="true"==babel[b];break;case "onlyText":d.onlyText="true"==babel[b];break;case "evaluate":d.evaluate="true"==babel[b];break;case "answer":d.answer=b;break;case "exponentialif":d.exponentialif=parseFloat(b);break;case "size":d.size=this.parser.parse(b);break;case "constraint":d.constraintExpr=b;break;case "text":d.rawText=b;c=this.parseText(b);b=0;for(var l=c.length;b<l;b++)c[b]=this.parser.parse(c[b],
!1);d.text=c;break;case "trace":d.trace=this.convertColor(b);break;case "options":d.options=b;break;case "font":d.font=b;break;case "file":d.file=b;break;case "autoplay":d.autoplay="true"==babel[b];break;case "loop":d.loop="true"==babel[b];break;case "controls":d.controls="true"==babel[b];break;case "poster":d.poster=babel[b];break;default:var h=c.indexOf("."),l=babel[c.substring(0,h)],h=babel[c.substring(h+1)];if("parameter"==l&&"font"==h){d.parameterFont=b;break}else if("Explanation"==l&&"font"==
h){d.ExplanationFont=b;break}else if("tooltip"==l&&"font"==h){d.tooltipFont=b;break}console.log("----- attributo de control no identificado: <"+c+"> valor: <"+b+"> -----")}if("numeric"==d.type){if(void 0==d.gui||"spinner"==d.gui)return new a.Spinner(this.parent,d);if("button"==d.gui)return new a.Button(this.parent,d);if("textfield"==d.gui)return new a.TextField(this.parent,d);if("menu"==d.gui)return new a.Menu(this.parent,d);if("scrollbar"==d.gui)return new a.Scrollbar(this.parent,d)}else{if("video"==
d.type)return new a.Video(this.parent,d);if("audio"==d.type)return new a.Audio(this.parent,d);if("graphic"==d.type)return new a.GraphicControl(this.parent,d);if("text"==d.type)return new a.TextArea(this.parent,d)}};a.LessonParser.prototype.parseGraphic=function(g,d,c,b){for(var b={rotateExp:b,parameter:"t"},g=this.split(g),f,e,l=0,h=g.length;l<h;l++)switch(f=g[l][0],e=g[l][1],babel[f]){case "space":b.spaceID=e;break;case "type":b.type=babel[e];break;case "background":b.background="true"==babel[e];
break;case "color":b.color=this.convertColor(e);break;case "drawif":b.drawif=this.parser.parse(e);break;case "abs_coord":b.abs_coord="true"==babel[e];break;case "expresion":"macro"!=b.type?(b.expresion=this.parser.parse(e),b.expresionString=e):b.expresion=e;break;case "trace":b.trace=this.convertColor(e);break;case "family":b.family=e;break;case "parameter":b.parameter=e;break;case "fill":b.fill=this.convertColor(e);break;case "fillP":b.fillP=this.convertColor(e);break;case "fillM":b.fillM=this.convertColor(e);
break;case "width":b.width=this.parser.parse(e);break;case "visible":b.visible="true"==babel[e];break;case "editable":b.editable="true"==babel[e];break;case "info":b.info=e;break;case "text":f=this.parseText(e);e=0;for(var i=f.length;e<i;e++)f[e]=this.parser.parse(f[e],!1);b.text=f;break;case "font":b.font=e;break;case "fixed":b.fixed="true"==babel[e];break;case "decimals":b.decimals=this.parser.parse(e);break;case "size":b.size=this.parser.parse(e);break;case "spear":b.spear=this.parser.parse(e);
break;case "arrow":b.arrow=this.convertColor(e);break;case "center":b.center=this.parser.parse(e);break;case "radius":b.radius=this.parser.parse(e);break;case "init":b.init=this.parser.parse(e);break;case "end":b.end=this.parser.parse(e);break;case "vectors":b.vectors="true"==babel[e];break;case "file":f=e.replace(/&squot;/g,"'");"["==f.charAt(0)&&"]"==f.charAt(f.length-1)&&(f=f.substring(1,f.length-1));f.match(/.jpg$|.png$|.gif$|.svg$/)&&(f="'"+f+"'");b.file=this.parser.parse(f);break;case "inirot":b.inirot=
this.parser.parse(e);break;case "opacity":b.opacity=this.parser.parse(e);break;case "inipos":b.inipos=this.parser.parse(e);break;case "name":b.name=e;break;case "range":b.range=this.parser.parse(e);break;case "border":"false"!=babel[e]&&(b.border=this.convertColor(e));break;case "align":b.align=babel[e];break;default:if(void 0!=b.family&&f.substring(0,b.family.length+1)==b.family+"."){switch(babel[f.substring(b.family.length+1)]){case "interval":b.family_interval=this.parser.parse(e);break;case "steps":b.family_steps=
this.parser.parse(e)}break}if(void 0!=b.parameter&&f.substring(0,b.parameter.length+1)==b.parameter+"."){switch(babel[f.substring(b.parameter.length+1)]){case "interval":b.parameter_interval=this.parser.parse(e);break;case "steps":b.parameter_steps=this.parser.parse(e)}break}console.log("----- attributo del grafico no identificado: <"+f+"> valor: <"+e+"> -----")}d&&(b.abs_coord=d);c&&(b.background=c);if("equation"==b.type)return new a.Equation(this.parent,b);if("curve"==b.type)return new a.Curve(this.parent,
b);if("sequence"==b.type)return new a.Sequence(this.parent,b);if("point"==b.type)return new a.Point(this.parent,b);if("segment"==b.type)return new a.Segment(this.parent,b);if("arrow"==b.type)return new a.Arrow(this.parent,b);if("polygon"==b.type)return new a.Polygon(this.parent,b);if("arc"==b.type)return new a.Arc(this.parent,b);if("text"==b.type)return new a.Text(this.parent,b);if("image"==b.type)return new a.Image(this.parent,b);if("macro"==b.type)return new a.Macro(this.parent,b)};a.LessonParser.prototype.parse3DGraphic=
function(g,d,c,b){for(var d={rotateExp:b,parameter:"t"},g=this.split(g),f,e,c=0,b=g.length;c<b;c++)switch(f=g[c][0],e=g[c][1],babel[f]){case "space":d.spaceID=e;break;case "type":d.type=babel[e];break;case "background":d.background="true"==babel[e];break;case "color":d.color=this.convertColor(e);break;case "drawif":d.drawif=this.parser.parse(e);break;case "expresion":"macro"!=d.type&&"curve"!=d.type&&"surface"!=d.type?(d.expresion=this.parser.parse(e),d.expresionString=e):d.expresion=e;break;case "family":d.family=
e;break;case "parameter":d.parameter=e;break;case "width":d.width=this.parser.parse(e);break;case "length":d.length=this.parser.parse(e);break;case "text":f=this.parseText(e);e=0;for(var l=f.length;e<l;e++)f[e]=this.parser.parse(f[e],!1);d.text=f;break;case "font":d.font=e;break;case "fixed":d.fixed="true"==babel[e];break;case "decimals":d.decimals=this.parser.parse(e);break;case "model":d.model=babel[e];break;case "edges":d.edges="true"==babel[e];break;case "Nu":d.Nu=this.parser.parse(e);break;case "Nv":d.Nu=
this.parser.parse(e);break;case "name":d.name=e;break;case "backcolor":d.backcolor=this.convertColor(e);break;case "inirot":d.inirot=this.parser.parse(e);break;case "endrot":d.endrot=this.parser.parse(e);break;case "inipos":d.inipos=this.parser.parse(e);break;case "endpos":d.endpos=this.parser.parse(e);break;default:if(void 0!=d.family&&f.substring(0,d.family.length+1)==d.family+"."){switch(babel[f.substring(d.family.length+1)]){case "interval":d.family_interval=this.parser.parse(e);break;case "steps":d.family_steps=
this.parser.parse(e)}break}if(void 0!=d.parameter&&f.substring(0,d.parameter.length+1)==d.parameter+"."){switch(babel[f.substring(d.parameter.length+1)]){case "interval":d.parameter_interval=this.parser.parse(e);break;case "steps":d.parameter_steps=this.parser.parse(e)}break}console.log("----- attributo del grafico no identificado: <"+f+"> valor: <"+e+"> -----")}if("point"==d.type)return new a.Point3D(this.parent,d);if("segment"==d.type)return new a.Segment3D(this.parent,d);if("polygon"==d.type)return new a.Polygon3D(this.parent,
d);if("curve"==d.type)return new a.Curve3D(this.parent,d);if("triangle"==d.type)return new a.Triangle3D(this.parent,d);if("face"==d.type)return new a.Face3D(this.parent,d);if("polireg"==d.type)return new a.Polireg3D(this.parent,d);if("surface"==d.type)return new a.Surface3D(this.parent,d);if("text"==d.type)return new a.Text3D(this.parent,d);console.log(d.type)};a.LessonParser.prototype.parseAuxiliar=function(g){for(var d={},g=this.split(g),c=0,b=g.length;c<b;c++)g[c][1]=g[c][1].replace(/&squot;/g,
"'");for(var f,e,c=0,b=g.length;c<b;c++)switch(f=g[c][0],e=g[c][1],babel[f]){case "id":d.id=e;break;case "editable":d.editable="true"==babel[e];break;case "constant":d.constant="true"==babel[e];break;case "array":d.array="true"==babel[e];break;case "file":d.file=e;break;case "matrix":d.matrix="true"==babel[e];break;case "rows":d.rows=this.parser.parse(e);break;case "columns":d.columns=this.parser.parse(e);break;case "algorithm":d.algorithm="true"==babel[e];break;case "init":d.init=e;break;case "do":d.doExpr=
e;break;case "while":d.whileExpr=e;break;case "range":d.range=e;break;case "expresion":d.expresion=e;break;case "size":d.size=this.parser.parse(e);break;case "evaluate":d.evaluate=babel[e];break;case "event":d.event=babel[e];break;case "condition":d.condition=e;break;case "execution":d.execution=babel[e];break;case "msg_pos":d.msg_pos=babel[e];break;case "action":d.action=babel[e];break;case "parameter":d.parameter=e;break;case "sequence":d.sequence="true"==babel[e];break;default:var l=f.indexOf("."),
h=babel[f.substring(0,l)],l=babel[f.substring(l+1)];if("parameter"==h&&"font"==l){d.parameterFont=e;break}console.log("----- attributo de auxiliar no identificado: <"+f+"> valor: <"+e+"> -----")}d.sequence?new a.AuxSequence(this.parent,d):d.constant?(g=new a.Constant(this.parent,d),d.evaluate&&"always"==d.evaluate&&this.parent.auxiliaries.push(g)):d.algorithm&&d.evaluate?this.parent.auxiliaries.push(new a.Algorithm(this.parent,d)):d.array&&!d.matrix&&")"!=d.id.charAt(d.id.length-1)?(g=new a.Vector(this.parent,
d),d.evaluate&&"always"==d.evaluate&&this.parent.auxiliaries.push(g)):d.matrix&&")"!=d.id.charAt(d.id.length-1)?(g=new a.Matrix(this.parent,d),d.evaluate&&"always"==d.evaluate&&this.parent.auxiliaries.push(g)):d.event&&")"!=d.id.charAt(d.id.length-1)?this.parent.events.push(new a.Event(this.parent,d)):")"==d.id.charAt(d.id.length-1)?new a.Function(this.parent,d):new a.Variable(this.parent,d)};a.LessonParser.prototype.parseAction=function(g){var d=g.action,c=g.parent,g=g.parameter;if(d)switch(d){case "message":return new a.Message(c,
g);case "calculate":return new a.Calculate(c,g);case "openURL":return new a.OpenURL(c,g);case "openScene":return new a.OpenScene(c,g);case "about":return new a.About(c,g);case "config":return new a.Config(c,g);case "init":return new a.Init(c,g);case "clear":return new a.Clear(c,g);case "animate":return new a.Animate(c,g);case "initAnimation":return new a.InitAnimation(c,g);case "playAudio":return new a.PlayAudio(c,g);default:console.log("----- Accion no soportada aun: <"+d+"> -----")}else return{execute:function(){}}};
a.LessonParser.prototype.parseAnimation=function(g){for(var d={},g=this.split(g),c,b,f=0,e=g.length;f<e;f++)switch(c=g[f][0],b=g[f][1],babel[c]){case "delay":d.delay=b;break;case "controls":d.controls="true"==babel[b];break;case "auto":d.auto="true"==babel[b];break;case "loop":d.loop="true"==babel[b];break;case "init":d.init=b;break;case "do":d.doExpr=b;break;case "while":d.whileExpr=b;break;case "id":d.id=b;break;case "algorithm":d.algorithm="true"==babel[b];break;case "evaluate":d.evaluate="true"==
babel[b];break;default:console.log("----- attributo de la animacion no identificado: <"+c+">  <"+b+"> -----")}return new a.Animation(this.parent,d)};a.LessonParser.prototype.parsePleca=function(g,d){var g=this.split(g),c,b,f,e,l,h,i,j,k;b=c="";f=0;e="white";l="black";h="left";i="";j="SansSerif,PLAIN,22";k="SansSerif,PLAIN,20";for(var m,o,q=0,p=g.length;q<p;q++)switch(m=g[q][0],o=g[q][1],m){case "title":c=o;break;case "subtitle":b=o;break;case "subtitlines":f=o;break;case "bgcolor":e="#"+a.getColor(this.evaluator,
o);break;case "fgcolor":l="#"+a.getColor(this.evaluator,o);break;case "align":h=o;break;case "titleimage":i=o;break;case "titlefont":j=a.convertFont(o);break;case "subtitlefont":k=a.convertFont(o);break;default:console.log("----- attributo de la pleca no identificado: <"+m+">  <"+o+"> -----")}m=k.substring(0,k.indexOf("px"));m=m.substring(m.lastIndexOf(" "));var r,n;""!=i&&(r=this.parent.getImage(i),n=r.height);i=document.createElement("div");i.setAttribute("id","descartesPleca");n?(i.setAttribute("style",
"position: absolute; left: 0px; top: 0px; text-align: "+h+"; width: "+(d-30)+"px; height: "+(n-16)+"px; background: "+e+"; color: "+l+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; overflow: hidden; z-index: 100;"),r.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: -1; width: 100%; height: 100%"),i.appendChild(r)):i.setAttribute("style","position: absolute; left: 0px; top: 0px; text-align: "+h+"; width: "+(d-30)+"px; background: "+
e+"; color: "+l+"; padding-top: 8px; padding-bottom: 8px; padding-left: 15px; padding-right: 15px; margin: 0px; z-index: 100;");e=document.createElement("div");e.setAttribute("style","padding: 0px; margin: 0px; font: "+j+"; overflow: hidden; white-space: nowrap;");e.innerHTML=c;c=document.createElement("div");if(1==parseInt(f)){l=0;f=document.createElement("div");f.innerHTML=b;document.body.appendChild(f);j=m;do j-=l,f.setAttribute("style","padding: 0px; margin: 0px; font: "+k+"; font-size: "+j+"px; width: "+
(d-30)+"px; line-height: "+j+"px;"),l=f.offsetHeight,h=l/j,l=1;while(1<h&&8<j);document.body.removeChild(f);c.setAttribute("style","padding: 0px; margin: 0px; font: "+k+"; font-size: "+j+"px; line-height: 110%; overflow: hidden; white-space: nowrap;")}else c.setAttribute("style","padding: 0px; margin: 0px; font: "+k+"; line-height: 110%;");c.innerHTML=b;i.appendChild(e);i.appendChild(c);i.imageHeight=n;return i};a.LessonParser.prototype.split=function(a){for(var a=(a||"").replace(/\\'/g,"\u2019"),
d=[],c=0,b=0,f=!1,e=0,l=!1,h=!1;c<a.length;)" "==a.charAt(c)&&!f&&c++," "!=a.charAt(c)&&!f&&(f=!0,e=c),"="==a.charAt(c)&&"'"==a.charAt(c+1)&&!l&&(l=!0,d[b]=[a.substring(e,c)],e=c+2,c+=2),l&&"'"==a.charAt(c)&&(f=l=!1,d[b].push(a.substring(e,c)),b++),"="==a.charAt(c)&&"'"!=a.charAt(c+1)&&!l&&(h=!0,d[b]=[a.substring(e,c)],e=c+1,c++),h&&" "==a.charAt(c)&&(f=h=!1,d[b].push(a.substring(e,c)),b++),h&&c==a.length-1&&d[b].push(a.substring(e,a.length)),c++;return d};a.LessonParser.prototype.splitComa=function(a){for(var d=
[],c=[],b=0,f=0,e=a.length;f<e;f++)"("==a.charAt(f)?c.push(f):")"==a.charAt(f)?c.pop():","==a.charAt(f)&&0==c.length&&(d.push(a.substring(b,f)),b=f+1);d.push(a.substring(b));return d};a.LessonParser.prototype.convertColor=function(a){if(babel[a])return"net"==babel[a]?"red":babel[a];if(6==a.length)return"#"+a;if(8==a.length)return"rgba("+parseInt("0x"+a.substring(2,4),16)+","+parseInt("0x"+a.substring(4,6),16)+","+parseInt("0x"+a.substring(6,8),16)+","+(1-parseInt("0x"+a.substring(0,2),16)/255)+")";
if("("==a[0]){for(var d="(",a=this.splitComa(a.substring(1,a.length-1)),c,b=0,f=a.length;b<f;b++)c=parseInt(a[b],16),a[b]!=c.toString(16)?("["==a[b].charAt(0)&&"]"==a[b].charAt(a[b].length-1)&&(a[b]=a[b].substring(1,a[b].length-1)),d=d+a[b]+(b<f-1?",":")")):d=d+c/255+(b<f-1?",":")");return this.parser.parse(d)}return"#aa0000"};a.LessonParser.prototype.parseText=function(g){if(g.match(/^\{\\rtf1/))return(new a.RTFParser(this.parent.evaluator)).parse(g.substring(10,g.length-1));for(var g=g.split("\\n"),
d=0,c=g.length;d<c;d++)g[d]=this.parseTextElement(g[d]);return g};a.LessonParser.prototype.parseTextElement=function(a){for(var a=a.replace(/&squot;/g,"'"),d="'",c=0,b=-1;c<a.length;)"["==a.charAt(c)&&"\\"==a.charAt(c-1)?d=d.substring(0,d.length-1)+"[":"]"==a.charAt(c)&&"\\"==a.charAt(c-1)?d=d.substring(0,d.length-1)+"]":"["==a.charAt(c)&&-1==b?(b++,d+="'+("):"["==a.charAt(c)?(b++,d+=a.charAt(c)):"]"==a.charAt(c)&&0==b?(b--,d+=")+'"):("]"==a.charAt(c)&&(b=0>b?b:b-1),d+=a.charAt(c)),c++;return d+"'"};
return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Node=function(a,d){this.sep="";this.type=a;this.value=d;this.parent=null;this.childs=[]};a.Node.prototype.getRoot=function(){return null==this.parent?this:this.parent.getRoot()};a.Node.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.Node.prototype.replaceLastChild=function(a){var d=this.childs.length-1;this.childs[d].parent=null;this.childs[d]=a;a.parent=this;return a};a.Node.prototype.toString=function(){var a=
"tipo: "+this.type+", valor: "+this.value+"\n";this.sep="   "+(this.parent?this.parent.sep:"");for(var d=0,c=this.childs.length;d<c;d++)a+=this.sep+this.childs[d].toString();return a};a.Node.prototype.contains=function(a){if(this.value==a)return!0;for(var d=0,c=this.childs.length;d<c;d++)if(this.childs[d].contains(a))return!0;return!1};a.Node.prototype.equalToMinus=function(){if("compOperator"==this.type){this.type="operator";this.value="-";var g=new a.Node("compOperator","=="),d=new a.Node("number",
"0");g.addChild(this);g.addChild(d);return this.getRoot()}return this};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Tokenizer=function(){};a.Tokenizer.prototype.tokenize=function(a){var d=a;a&&(a=a.replace(/\&sup(.+);/g,"^$1 "),a=a.replace(/&squot;/g,"'"),a.match(/\=\|\*/g)&&(a=a.replace("|*","'","g").replace("*|","'","g")));for(var c=[],b=!1,f=0,e,l=a,h=0,i=function(a,b,d){c.push({type:a,value:b});l=l.slice(d);f=f+d;h++};a&&f<a.length;)if(b=f,"'"==l[0]){for(e=1;"'"!=
l[e];)if(e<l.length)e++;else{console.log(">Error, simbolo no conocido: ["+l+"], en la cadena <<"+d+">>");return}e=l.substring(1,e);i("string",e,e.length+2)}else if(e=l.match(/^\s+/))l=l.slice(e[0].length),f+=e[0].length,h++;else if(e=l.match(/^[a-zA-Z_\u00C0-\u021B]+[a-zA-Z_0-9\u00C0-\u021B]*([.]*[0-9a-zA-Z_\u00C0-\u021B]+[0-9]*)*/))i("identifier",e[0],e[0].length);else if(e=l.match(/^[0-9]+[.][0-9]+|^[.][0-9]+|^[0-9]+/))i("number",e[0],e[0].length);else if(e=l.match(/^==|^!=|^<=|^<|^>=|^>|^#/))b=
e[0],"#"==b&&(b="!="),i("compOperator",b,e[0].length);else if(e=l.match(/^\!|^\~|^\&\&|^\&|^\|\||^\|/))b=e[0],"||"==b?b="|":"&&"==b?b="&":"~"==b&&(b="!"),i("boolOperator",b,e[0].length);else if((e=l.match(/^=/))&&!l.match(/^==/))i("asign",e[0],e[0].length);else if(e=l.match(/^[\?\:]/))i("conditional",e[0],e[0].length);else if(e=l.match(/^[\+\-\*\/\%\^]/))i("operator",e[0],e[0].length);else if(e=l.match(/^\[|^\]/))i("square_bracket",e[0],e[0].length);else if(e=l.match(/^\(|^\)/))i("parentheses",e[0],
e[0].length);else if(e=l.match(/^,/))i("separator",e[0],e[0].length);else if(e=l.match(/^;/))i("final_of_expresion",e[0],e[0].length);else if(b==f){console.log("Error, simbolo no conocido: ["+l+"], en la cadena <<"+d+">>");return}return c};a.Tokenizer.prototype.flatTokens=function(a){for(var a=a||[],d="",c=0,b=a.length;c<b;c++)d="string"==a[c].type?d+"&squot;"+a[c].value+"&squot;":d+a[c].value;return d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.Parser=function(g){this.evaluator=
g;this.tokenizer=new a.Tokenizer;this.vectors={};this.matrices={};this.variables={};this.functions={};this.variables.rnd=Math.random;this.variables.pi=Math.PI;this.variables.e=Math.E;this.variables.Infinity=Infinity;this.variables["-Infinity"]=-Infinity;this.functions.sqr=function(a){return a*a};this.functions.sqrt=this.functions["ra\u00edz"]=Math.sqrt;this.functions.exp=Math.exp;this.functions.log=Math.log;this.functions.log10=function(a){return Math.log(a)/Math.log(10)};this.functions.abs=Math.abs;
this.functions.ent=Math.floor;this.functions.sgn=function(a){return 0<a?1:0>a?-1:0};this.functions.ind=function(a){return a?1:0};this.functions.sin=this.functions.sen=Math.sin;this.functions.cos=Math.cos;this.functions.tan=Math.tan;this.functions.cot=function(a){return 1/Math.tan(a)};this.functions.sec=function(a){return 1/Math.cos(a)};this.functions.csc=function(a){return 1/Math.sin(a)};this.functions.sinh=this.functions.senh=function(a){return(Math.exp(a)-Math.exp(-a))/2};this.functions.cosh=function(a){return(Math.exp(a)+
Math.exp(-a))/2};this.functions.tanh=function(a){return(Math.exp(a)-Math.exp(-a))/(Math.exp(a)+Math.exp(-a))};this.functions.coth=function(a){return 1/this.functions.tanh(a)};this.functions.sech=function(a){return 1/this.functions.cosh(a)};this.functions.csch=function(a){return 1/this.functions.sinh(a)};this.functions.asin=this.functions.asen=Math.asin;this.functions.acos=Math.acos;this.functions.atan=Math.atan;this.functions.min=Math.min;this.functions.max=Math.max;this.functions.esCorrecto=function(d,
c){return a.esCorrecto(d,c)};this.functions.escorrecto=function(d,c){return a.escorrecto(d,c)};window.parent.location.href!==window.location.href&&(this.functions["parent.set"]=function(a,c){window.parent.postMessage({type:"set",name:a,value:c},"*")},this.functions["parent.update"]=function(){window.parent.postMessage({type:"update"},"*")},this.functions["parent.get"]=function(a,c){window.parent.postMessage({type:"get",name:a,value:c},"*")},this.functions["parent.exec"]=function(a,c){window.parent.postMessage({type:"exec",
name:a,value:c},"*")})};a.Parser.prototype.setVariable=function(a,d){this.variables[a]=d};a.Parser.prototype.getVariable=function(a){this.variables.hasOwnProperty(a)||(this.variables[a]=0);return this.variables[a]};a.Parser.prototype.setVector=function(a,d,c){this.vectors[a][d]=c};a.Parser.prototype.getVector=function(a){this.vectors.hasOwnProperty(a)||(this.vectors[a]=[0,0,0]);return this.vectors[a]};a.Parser.prototype.setMatrix=function(a,d,c,b){this.matrices[a][d][c]=b};a.Parser.prototype.getMatrix=
function(a){this.matrices.hasOwnProperty(a)||(this.matrices[a]=[[0,0,0],[0,0,0],[0,0,0]]);return this.matrices[a]};a.Parser.prototype.setFunction=function(a,d){this.functions[a]=d};a.Parser.prototype.getFunction=function(a){this.functions.hasOwnProperty(a)||(this.functions[a]=function(){return 0});return this.functions[a]};a.Parser.prototype.parse=function(g,d){var c=this.tokenizer.tokenize(g);c||(c=[]);for(var b=null,f,d=!d||!1,e=0,l=0,h=0,i,j,k=0,m=c.length;k<m;k++)if(f=c[k],i=f.value,j=f.type,
"identifier"==j&&(k+1<m&&"parentheses"==c[k+1].type&&"("==c[k+1].value?this.getFunction(i):k+1<m&&"square_bracket"==c[k+1].type&&"["==c[k+1].value?c[k+3]&&"square_bracket"==c[k+3].type&&"]"==c[k+3].value?this.getVector(i):this.getMatrix(i):this.getVariable(i)),"asign"==j&&d&&(j="compOperator",i="=="),"asign"==j)if(f=new a.Node(j,i),null!=b)if("identifier"==b.type)b.parent&&b.parent.replaceLastChild(f),f.addChild(b),b=f,d=!0;else if("square_bracket"==b.type)f.addChild(b.parent),b=f,d=!0;else{f.type=
"compOperator";f.value="==";for(d=!0;b.parent&&this.precedence(b.parent.value)>=this.precedence(f.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(f);f.addChild(b);b=f}else{console.log("Error1: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}else if("parentheses"==j&&"("==i||"square_bracket"==j&&"["==i)if(f=new a.Node(j,i),"("==i&&e++,"["==i&&l++,null==b)"("==i&&(b=new a.Node("(expr)","(expr)"),b.addChild(f)),"["==i&&(b=new a.Node("[expr]","[expr]"),b.addChild(f)),
b=f;else if("operator"==b.type||"boolOperator"==b.type||"compOperator"==b.type||"conditional"==b.type||"asign"==b.type)b.addChild(f),b=f;else if("sign"==b.type)b.addChild(f),b=f;else if("parentheses"==b.type&&"("==b.value)b.addChild(f),b=f;else if("square_bracket"==b.type&&"["==b.value)b.addChild(f),b=f;else if("parentheses"==b.type&&"()"==b.value)b.parent.addChild(f),b=f;else if("square_bracket"==b.type&&"[]"==b.value)b.parent.addChild(f),b=f;else if("identifier"==b.type)b.addChild(f),b=f;else{console.log("Error2: en la expresion <<"+
g+">>, en el token ["+k+"] {valor: "+i+", tipo: "+j+"}");break}else if("parentheses"==j&&")"==i)if(e--,null==b)console.log("Error3: en la expresion <<"+g+">>, en el token (valor:"+i+", tipo:"+j);else{for(;b&&b.parent&&"("!=b.value;)b=b.parent;if(b&&"("==b.value)b.value="()";else{console.log("Error4: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}}else if("square_bracket"==j&&"]"==i)if(l--,null==b)console.log("Error5: en la expresion <<"+g+">>, en el token (valor:"+i+", tipo:"+
j);else{for(;b&&b.parent&&"["!=b.value;)b=b.parent;if(b&&"["==b.value)b.value="[]";else{console.log("Error6: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}}else if("number"==j||"string"==j||"identifier"==j)if(f=new a.Node(j,i),null==b)b=f;else if("operator"==b.type||"compOperator"==b.type||"boolOperator"==b.type||"parentheses"==b.type&&"("==b.value||"square_bracket"==b.type&&"["==b.value||"sign"==b.type||"conditional"==b.type||"asign"==b.type)b.addChild(f),b=f;else{console.log("Error7: en la expresion <<"+
g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}else if("operator"==j||"compOperator"==j||"boolOperator"==j)if(f=new a.Node(j,i),null==b)if("-"==i||"+"==i)f.type="sign",f.value="sign"+i,b=f;else if("!"==i)b=f;else{console.log("Error8: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}else if("operator"==b.type||"compOperator"==b.type||"boolOperator"==b.type||"asign"==b.type||"conditional"==b.type||"square_bracket"==b.type&&"["==b.value&&("-"==i||"+"==i||"!"==i)||"parentheses"==
b.type&&"("==b.value&&("-"==i||"+"==i||"!"==i)){if("-"==i||"+"==i)f.type="sign",f.value="sign"+i;b.addChild(f);b=f}else if("number"==b.type||"parentheses"==b.type&&"()"==b.value||"square_bracket"==b.type&&"[]"==b.value||"string"==b.type||"identifier"==b.type||"conditional"==b.type||"asign"==b.type){for(;b.parent&&this.precedence(b.parent.value)>=this.precedence(f.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(f);f.addChild(b);b=f}else{console.log("Error9: en la expresion <<"+g+">>, en el token {valor: "+
i+", tipo: "+j+"}");break}else if("conditional"==j)if(f=new a.Node(j,i),null!=b)if("?"==f.value){for(h++;b.parent&&this.precedence(b.parent.value)>this.precedence(f.value);)b=b.parent;b.parent&&b.parent.replaceLastChild(f);f.addChild(b);b=f}else{for(h--;b&&b.parent&&"?"!=b.value;)b=b.parent;if(b&&"?"==b.value)b.value="?:";else{console.log("Error10: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}}else{console.log("Error11: en la expresion <<"+g+">>, en el token {valor: "+
i+", tipo: "+j+"}");break}else if("separator"==j)if(null!=b)for(;b.parent&&"("!=b.value&&"["!=b.value;)b=b.parent;else{console.log("Error12: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}else{console.log("Error13: en la expresion <<"+g+">>, en el token {valor: "+i+", tipo: "+j+"}");break}0<e&&alert("Error, faltan parentesis por cerrar: "+g);0>e&&alert("Error, faltan parentesis por abrir: "+g);0<l&&alert("Error, faltan corchetes por cerrar: "+g);0>l&&alert("Error, faltan corchetes por abrir: "+
g);0!=h&&alert("Error, condicional incompleta: "+g);return b?b.getRoot():null};a.Parser.prototype.precedence=function(a){switch(a){case "=":return 1;case "(":return 2;case "[":return 2;case "?":return 2;case ":":return 3;case "?:":return 3;case "&":return 6;case "|":return 6;case "<":return 4;case "<=":return 4;case ">":return 4;case ">=":return 4;case "==":return 4;case "!=":return 4;case "+":return 5;case "-":return 5;case "/":return 6;case "*":return 6;case "sign-":return 6;case "sign+":return 6;
case "!":return 7;case "^":return 7;case "%":return 7;default:return 8}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.Evaluator=function(d){this.parent=d;this.parser=new a.Parser;this.variables=this.parser.variables;this.functions=this.parser.functions;this.vectors=this.parser.vectors;this.matrices=this.parser.matrices};a.Evaluator.prototype.setVariable=function(a,c){this.variables[a]=c};a.Evaluator.prototype.getVariable=function(a){return this.variables[a]};
a.Evaluator.prototype.setVector=function(a,c,b){c=0>c?0:g(c);this.vectors[a][c]=b};a.Evaluator.prototype.getVector=function(a,c){c=0>c?0:g(c);return this.vectors[a][c]};a.Evaluator.prototype.setMatrix=function(a,c,b,f){c=0>c?0:g(c);b=0>b?0:g(b);this.matrices[a][c][b]=f};a.Evaluator.prototype.getMatrix=function(a,c,b){c=0>c?0:g(c);b=0>b?0:g(b);return this.matrices[a][c][b]};a.Evaluator.prototype.setFunction=function(a,c){this.functions[a]=c};a.Evaluator.prototype.getFunction=function(a){return this.functions[a]};
a.Evaluator.prototype.evalExpression=function(a,c,b){this.decimals=void 0==c||0>c?2:c;this.fixed=b||!1;a=this.evalAux(a);return void 0==a?0:a};a.Evaluator.prototype.evalAux=function(a){if(null==a)return 0;var c=a.type,b=a.childs,f=a.value;if("number"==c)return parseFloat(f);if("string"==c)return f;if("identifier"==c&&0==b.length){if("rnd"==f)return Math.random();b=this.variables[f];return"object"==typeof b?this.evalAux(b):b}if("square_bracket"==c)return this.evalAux(b[0]);if("identifier"==c&&"square_bracket"==
b[0].type&&1==b[0].childs.length){var e=this.evalAux(b[0].childs[0]);try{return this.vectors[f][0>e?0:g(e)]}catch(l){return 0}}else if("identifier"==c&&"square_bracket"==b[0].type&&1<b[0].childs.length){e=this.evalAux(b[0].childs[0]);b=this.evalAux(b[0].childs[1]);try{return this.matrices[f][0>e?0:g(e)][0>b?0:g(b)]}catch(h){return 0}}else{if("identifier"==c&&"parentheses"==b[0].type){for(var i=[],c=0,e=b[0].childs.length;c<e;c++)i.push(this.evalAux(b[0].childs[c]));if("_Eval_"==f){b="string"==typeof i[0]?
"'"+i[0]+"'":i[0];if(!a.previousExpression||a.previousExpression!=i[0])a.previousExpression=b,a.previousParse=this.parser.parse(b);return this.evalAux(a.previousParse)}return this.functions[f].apply(this,i)}if("operator"==c){c=void 0==this.decimals||0>this.decimals?2:this.decimals;a=this.fixed||!1;e=this.evalAux(b[0]);b=this.evalAux(b[1]);if("+"==f)return"string"===typeof e&&"number"==typeof b?(b=a?b.toFixed(parseFloat(c)):parseFloat(b.toFixed(parseFloat(c))),b=(""+b).replace(".",this.parent.decimal_symbol)+
"",e+b):"number"===typeof e&&"string"==typeof b?(f=a?e.toFixed(parseFloat(c)):parseFloat(e.toFixed(parseFloat(c))),f=(""+f).replace(".",this.parent.decimal_symbol)+"",f+b):e+b;if("-"==f)return e-b;if("*"==f)return e*b;if("/"==f)return e/b;if("%"==f)return e-g(e/b)*b;if("^"==f)return Math.pow(e,b)}else if("compOperator"==c){e=this.evalAux(b[0]);b=this.evalAux(b[1]);if("<"==f)return(e<b)+0;if("<="==f)return(e<=b)+0;if(">"==f)return(e>b)+0;if(">="==f)return(e>=b)+0;if("=="==f)return(e==b)+0;if("!="==
f)return(e!=b)+0}else if("boolOperator"==c){e=1==this.evalAux(b[0])?1:0;if("&"==f)return e?1==this.evalAux(b[1])?1:0:0;if("|"==f)return e?1:1==this.evalAux(b[1])?1:0;if("!"==f)return!e+0}else{if("conditional"==c)return(e=this.evalAux(b[0]))?this.evalAux(b[1]):this.evalAux(b[2]);if("sign"==c)return"sign+"==f?this.evalAux(b[0]):-this.evalAux(b[0]);if("parentheses"==c)return this.evalAux(b[0]);if("(expr)"==c||"[expr]"==c){e=b.length;f=[];if(1==e&&1==b[0].childs.length&&"(expr)"==c)f=this.evalAux(b[0].childs[0]);
else for(c=0;c<e;c++){for(var a=[],i=0,j=b[c].childs.length;i<j;i++)a.push(this.evalAux(b[c].childs[i]));f[c]=a}return f}"asign"==c?(f=b[0],b=b[1],1==f.childs.length&&"square_bracket"==f.childs[0].type?(e=f.childs[0].childs,1==e.length?(e=this.evalAux(e[0]),e=0>e?0:g(e),this.vectors[f.value][e]=this.evalAux(b)):2==e.length&&(c=this.evalAux(e[0]),e=this.evalAux(e[1]),c=0>c?0:g(c),e=0>e?0:g(e),this.matrices[f.value][c][e]=this.evalAux(b))):this.variables[f.value]=this.evalAux(b)):console.log("Error en la evaluacion, expresion desconocida <"+
f+"> \n"+a)}}};return a}(descartesJS||{}),descartesJS=function(a){var g,d,c;if(a.loadLib)return a;var b=2,f=!1;a.RTFNode=function(a,b,d,c){this.evaluator=a;this.type="rtfNode";this.value=b;this.nodeType=d;this.style=c;this.styleString=c.toString();this.color=c.textColor;this.underline=c.textUnderline;this.overline=c.textOverline;this.parent=null;this.childs=[];"textBlock"==this.nodeType?this.draw=this.drawTextBlock:"textLineBlock"==this.nodeType?this.draw=this.drawTextLineBlock:"formula"==this.nodeType?
this.draw=this.drawFormula:"superIndex"==this.nodeType?this.draw=this.drawSuperIndex:"subIndex"==this.nodeType?this.draw=this.drawSubIndex:"dynamicText"==this.nodeType?(this.draw=this.drawDynamicText,this.decimal_symbol=this.evaluator.parent.decimal_symbol):"fraction"==this.nodeType?this.draw=this.drawFraction:"numerator"==this.nodeType||"denominator"==this.nodeType?this.draw=this.drawNumDen:"radical"==this.nodeType?this.draw=this.drawRadical:"limit"==this.nodeType?this.draw=this.drawLimit:"integral"==
this.nodeType?this.draw=this.drawIntegral:"sum"==this.nodeType?this.draw=this.drawSum:"matrix"==this.nodeType?this.draw=this.drawMatrix:"defparts"==this.nodeType?this.draw=this.drawDefparts:"text"==this.nodeType||"newLine"==this.nodeType?this.draw=this.drawText:"mathSymbol"==this.nodeType?this.draw=this.drawMathSymbol:"index"==this.nodeType||"radicand"==this.nodeType||"from"==this.nodeType||"to"==this.nodeType||"what"==this.nodeType||"element"==this.nodeType?this.draw=this.drawGenericBlock:"componentNumCtrl"==
this.nodeType?this.draw=this.drawComponentNumCtrl:"componentSpace"==this.nodeType&&(this.draw=this.drawComponentSpace)};a.RTFNode.prototype.getRoot=function(){return null==this.parent?this:this.parent.getRoot()};a.RTFNode.prototype.addChild=function(a){a.parent=this;this.childs.push(a)};a.RTFNode.prototype.toHTML=function(){var a="";if("textLineBlock"===this.nodeType||"textBlock"===this.nodeType)for(var b=0,d=this.childs.length;b<d;b++)a+=this.childs[b].toHTML();else"text"===this.nodeType?a="<span "+
this.style.toCSS()+">"+this.value+"</span>":"newLine"===this.nodeType&&(a="<br />");return a};c=d=g=0;a.RTFNode.prototype.getTextMetrics=function(){if("textBlock"==this.nodeType)for(var e=0,l=this.childs.length;e<l;e++)this.childs[e].getTextMetrics();else if("textLineBlock"==this.nodeType)this.getBlockMetric();else if("newLine"==this.nodeType){var h=a.getFontMetrics(this.styleString);this.baseline=h.baseline;this.descent=h.descent;this.ascent=h.ascent;this.width=h.width;this.height=h.height}else if("text"==
this.nodeType||"dynamicText"==this.nodeType){h=a.getFontMetrics(this.styleString);this.baseline=h.baseline;this.descent=h.descent;this.ascent=h.ascent;var i=this.value,j;"string"!=typeof this.value&&(e=void 0==this.decimals?b:this.evaluator.evalExpression(this.decimals),j=void 0==this.fixed?f:this.fixed,i=this.evaluator.evalExpression(this.value,e,j),parseFloat(i)==i&&(i=parseFloat(i).toFixed(e),i=j?i:parseFloat(i),i=i.toString().replace(".",this.decimal_symbol)),i+=" ");this.width=a.getTextWidth(i,
this.styleString);this.height=h.height}else if("formula"==this.nodeType)this.getBlockMetric();else if("superIndex"==this.nodeType)j=g,i=d,j=c,e=a.getFontMetrics(this.styleString),h=a.getTextWidth(" ",this.styleString),this.getBlockMetric(),0>this.height&&(this.ascent=e.ascent,this.descent=e.descent,this.height=this.ascent+this.descent,this.width=1.5*h),h=j/2-i+this.height,this.superIndexPos=h-this.ascent,this.ascent=h,this.descent=i,this.baseline=this.ascent,this.height=this.ascent+this.descent;else if("subIndex"==
this.nodeType)j=g,i=d,e=a.getFontMetrics(this.styleString),h=a.getTextWidth(" ",this.styleString),this.getBlockMetric(),0>this.height&&(this.ascent=e.ascent,this.descent=e.descent,this.height=this.ascent+this.descent,this.width=1.5*h),this.subIndexPos=i+1,this.ascent=j,this.descent=this.subIndexPos+this.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent;else if("fraction"==this.nodeType){i=d;j=c;var k=this.childs[0],l=this.childs[1],e=a.getFontMetrics(k.styleString),h=a.getTextWidth(" ",
this.styleString);k.getBlockMetric();l.getBlockMetric();0>k.height&&(k.height=e.height,k.width=h);0>l.height&&(l.height=e.height,l.width=h);this.height=k.height+l.height-1;this.ascent=k.height+j/2-i;this.descent=this.height-this.ascent;this.baseline=this.ascent;this.width=Math.max(k.width,l.width)+h+8}else if("radical"==this.nodeType)i=this.childs[0],e=this.childs[1],i.getBlockMetric(),e.getBlockMetric(),this.ascent=e.height/2<i.height?e.height/2+i.height+2-e.descent:e.ascent+4,this.descent=e.descent,
this.baseline=this.ascent,this.height=this.ascent+this.descent,h=a.getTextWidth(" ",this.styleString),this.width=i.width+e.width+4*h;else if("sum"==this.nodeType)i=this.childs[0],j=this.childs[1],k=this.childs[2],i.getBlockMetric(),j.getBlockMetric(),k.getBlockMetric(),-1==i.ascent&&(h=a.getFontMetrics(i.styleString),i.ascent=h.ascent,i.descent=h.descent,i.height=h.height),-1==j.ascent&&(h=a.getFontMetrics(j.styleString),j.ascent=h.ascent,j.descent=h.descent,j.height=h.height),e=a.getFontMetrics(this.styleString),
this.ascent=e.height+j.height>k.ascent?e.height-e.descent+j.height:k.ascent,this.descent=i.height>k.descent?i.height+e.descent:k.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent,h=this.style.clone(),h.fontType="Times New Roman",h.Bold="bold",h=h.toString(),e=a.getTextWidth(String.fromCharCode(8721),h),h=a.getTextWidth(" ",this.styleString),this.width=Math.max(i.width,j.width,e)+Math.max(k.width,h)+h;else if("integral"==this.nodeType)i=this.childs[0],j=this.childs[1],k=this.childs[2],
i.getBlockMetric(),j.getBlockMetric(),k.getBlockMetric(),-1==i.ascent&&(h=a.getFontMetrics(i.styleString),i.ascent=h.ascent,i.descent=h.descent,i.height=h.height),-1==j.ascent&&(h=a.getFontMetrics(j.styleString),j.ascent=h.ascent,j.descent=h.descent,j.height=h.height),e=a.getFontMetrics(this.styleString),this.ascent=e.height+j.height>k.ascent?e.height-e.descent+j.height:k.ascent,this.descent=i.height>k.descent?i.height+e.descent:k.descent,this.baseline=this.ascent,this.height=this.ascent+this.descent,
h=this.style.clone(),h.fontSize*=1.5,h.fontType="Times New Roman",h.Bold="bold",h=h.toString(),e=a.getTextWidth(String.fromCharCode(8747),h),h=a.getTextWidth(" ",this.styleString),this.width=Math.max(i.width,j.width,e)+Math.max(k.width,h)+2*h;else if("limit"==this.nodeType)i=this.childs[0],j=this.childs[1],k=this.childs[2],e=a.getFontMetrics(this.styleString),i.getBlockMetric(),j.getBlockMetric(),k.getBlockMetric(),-1==i.ascent&&(h=a.getFontMetrics(i.styleString),i.ascent=h.ascent,i.descent=h.descent,
i.height=h.height),-1==j.ascent&&(h=a.getFontMetrics(j.styleString),j.ascent=h.ascent,j.descent=h.descent,j.height=h.height),-1==k.ascent&&(h=a.getFontMetrics(k.styleString),k.ascent=h.ascent,k.descent=h.descent,k.height=h.height),this.ascent=k.ascent,this.descent=Math.max(e.height,k.descent),this.baseline=this.ascent,this.height=this.ascent+this.descent,h=a.getTextWidth(" ",this.styleString),e=a.getTextWidth(" "+String.fromCharCode(8594),this.styleString),0==i.width&&(i.width=h),0==j.width&&(j.width=
h),0==k.width&&(k.width=h),this.width=j.width+i.width+k.width+e+h;else if("matrix"==this.nodeType){h=a.getTextWidth(" ",this.styleString);e=a.getFontMetrics(this.styleString);i=d;j=e.ascent;for(var k=e.descent,m=e.height,o=h,q,p,e=0,l=this.childs.length;e<l;e++)this.childs[e].getBlockMetric(),q=this.childs[e].height,p=this.childs[e].width,m<q&&(m=q,j=this.childs[e].ascent,k=this.childs[e].descent),o<p&&(o=p);this.childWidth=o+2*h;this.childHeight=m;this.childAscent=j;this.childDescent=k;this.height=
this.rows*m;this.ascent=this.height/2+i;this.descent=this.height-this.ascent;this.width=this.columns*this.childWidth+h}else if("defparts"==this.nodeType){h=a.getTextWidth(" ",this.styleString);e=a.getFontMetrics(this.styleString);i=d;j=e.ascent;k=e.descent;m=e.height;o=h;e=0;for(l=this.childs.length;e<l;e++)this.childs[e].getBlockMetric(),q=this.childs[e].height,p=this.childs[e].width,m<q&&(m=q,j=this.childs[e].ascent,k=this.childs[e].descent),o<p&&(o=p);this.childWidth=o+2*h;this.childHeight=m;this.childAscent=
j;this.childDescent=k;this.height=this.parts*m;this.ascent=this.height/2+i;this.descent=this.height-this.ascent;this.width=o+h/2}else"mathSymbol"==this.nodeType?(h=a.getFontMetrics(this.styleString),this.baseline=h.baseline,this.descent=h.descent,this.ascent=h.ascent,this.width=a.getTextWidth(this.value,this.styleString)+a.getTextWidth(" ",this.styleString),this.height=h.height):"componentNumCtrl"==this.nodeType?(this.componentNumCtrl=this.evaluator.parent.getControlByCId(this.value),this.height=
this.ascent=this.descent=this.baseline=0,this.width=this.componentNumCtrl.w):"componentSpace"==this.nodeType?(this.componentSpace=this.evaluator.parent.getSpaceByCId(this.value),this.height=this.ascent=this.descent=this.baseline=0,this.width=this.componentSpace.w):console.log("elemento no conocido",this.nodeType)};a.RTFNode.prototype.getBlockMetric=function(){this.width=0;for(var a=-1,b=-1,f,i=0,j=this.childs.length;i<j;i++){f=this.childs[i];f.getTextMetrics();childAscent=f.ascent;childDescent=f.descent;
this.width+=f.width;var k=childDescent;f=f.height;g=childAscent;d=k;c=f;b<childAscent&&(b=childAscent);a<childDescent&&(a=childDescent)}this.ascent=b;this.descent=a;this.baseline=this.ascent;this.height=this.ascent+this.descent};a.RTFNode.prototype.drawTextBlock=function(a,d,c,g,j,k){this.stableWidth||(this.getTextMetrics(),b=g,f=j);for(var m=j=g=0,o=this.childs.length;m<o;m++)0<m&&(j+=this.childs[m-1].height),"center"==k?g=-this.childs[m].width/2:"right"==k&&(g=-this.childs[m].width),this.childs[m].draw(a,
d+g,c+j)};a.RTFNode.prototype.drawTextLineBlock=function(b,d,c){for(var f=0,g=0,k=this.childs.length;g<k;g++)0<g&&(f+=this.childs[g-1].width,"formula"==this.childs[g-1].nodeType&&(f+=2*a.getTextWidth(" ",this.childs[g].styleString))),this.childs[g].draw(b,d+f,c+this.baseline)};a.RTFNode.prototype.drawFormula=function(b,d,c){for(var f=a.getTextWidth(" ",this.styleString),g=0,k=0,m=this.childs.length;k<m;k++)0<k&&(g+=this.childs[k-1].width),this.childs[k].draw(b,d+f+g,c)};a.RTFNode.prototype.drawText=
function(a,b,d){null!=this.color&&(a.fillStyle=this.color);a.font=this.styleString;a.textAlign="start";a.textBaseline="alphabetic";a.fillText(this.value,b-1,d);if(this.underline){var c="bold"==this.style.textBold,f=c?1:0.5;a.lineWidth=c?2:1;null!=this.color&&(a.strokeStyle=this.color);a.beginPath();a.moveTo(b-1,parseInt(d+this.descent/2)+f);a.lineTo(b-1+this.width,parseInt(d+this.descent/2)+f);a.stroke()}this.overline&&(f=(c="bold"==this.style.textBold)?2:1.5,a.lineWidth=c?2:1,null!=this.color&&(a.strokeStyle=
this.color),a.beginPath(),a.moveTo(b-1,parseInt(d-this.ascent)+f),a.lineTo(b-1+this.width,parseInt(d-this.ascent)+f),a.stroke())};a.RTFNode.prototype.drawDynamicText=function(d,c,g){var i=Math.floor(0.5*a.getTextWidth(" ",this.styleString)),j=void 0==this.decimals?b:this.evaluator.evalExpression(this.decimals),k=void 0==this.fixed?f:this.fixed,m=this.evaluator.evalExpression(this.value,j,k);parseFloat(m)==m&&(m=k?parseFloat(m).toFixed(j):parseFloat(parseFloat(m).toFixed(j)),m=(""+m).replace(".",this.decimal_symbol));
null!=this.color&&(d.fillStyle=this.color);d.font=this.styleString;d.textAlign="start";d.textBaseline="alphabetic";this.width=a.getTextWidth(m,this.styleString);d.fillText(m,i+c,g);this.underline&&(k=(j="bold"==this.style.textBold)?1:0.5,d.lineWidth=j?2:1,null!=this.color&&(d.strokeStyle=this.color),d.beginPath(),d.moveTo(i+c-1,parseInt(g+this.descent/2)+k),d.lineTo(i+c-1+this.width,parseInt(g+this.descent/2)+k),d.stroke());this.overline&&(k=(j="bold"==this.style.textBold)?2:1.5,d.lineWidth=j?2:1,
null!=this.color&&(d.strokeStyle=this.color),d.beginPath(),d.moveTo(i+c-1,parseInt(g-this.ascent)+k),d.lineTo(i+c-1+this.width,parseInt(g-this.ascent)+k),d.stroke());this.width+=2*i};a.RTFNode.prototype.drawRadical=function(b,d,c){var f=Math.floor(a.getTextWidth(" ",this.styleString));this.childs[0].draw(b,d,Math.floor(c+this.childs[1].descent-this.childs[1].height/2-this.childs[0].descent));this.childs[1].draw(b,d+1.5*f+this.childs[0].width,c);b.lineWidth=1;null!=this.color&&(b.strokeStyle=this.color);
b.beginPath();b.moveTo(d,Math.floor(c+this.childs[1].descent-this.childs[1].height/2));b.lineTo(d+this.childs[0].width,Math.floor(c+this.childs[1].descent-this.childs[1].height/2));b.lineTo(d+this.childs[0].width+0.5*f,c+this.childs[1].descent);b.lineTo(d+this.childs[0].width+1*f,c-this.childs[1].ascent);b.lineTo(d+this.childs[0].width+2*f+this.childs[1].width,c-this.childs[1].ascent);b.stroke()};a.RTFNode.prototype.drawFraction=function(b,d,c){this.childs[0].draw(b,d+(this.width-this.childs[0].width)/
2,c-this.ascent);this.childs[1].draw(b,d+(this.width-this.childs[1].width)/2,c-this.ascent+this.childs[0].height-1);var f=Math.floor(0.5*a.getTextWidth(" ",this.styleString));b.lineWidth=1;null!=this.color&&(b.strokeStyle=this.color);b.beginPath();b.moveTo(d+f,parseInt(c-this.ascent+this.childs[0].height)+0.5);b.lineTo(d-f+this.width-1,parseInt(c-this.ascent+this.childs[0].height)+0.5);b.stroke()};a.RTFNode.prototype.drawNumDen=function(a,b,d){for(var c=0,f=0,g=this.childs.length;f<g;f++)0<f&&(c+=
this.childs[f-1].width),this.childs[f].draw(a,b+c,d+this.baseline)};a.RTFNode.prototype.drawSubIndex=function(a,b,d){for(var c=0,f=0,g=this.childs.length;f<g;f++)0<f&&(c+=this.childs[f-1].width),this.childs[f].draw(a,b+c,d+this.subIndexPos)};a.RTFNode.prototype.drawSuperIndex=function(a,b,d){for(var c=0,f=0,g=this.childs.length;f<g;f++)0<f&&(c+=this.childs[f-1].width),this.childs[f].draw(a,b+c,d-this.superIndexPos)};a.RTFNode.prototype.drawLimit=function(b,d,c){a.getTextWidth(" ",this.styleString);
var f=a.getFontMetrics(this.styleString),g=" "+String.fromCharCode(8594),k=a.getTextWidth(g,this.styleString);this.childs[0].draw(b,d,c+f.descent+this.childs[0].ascent);this.childs[1].draw(b,d+this.childs[0].width+k,c+f.descent+this.childs[1].ascent);this.childs[2].draw(b,d+k+this.childs[0].width+this.childs[1].width,c);null!=this.color&&(b.fillStyle=this.color);b.font=this.styleString;b.textAlign="start";b.textBaseline="alphabetic";b.fillText("l\u00edm",d+this.childs[0].width,c);b.fillText(g,d+this.childs[0].width,
c+f.descent+this.childs[0].ascent)};a.RTFNode.prototype.drawIntegral=function(b,d,c){var f=this.style.clone();f.fontSize*=1.5;f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),g=a.getTextWidth(String.fromCharCode(8747),f),k=a.getFontMetrics(f),m=Math.max(this.childs[0].width,this.childs[1].width,Math.floor(1.5*g)),o=a.getTextWidth(" ",this.styleString);this.childs[0].draw(b,d+g,c+k.descent+this.childs[0].ascent);this.childs[1].draw(b,d+g+o/2,c-this.ascent+this.childs[1].ascent);this.childs[2].draw(b,
d+m+g,c);null!=this.color&&(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8747),d,c+k.descent/2)};a.RTFNode.prototype.drawSum=function(b,d,c){var f=this.style.clone();f.fontType="Times New Roman";f.Bold="bold";var f=f.toString(),g=a.getTextWidth(String.fromCharCode(8721),f),k=a.getFontMetrics(this.styleString),m=Math.max(this.childs[0].width,this.childs[1].width,g);this.childs[0].draw(b,d+(m-this.childs[0].width)/2,c+k.descent+this.childs[0].ascent);
this.childs[1].draw(b,d+(m-this.childs[1].width)/2,c-k.ascent-this.childs[1].descent);this.childs[2].draw(b,d+m,c);null!=this.color&&(b.fillStyle=this.color);b.font=f;b.textAlign="start";b.textBaseline="alphabetic";b.fillText(String.fromCharCode(8721),d+Math.floor((m-g)/2),c-5)};a.RTFNode.prototype.drawMatrix=function(b,d,c){for(var f,g,k=a.getTextWidth(" ",this.styleString),m=0,o=this.childs.length;m<o;m++)f=m%this.columns,g=Math.floor(m/this.columns),this.childs[m].draw(b,2*k+d+f*this.childWidth,
c-this.ascent+this.childAscent+g*this.childHeight);b.lineWidth=1;null!=this.color&&(b.strokeStyle=this.color);b.beginPath();b.moveTo(Math.floor(d+k)+0.5,c-this.ascent+0.5);b.lineTo(Math.floor(d+k/2)+0.5,c-this.ascent+0.5);b.lineTo(Math.floor(d+k/2)+0.5,c+this.descent+0.5);b.lineTo(Math.floor(d+k)+0.5,c+this.descent+0.5);b.moveTo(Math.floor(d+this.width-k)-0.5,c-this.ascent+0.5);b.lineTo(Math.floor(d+this.width-k/2)-0.5,c-this.ascent+0.5);b.lineTo(Math.floor(d+this.width-k/2)-0.5,c+this.descent+0.5);
b.lineTo(Math.floor(d+this.width-k)-0.5,c+this.descent+0.5);b.stroke()};a.RTFNode.prototype.drawDefparts=function(b,d,c){for(var f=a.getTextWidth(" ",this.styleString),g=0,k=this.childs.length;g<k;g++)this.childs[g].draw(b,d+f/4,c-this.ascent+this.childAscent+g%this.parts*this.childHeight);b.lineWidth=1;null!=this.color&&(b.strokeStyle=this.color);b.beginPath();b.moveTo(Math.floor(d+f/3)+0.5,c-this.ascent+0.5);b.lineTo(Math.floor(d+f/6)+0.5,c-this.ascent+0.5+(f/3-f/6));b.lineTo(Math.floor(d+f/6)+
0.5,c+this.descent-this.height/2-(f/3-f/6));b.lineTo(d+0.5,c+this.descent-this.height/2);b.lineTo(Math.floor(d+f/6)+0.5,c+this.descent-this.height/2+(f/3-f/6));b.lineTo(Math.floor(d+f/6)+0.5,c+this.descent+0.5-(f/3-f/6));b.lineTo(Math.floor(d+f/3)+0.5,c+this.descent+0.5);b.stroke()};a.RTFNode.prototype.drawMathSymbol=function(b,d,c){var f=a.getTextWidth(" ",this.styleString);b.lineWidth=1;null!=this.color&&(b.strokeStyle=this.color,b.fillStyle=this.color);b.beginPath();"("==this.value?(b.moveTo(d+
f,c-this.parent.ascent+this.height/10),b.quadraticCurveTo(d+f/5,c+this.parent.descent-this.parent.height/2,d+f,c+this.parent.descent-this.height/10),b.stroke()):")"==this.value?(b.moveTo(d+f,c-this.parent.ascent+this.height/10),b.quadraticCurveTo(d+f+4*f/5,c+this.parent.descent-this.parent.height/2,d+f,c+this.parent.descent-this.height/10),b.stroke()):(b.font=this.styleString,b.textAlign="center",b.textBaseline="alphabetic",b.fillText(this.value,d+this.width/2,c))};a.RTFNode.prototype.drawGenericBlock=
function(a,b,d){for(var c=0,f=0,g=this.childs.length;f<g;f++)0<f&&(c+=this.childs[f-1].width),this.childs[f].draw(a,b+c,d)};a.RTFNode.prototype.drawComponentNumCtrl=function(a,b,d){this.getTextMetrics();this.componentNumCtrl.expresion=this.evaluator.parser.parse("("+b+","+(d-this.parent.ascent)+","+this.componentNumCtrl.w+","+this.componentNumCtrl.h+")")};a.RTFNode.prototype.drawComponentSpace=function(a,b,d){this.getTextMetrics();this.componentSpace.xExpr=this.evaluator.parser.parse(b+"");this.componentSpace.yExpr=
this.evaluator.parser.parse(d-this.parent.ascent+"")};a.RTFNode.prototype.draw=function(a,b,d){console.log(">>> Dibujo desconocido ",this.nodeType);this.childs[0].draw(a,b,d)};a.getFontMetrics=function(a){var b=document.createElement("span");b.setAttribute("style","font: "+a+"; margin: 0; padding: 0;");b.appendChild(document.createTextNode("\u00c1p Texto"));a=document.createElement("div");a.setAttribute("style","display: inline-block; width: 1px; height: 0px;");var d=document.createElement("div");
d.setAttribute("style","margin: 0; padding: 0;");d.appendChild(b);d.appendChild(a);document.body.appendChild(d);var c={};a.style.verticalAlign="baseline";c.ascent=a.offsetTop-b.offsetTop;a.style.verticalAlign="bottom";c.height=a.offsetTop-b.offsetTop;c.descent=c.height-c.ascent;c.baseline=c.ascent;document.body.removeChild(d);return c};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.RTFTokenizer=function(){};a.RTFTokenizer.prototype.tokenize=function(a){a&&(a=a.replace(/(\\\w+)(\\u\d+)/g,
"$1 $2"),a=a.replace(/\\u(\d+) /g,function(a,b){return String.fromCharCode(parseInt(b))}),a=a.replace(/\'/g,"&squot;"),a=a.replace(/&amp;/g,"&"),a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"));for(var d=[],c=a,b=0,f=0,e,l,h,i,j=function(a,f,e){d.push({type:a,value:f});c=c.slice(e);b=b+e};a&&b<a.length;)if(l=b,"{"==c[0])f++,j("openBlock",f,1);else if("}"==c[0])j("closeBlock",f,1),f--,""==c&&(b=a.length);else if((e=c.match(/^\\([\w\*]*)\\/))&&e[1])e=e[1],j("controlWord",e,e.length+1),b-=1;else if((e=
c.match(/^\\(\w*)\s/))&&e[1])e=e[1],j("controlWord",e,e.length+2);else if((e=c.match(/^\\(\w*)\{/))&&e[1])e=e[1],j("controlWord",e,e.length+1),b-=1;else if((e=c.match(/^\\(\w*)\}/))&&e[1])e=e[1],j("controlWord",e,e.length+1),b-=1;else if((e=c.match(/^\\(\w*)\;\\/))&&e[1])e=e[1],j("controlWord",e,e.length+2),b-=1;else if((e=c.match(/^\\(\w*)\;\}/))&&e[1])e=e[1],j("controlWord",e,e.length+2),b-=1;else if((e=c.match(/^\\(\w*)/))&&e[1])e=e[1],j("controlWord",e,e.length+1),b=a.length;else if("{"!=c[0]&&
"}"!=c[0]&&"\\"!=c[0])e=c.indexOf("{"),l=c.indexOf("}"),h=c.indexOf("\\"),i=c.length,e=-1==e?i+1:e,l=-1==l?i+1:l,h=-1==h?i+1:h,e=Math.min(e,l,h),-1!=e&&0!=e?(j("text",c.substring(0,e),e),""==c&&(b=a.length)):(j("text",c,c.length+1),b=a.length);else if(l==b){console.log("Error, simbolo no conocido: <<["+c+"]>>");return}return d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.RTFParser=function(g){this.evaluator=g;this.tokenizer=new a.RTFTokenizer};a.RTFParser.prototype.parse=
function(g){var g=this.tokenizer.tokenize(g),g=checkMathSymboslInFormula(g),d={},c,b=2;if("openBlock"==g[0].type&&"fonttbl"==g[1].value){for(c=g[0].value;"closeBlock"!=g[b].type&&g[b].value!=c;)d[g[b].value]=g[b+2].value.substring(0,g[b+2].value.length-1),b+=3;b++}var f={},e=0,l,h,i;if("openBlock"==g[b].type&&"colortbl"==g[b+1].value){c=g[b++].value;for(b++;"closeBlock"!=g[b].type&&g[b].value!=c;)l=parseInt(g[b++].value.substring(3)).toString(16),h=parseInt(g[b++].value.substring(5)).toString(16),
i=parseInt(g[b++].value.substring(4)).toString(16),f[e++]="#"+(2>l.length?"0"+l:l)+(2>h.length?"0"+h:h)+(2>i.length?"0"+i:i);b++}c=new a.RTFNode(this.evaluator,"","textBlock","",!1,"");e=new a.RTFNode(this.evaluator,"","textLineBlock","",!1,"");c.addChild(e);for(var j,k,m,o=i=h=l=!1,q=!1,p=!1,r=[new a.FontStyle(20,"Arial","","",!1,!1,null)],n=r[0],t=!0,v=-1,u=-1,s=[],y=!1,x=!1,z=!1,B=g.length;b<B;b++)if("controlWord"==g[b].type&&d[g[b].value])n.fontType=d[g[b].value];else if("controlWord"==g[b].type&&
g[b].value.match(/^fs(\d+)/))n.fontSize=parseInt(g[b].value.match(/^fs(\d+)/)[1]/2);else if("controlWord"==g[b].type&&"b"==g[b].value)n.textBold="bold";else if("controlWord"==g[b].type&&"b0"==g[b].value)n.textBold="";else if("controlWord"==g[b].type&&"i"==g[b].value)n.textItalic="italic";else if("controlWord"==g[b].type&&"i0"==g[b].value)n.textItalic="";else if("controlWord"==g[b].type&&"ul"==g[b].value)n.textUnderline=!0;else if("controlWord"==g[b].type&&"ulnone"==g[b].value)n.textUnderline=!1;else if("controlWord"==
g[b].type&&"ol"==g[b].value)n.textOverline=!0;else if("controlWord"==g[b].type&&"olnone"==g[b].value)n.textOverline=!1;else if("controlWord"==g[b].type&&g[b].value.match(/^cf(\d+)/))n.textColor=f[parseInt(g[b].value.substring(2))];else if("openBlock"==g[b].type)v=g[b].value,n=n.clone(),r.push(n),s.push(null);else if("closeBlock"==g[b].type)g[b].value==u&&(u=-1,l=!1),r.pop(),n=r[r.length-1],s.pop();else if("controlWord"==g[b].type&&"par"==g[b].value){e.addChild(new a.RTFNode(this.evaluator,"","newLine",
n));c=new a.RTFNode(this.evaluator,"","textLineBlock",n);if("textBlock"!=e.nodeType)for(e=e.parent;"textBlock"!=e.nodeType;)e=e.parent;e.addChild(c);e=c}else if("controlWord"==g[b].type&&"mjaformula"==g[b].value)y=!0,u=v,l=!0,c=new a.RTFNode(this.evaluator,"","formula",n.clone()),e.addChild(c),e=c,s[s.length-1]=c;else if("controlWord"==g[b].type&&("fraction"==g[b].value||"radicand"==g[b].value||"radical"==g[b].value||"what"==g[b].value||"sum"==g[b].value||"integral"==g[b].value||"limit"==g[b].value)){var w=
s[s.length-2].style.clone();c=new a.RTFNode(this.evaluator,"",g[b].value,w);s[s.length-2].addChild(c);s[s.length-1]=c}else if("controlWord"==g[b].type&&"index"==g[b].value||"to"==g[b].value||"from"==g[b].value)w=s[s.length-2].style.clone(),w.fontSize=parseInt(w.fontSize-0.2*w.fontSize),8>w.fontSize&&(w.fontSize=8),c=new a.RTFNode(this.evaluator,"",g[b].value,w),s[s.length-2].addChild(c),s[s.length-1]=c;else if("controlWord"==g[b].type&&("num"==g[b].value||"den"==g[b].value))w=s[s.length-2].style.clone(),
w.fontSize=Math.round(w.fontSize-0.1*w.fontSize),8>w.fontSize&&(w.fontSize=8),"num"==g[b].value?c=new a.RTFNode(this.evaluator,"","numerator",w):"den"==g[b].value&&(c=new a.RTFNode(this.evaluator,"","denominator",w)),s[s.length-2].addChild(c),s[s.length-1]=c;else if("controlWord"==g[b].type&&("subix"==g[b].value||"supix"==g[b].value))w=s[s.length-2].style.clone(),w.fontSize=Math.floor(w.fontSize-w.fontSize/3),8>w.fontSize&&(w.fontSize=8),"subix"==g[b].value?c=new a.RTFNode(this.evaluator,"","subIndex",
w):"supix"==g[b].value&&(c=new a.RTFNode(this.evaluator,"","superIndex",w)),c.originalStyle=s[s.length-2].style.clone(),s[s.length-2].addChild(c),s[s.length-1]=c;else if("controlWord"==g[b].type&&("defparts"==g[b].value||"matrix"==g[b].value||"element"==g[b].value))w=s[s.length-2].style.clone(),c=new a.RTFNode(this.evaluator,"",g[b].value,w),s[s.length-2].addChild(c),s[s.length-1]=c,"defparts"==g[b].value?m=c:"matrix"==g[b].value&&(k=c);else if("controlWord"==g[b].type&&"parts"==g[b].value)p=!0;else if("text"==
g[b].type&&p)m.parts=parseInt(g[b].value),p=!1;else if("controlWord"==g[b].type&&"rows"==g[b].value)o=!0;else if("text"==g[b].type&&o)k.rows=parseInt(g[b].value),o=!1;else if("controlWord"==g[b].type&&"columns"==g[b].value)q=!0;else if("text"==g[b].type&&q)k.columns=parseInt(g[b].value),q=!1;else if("controlWord"==g[b].type&&"expr"==g[b].value)t=!1,h=!0;else if("controlWord"==g[b].type&&"decimals"==g[b].value)i=!0;else if("text"==g[b].type&&i)j.decimals=this.evaluator.parser.parse(g[b].value),i=!1;
else if("controlWord"==g[b].type&&"fixed1"==g[b].value)j.fixed=!0;else if("controlWord"==g[b].type&&"fixed0"==g[b].value)j.fixed=!1;else if(!("controlWord"==g[b].type&&"component"==g[b].value))if("controlWord"==g[b].type&&"NumCtrl"==g[b].value)x=!0;else if("controlWord"==g[b].type&&"Space"==g[b].value)z=!0;else if("text"==g[b].type&&x)c=new a.RTFNode(this.evaluator,g[b].value,"componentNumCtrl",n.clone()),e.addChild(c),x=!1;else if("text"==g[b].type&&z)c=new a.RTFNode(this.evaluator,g[b].value,"componentSpace",
n.clone()),e.addChild(c),z=!1;else if("text"==g[b].type&&h)w=s[s.length-2].style.clone(),textContent=this.evaluator.parser.parse("''+("+g[b].value+")"),c=new a.RTFNode(this.evaluator,textContent,"dynamicText",w),s[s.length-2].addChild(c),j=s[s.length-1]=c,h=!1;else if("text"==g[b].type&&!h&&!l){textContent=g[b].value;c=new a.RTFNode(this.evaluator,textContent,"text",n.clone());if("textLineBlock"!=e.nodeType)for(e=e.parent;"textLineBlock"!=e.nodeType;)e=e.parent;e.addChild(c)}else if("text"==g[b].type&&
!h&&l)textContent=g[b].value,c=new a.RTFNode(this.evaluator,textContent,"text",s[s.length-1].style.clone()),s[s.length-1].addChild(c);else if("("==g[b].type||")"==g[b].type||"+"==g[b].type||"-"==g[b].type||"*"==g[b].type||"="==g[b].type)c=new a.RTFNode(this.evaluator,g[b].type,"mathSymbol",s[s.length-1].style.clone()),s[s.length-1].addChild(c);if(null!=e){var A=e.getRoot();A.stableWidth=t;A.getTextMetrics();A.hasFormula=y}return A};a.FontStyle=function(a,d,c,b,f,e,l){this.fontSize=a;this.fontType=
d;this.textItalic=c;this.textBold=b;this.textUnderline=f;this.textOverline=e;this.textColor=l};a.FontStyle.prototype.toString=function(){return(this.textBold+" "+this.textItalic+" "+this.fontSize+"px "+this.fontType).trim()};a.FontStyle.prototype.toCSS=function(){var a="style='font-family: "+this.fontType+"; font-size: "+this.fontSize+"px; ";this.textUnderline&&!this.textOverline&&(a+="text-decoration: underline; ");!this.textUnderline&&this.textOverline&&(a+="text-decoration: overline; ");this.textUnderline&&
this.textOverline&&(a+="text-decoration: underline overline; ");this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: bold; ");!this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: normal; ");this.textBold&&this.textItalic&&(a+="font-style: italic; font-weight: bold; ");!this.textBold&&!this.textItalic&&(a+="font-style: normal; font-weight: normal; ");this.textColor&&(a+="color: "+this.textColor+"; ");return a+"'"};a.FontStyle.prototype.clone=function(){return new a.FontStyle(this.fontSize,
this.fontType,this.textItalic,this.textBold,this.textUnderline,this.textOverline,this.textColor)};checkMathSymboslInFormula=function(a){for(var d=[],c=!1,b=!1,f=[],e=0,l=a.length;e<l;e++){"openBlock"==a[e].type&&f.push(a[e].value);"closeBlock"==a[e].type&&(f.pop(),0>=f.length&&(c=!1));if("controlWord"==a[e].type&&("expr"==a[e].value||"decimals"==a[e].value))b=!0;"controlWord"==a[e].type&&"mjaformula"==a[e].value&&(c=!0);if("text"==a[e].type&&c&&!b){for(var h=0,i=a[e].value,j="",k=0,m=i.length;k<m;k++)if("("==
i.charAt(k)||")"==i.charAt(k)||"+"==i.charAt(k)||"-"==i.charAt(k)||"*"==i.charAt(k)||"="==i.charAt(k))j=i.substring(h,k),""!=j&&d.push({type:"text",value:j}),d.push({type:i.charAt(k),value:i.charAt(k)}),h=k+1;j=i.substring(h,k);""!=j&&d.push({type:"text",value:j})}else d.push(a[e]),"text"==a[e].type&&b&&(b=!1)}return d};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor;a.Space=function(a,c){this.parent=a;this.evaluator=this.parent.evaluator;var b=this.evaluator.parser;
this.values=c;this.type="R2";this.xExpr=b.parse("0");this.yExpr=b.parse("0");this.w=parseInt(a.container.width);this.h=parseInt(a.container.height);this.drawif=b.parse("1");this.fixed=2!=this.parent.version?!1:!0;this.scale=48;this.Oy=this.Ox=0;this.image=new Image;this.image.onload=function(){this.ready=1};this.imageSrc="";this.bg_display="topleft";this.background="descinst.com.mja.descartes.DescartesJS.class"==this.parent.code?"#f0f8fa":"#ffffff";this.net=2!=this.parent.version?"#c0c0c0":"";this.net10=
2!=this.parent.version?"#808080":"";this.axes=2!=this.parent.version?"#808080":"";this.text="#ffafaf";this.numbers=!1;this.y_axis=this.x_axis="";this.sensitive_to_mouse_movements=!1;this.cID="";this.mouse_y=this.mouse_x=0;this.ctrs=[];this.graphics=[];this.zIndex=a.zIndex;this.plecaHeight=this.parent.plecaHeight||0;this.displaceRegionNorth=this.parent.displaceRegionNorth||0;this.displaceRegionWest=this.parent.displaceRegionWest||0;for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.init()};a.Space.prototype.init=
function(){this.displaceRegionNorth=this.parent.displaceRegionNorth||0;this.displaceRegionWest=this.parent.displaceRegionWest||0;var a=this.parent,c=this.evaluator,b=this.id,f,e=parseInt(this.parent.container.height),g=parseInt(this.parent.container.width);c.setVariable(b+"._w",this.w);c.setVariable(b+"._h",this.h);this.x=c.evalExpression(this.xExpr)+this.displaceRegionWest;this.y=c.evalExpression(this.yExpr)+this.plecaHeight+this.displaceRegionNorth;this.container&&(this.container.style.left=this.x+
"px",this.container.style.top=this.y+"px");0<=this.y?(f=e-this.y,this.h>f&&(this.h=f)):(f=this.h+this.y,this.h=f>=e?e:f);0<=this.x?(f=g-this.x,this.w>f&&(this.w=f)):(f=this.w+this.x,this.w=f>=g?g:f);if(""!=this.imageSrc||!this.imageSrc.toLowerCase().match(/vacio.gif$/))this.image=a.getImage(this.imageSrc);this.OxExpr&&(g=this.OxExpr,"%"==g[g.length-1]?this.Ox=this.w*parseFloat(g)/100:(a=parseFloat(g),a!=g&&(a=0),this.Ox=a));this.OyExpr&&(g=this.OyExpr,"%"==g[g.length-1]?this.Oy=this.h*parseFloat(g)/
100:(a=parseFloat(g),a!=g&&(a=0),this.Oy=a));2!=this.parent.version?(c.setVariable(b+"._w",this.w),c.setVariable(b+"._h",this.h),c.setVariable(b+".escala",this.scale),c.setVariable(b+".Ox",this.Ox),c.setVariable(b+".Oy",this.Oy),c.setVariable(b+".mouse_x",0),c.setVariable(b+".mouse_y",0),c.setVariable(b+".mouse_pressed",0)):(c.setVariable("_w",this.w),c.setVariable("_h",this.h),c.setVariable("escala",this.scale),c.setVariable("Ox",this.Ox),c.setVariable("Oy",this.Oy),c.setVariable("mouse_x",0),c.setVariable("mouse_y",
0),c.setVariable("mouse_pressed",0))};a.Space.prototype.addCtr=function(a){this.ctrs.push(a)};a.Space.prototype.addGraph=function(a){this.graphics.push(a)};a.Space.prototype.getRelativeX=function(a){return(a-g(this.w/2+this.Ox))/this.scale};a.Space.prototype.getRelativeY=function(a){return(-a+g(this.h/2+this.Oy))/this.scale};a.Space.prototype.getAbsoluteX=function(a){return a*this.scale+g(this.w/2+this.Ox)};a.Space.prototype.getAbsoluteY=function(a){return-a*this.scale+g(this.h/2+this.Oy)};a.Space.prototype.findOffset=
function(){var a=this.container,c;for(this.offsetTop=this.offsetLeft=0;a;){c=null;a.getAttribute&&(c=a.getAttribute("class"));if(c&&("DescartesSpace2DContainer"==c||"DescartesAppContainer"==c))this.offsetLeft+=a.offsetLeft,this.offsetTop+=a.offsetTop;a=a.parentNode}};a.Space.prototype.getCursorPosition=function(d){d=a.getCursorPosition(d);return{x:d.x-this.offsetLeft,y:d.y-this.offsetTop}};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;var g=Math.floor,d=Math.round,c=2*Math.PI;
a.Space2D=function(b,d){a.Space.call(this,b,d);this.backgroundCanvas=document.createElement("canvas");this.backgroundCanvas.setAttribute("id",this.id+"_background");this.backgroundCanvas.setAttribute("width",this.w+"px");this.backgroundCanvas.setAttribute("height",this.h+"px");this.backgroundCtx=this.backgroundCanvas.getContext("2d");this.canvas=document.createElement("canvas");this.canvas.setAttribute("id",this.id+"_canvas");this.canvas.setAttribute("width",this.w+"px");this.canvas.setAttribute("height",
this.h+"px");this.canvas.setAttribute("class","DescartesSpace2DCanvas");this.canvas.setAttribute("style","z-index: "+this.zIndex+";");this.ctx=this.canvas.getContext("2d");this.graphicControlContainer=document.createElement("div");this.graphicControlContainer.setAttribute("id",this.id+"_graphicControls");this.graphicControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+this.zIndex+";");this.numericalControlContainer=document.createElement("div");this.numericalControlContainer.setAttribute("id",
this.id+"_numericalControls");this.numericalControlContainer.setAttribute("style","position: absolute; left: 0px; top: 0px; z-index: "+this.zIndex+";");this.container=document.createElement("div");this.container.setAttribute("id",this.id);this.container.setAttribute("class","DescartesSpace2DContainer");this.container.setAttribute("style","left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.container.appendChild(this.backgroundCanvas);this.container.appendChild(this.canvas);this.container.appendChild(this.graphicControlContainer);
this.container.appendChild(this.numericalControlContainer);b.container.insertBefore(this.container,b.loader);this.findOffset();this.drawBefore=this.evaluator.evalExpression(this.drawif);this.registerMouseEvents()};a.extend(a.Space2D,a.Space);a.Space2D.prototype.update=function(a){var d=2!=this.parent.version?this.id+".Ox":"Ox",c=2!=this.parent.version?this.id+".Oy":"Oy",g=2!=this.parent.version?this.id+".escala":"escala",h=this.evaluator;h.setVariable(this.id+"._w",this.w);h.setVariable(this.id+"._h",
this.h);var i=this.x!=h.evalExpression(this.xExpr)+this.displaceRegionWest,j=this.y!=h.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;this.spaceChange=a||i||j||this.drawBefore!=h.evalExpression(this.drawif)||this.Ox!=h.getVariable(d)||this.Oy!=h.getVariable(c)||this.scale!=h.getVariable(g);this.x=i?h.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=j?h.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:this.y;this.Ox=h.getVariable(d);
this.Oy=h.getVariable(c);this.scale=h.getVariable(g);this.drawBefore=h.evalExpression(this.drawif);1.0E-6>this.scale?(this.scale=1.0E-6,h.setVariable(g,0)):1E6<this.scale&&(this.scale=1E6,h.setVariable(g,1E6));i&&(this.container.style.left=this.x+"px");j&&(this.container.style.top=this.y+"px");(i||j)&&this.findOffset();if(h.evalExpression(this.drawif)){this.container.style.display="block";d=0;for(c=this.graphics.length;d<c;d++)a=this.graphics[d],""!=a.trace&&!this.spaceChange&&!this.click&&!a.background&&
a.drawTrace();this.drawBackground();this.draw()}else this.container.style.display="none"};a.Space2D.prototype.drawBackground=function(){if(this.spaceChange){var b=this.evaluator,d=this.backgroundCtx;d.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);d.fillStyle=a.getColor(b,this.background);d.fillRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height);this.image&&""!=this.image.src&&this.image.ready&&this.image.complete&&("topleft"==this.bg_display?d.drawImage(this.image,
0,0):"stretch"==this.bg_display?d.drawImage(this.image,0,0,this.w,this.h):"patch"==this.bg_display?(d.fillStyle=d.createPattern(this.image,"repeat"),d.fillRect(0,0,this.canvas.width,this.canvas.height)):"center"==this.bg_display&&d.drawImage(this.image,(this.w-this.image.width)/2,(this.h-this.image.height)/2));for(var c=this.scale,l=0;c>this.w+this.h;)c/=10,l++;for(;c<(this.w+this.h)/10;)c*=10;d.lineWidth=1;""!=this.net&&(d.strokeStyle=a.getColor(b,this.net),this.drawMarks(d,c/10,-1));""!=this.net10&&
(d.strokeStyle=a.getColor(b,this.net10),this.drawMarks(d,c,-1));""!=this.axes&&(d.strokeStyle=a.getColor(b,this.axes),d.beginPath(),d.moveTo(g(this.w/2+this.Ox)+0.5,0),d.lineTo(g(this.w/2+this.Ox)+0.5,this.h),d.moveTo(0,g(this.h/2+this.Oy)+0.5),d.lineTo(this.w,g(this.h/2+this.Oy)+0.5),d.stroke(),this.drawMarks(d,c,4),this.drawMarks(d,c/2,2),this.drawMarks(d,c/2/5,1));if(""!=this.x_axis||""!=this.y_axis)d.fillStyle=a.getColor(b,this.axes),d.font="12px Arial",d.textAlign="right",d.textBaseline="top",
d.fillText(this.x_axis,g(this.w)-2,g(this.h/2+this.Oy)),d.fillText(this.y_axis,g(this.w/2+this.Ox)-2,0);this.numbers&&""!=this.axes&&(d.fillStyle=a.getColor(b,this.axes),d.font="12px Arial",d.textAlign="start",d.textBaseline="bottom",c>(this.w+this.h)/2?this.drawNumbers(d,c/5,c<=this.scale?l+1:l):c>(this.w+this.h)/4?this.drawNumbers(d,c/2,c<=this.scale?l+1:l):this.drawNumbers(d,c,l));b=0;for(d=this.graphics.length;b<d;b++)c=this.graphics[b],c.background&&c.draw()}};a.Space2D.prototype.draw=function(){var b=
this.ctx;b.clearRect(0,0,this.canvas.width,this.canvas.height);for(var d=0,e=this.graphics.length;d<e;d++){var l=this.graphics[d];l.background||l.draw()}d=0;for(e=this.ctrs.length;d<e;d++)l=this.ctrs[d],"graphic"==l.type&&l.draw();if(""!=this.text&&this.click&&"LEFT"==this.whichButton){b.fillStyle=a.getColor(this.evaluator,this.text);b.strokeStyle=b.fillStyle;b.font="12px Courier New";b.textAlign="center";b.textBaseline="bottom";var d=1>=this.scale?this.mouse_x.toFixed(0):this.mouse_x.toFixed(this.scale.toString().length),
e=1>=this.scale?this.mouse_y.toFixed(0):this.mouse_y.toFixed(this.scale.toString().length),d="("+d+","+e+")",e=b.measureText(d).width,l=this.getAbsoluteX(this.mouse_x),h=this.getAbsoluteY(this.mouse_y),i=g(l),j=g(h-10);i+e/2>this.w?i=this.w-e/2:0>i-e/2&&(i=e/2);j+1>this.h?j=this.h:0>j-14&&(j=15);b.fillText(d,i,j);b.beginPath();b.arc(l,h,2.5,0,c,!0);b.stroke()}};a.Space2D.prototype.drawMarks=function(a,c,e){var l=this.w,h=this.h,i,j=0,k=l,m=0,o=h,q=g(l/2+this.Ox),p=g(h/2+this.Oy);0<=e&&(j=q-e,k=q+
e,m=p-e,o=p+e);a.beginPath();for(e=-d(q/c);(i=q+d(e*c))<l;e++)a.moveTo(i+0.5,m+0.5),a.lineTo(i+0.5,o+0.5);for(e=-d(p/c);(l=p+d(e*c))<h;e++)a.moveTo(j+0.5,l+0.5),a.lineTo(k+0.5,l+0.5);a.stroke()};a.Space2D.prototype.drawNumbers=function(a,c){for(var e=this.w,l=this.h,h,i=g(e/2+this.Ox),j=g(l/2+this.Oy),k=-d(i/c);(h=i+d(k*c))<e;k++)a.fillText(parseFloat((k*c/this.scale).toFixed(4)),h+2,j-2);for(k=-d(j/c);(e=j+d(k*c))<l;k++)a.fillText(parseFloat((-k*c/this.scale).toFixed(4)),i+2,e-2)};a.Space2D.prototype.registerMouseEvents=
function(){function b(a){k.click=1;k.parent.evaluator.setVariable(k.id+".mouse_pressed",1);k.parent.deactivateGraphiControls();h(a);k.parent.update();window.addEventListener("touchmove",j,!1);window.addEventListener("touchend",d,!1);a.preventDefault()}function d(a){k.click=0;k.parent.evaluator.setVariable(k.id+".mouse_pressed",0);window.removeEventListener("touchmove",j,!1);window.removeEventListener("touchend",d,!1);k.parent.update();a.preventDefault();k.parent.update()}function c(a){k.click=1;k.parent.evaluator.setVariable(k.id+
".mouse_pressed",1);k.parent.deactivateGraphiControls();k.whichButton=null==a.which?2>a.button?"LEFT":4==a.button?"MIDDLE":"RIGHT":2>a.which?"LEFT":2==a.which?"MIDDLE":"RIGHT";"RIGHT"==k.whichButton&&(window.addEventListener("mouseup",l,!1),k.fixed||(k.clickPosForZoom=k.getCursorPosition(a).y,k.tempScale=k.scale,window.addEventListener("mousemove",i,!1)));"LEFT"==k.whichButton&&(k.parent.evaluator.setVariable(k.id+".mouse_pressed",1),h(a),window.addEventListener("mousemove",j,!1),window.addEventListener("mouseup",
l,!1));a.preventDefault()}function l(a){k.click=0;k.parent.evaluator.setVariable(k.id+".mouse_pressed",0);a.preventDefault();"RIGHT"==k.whichButton&&window.removeEventListener("mousemove",i,!1);k.sensitive_to_mouse_movements||window.removeEventListener("mousemove",j,!1);window.removeEventListener("mouseup",l,!1);k.parent.update();k.parent.update()}function h(a){k.posAnte=k.getCursorPosition(a);k.mouse_x=k.getRelativeX(k.posAnte.x);k.mouse_y=k.getRelativeY(k.posAnte.y);k.parent.evaluator.setVariable(k.id+
".mouse_x",k.mouse_x);k.parent.evaluator.setVariable(k.id+".mouse_y",k.mouse_y);k.parent.update()}function i(a){k.clickPosForZoomNew=k.getCursorPosition(a).y;k.evaluator.setVariable(2!=k.parent.version?k.id+".escala":"escala",k.tempScale+k.tempScale/45*((k.clickPosForZoom-k.clickPosForZoomNew)/10));k.parent.update();a.preventDefault()}function j(a){if(!k.fixed){k.posNext=k.getCursorPosition(a);var b=g(k.posAnte.x-k.posNext.x),d=g(k.posAnte.y-k.posNext.y),c=2!=k.parent.version?k.id+".Oy":"Oy";k.parent.evaluator.setVariable(2!=
k.parent.version?k.id+".Ox":"Ox",k.Ox-b);k.parent.evaluator.setVariable(c,k.Oy-d);k.posAnte.x-=b;k.posAnte.y-=d}k.click&&h(a);a.preventDefault()}var k=this,m=a.hasTouchSupport;this.canvas.oncontextmenu=function(){return!1};m&&(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("touchmove",h,!1),this.canvas.addEventListener("touchstart",b,!1));m||(this.sensitive_to_mouse_movements&&this.canvas.addEventListener("mousemove",h,!1),this.canvas.addEventListener("mousedown",c,!1))};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.SpaceAP=function(g,d){a.Space.call(this,g,d);this.exportarVars=this.importarVars=null;this.firstUpdate=!0;var c;if(this.file){var b=document.getElementById(this.file);c=b&&"descartes/spaceApFile"==b.type?b.text:a.openExternalFile(this.file);null!=c&&(c=c.split("\n"))}if(c){for(var b="",f=!1,e=0,l=c.length;e<l&&!(c[e].match("<applet")&&(f=!0),f&&(b+=c[e]),c[e].match("</applet"));e++);e=document.createElement("div");e.innerHTML=b;e.firstChild.setAttribute("width",
this.w);e.firstChild.setAttribute("height",this.h);this.descApp=new a.DescartesApp(e.firstChild);this.descApp.container.setAttribute("class","DescartesAppContainer");this.descApp.container.setAttribute("style","position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";");this.parent.container.insertBefore(this.descApp.container,this.parent.loader);b=this.descApp.spaces;e=0;
for(l=b.length;e<l;e++)b[e].findOffset();this.descApp.container.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none";var h=this;this.descApp.update=function(){this.updateAuxiliaries();this.updateEvents();this.updateControls();this.updateSpaces();h.exportar()}}else this.descApp={},this.descApp.container=document.createElement("div"),this.descApp.container.setAttribute("class","DescartesAppContainer"),b="position: absolute; overflow: hidden; background-color: "+this.background+"; width: "+
this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px; z-index: "+this.zIndex+";",this.image&&("topleft"==this.bg_display?b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat;":"stretch"==this.bg_display?b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-size: 100% 100%;":"patch"==this.bg_display?b+="background-image: url("+this.imageSrc+");":"center"==this.bg_display&&(b+="background-image: url("+this.imageSrc+"); background-repeat:no-repeat; background-position: center center;")),
this.descApp.container.setAttribute("style",b),this.parent.container.insertBefore(this.descApp.container,this.parent.loader),this.descApp.container.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none",this.update=function(){}};a.extend(a.SpaceAP,a.Space);a.SpaceAP.prototype.update=function(){var a=this.x!=this.evaluator.evalExpression(this.xExpr),d=this.y!=this.evaluator.evalExpression(this.yExpr)+this.plecaHeight;this.x=a?this.evaluator.evalExpression(this.xExpr):this.x;this.y=
d?this.evaluator.evalExpression(this.yExpr)+this.plecaHeight:this.y;a&&(this.descApp.container.style.left=this.x+"px");d&&(this.descApp.container.style.top=this.y+"px");if(a||d)for(var a=this.descApp.spaces,d=0,c=a.length;d<c;d++)a[d].findOffset();this.descApp.container.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none";if(this.firstUpdate&&(this.firstUpdate=!1,null==this.importarVars)){this.importarVars=[];for(var b in this.evaluator.variables)this.evaluator.variables.hasOwnProperty(b)&&
b.match(/^public./)&&this.importarVars.push({varName:b,value:this.evaluator.getVariable(b)})}this.importar()};a.SpaceAP.prototype.importar=function(){for(var a,d=!1,c=0,b=this.importarVars.length;c<b;c++)a=this.evaluator.getVariable(this.importarVars[c].varName),a!=this.importarVars[c].value&&(this.importarVars[c].value=a,this.descApp.evaluator.setVariable(this.importarVars[c].varName,this.importarVars[c].value),d=!0);d&&this.descApp.update()};a.SpaceAP.prototype.exportar=function(){};return a}(descartesJS||
{}),descartesJS=function(a){if(a.loadLib)return a;a.SpaceHTML_IFrame=function(g,d){a.Space.call(this,g,d);var c=this.parent.evaluator;this.file=this.file.match(/^\[/)&&this.file.match(/\]$/)?c.parser.parse(this.file.substring(1,this.file.length-1)):this.file.match(/^\'/)&&this.file.match(/\'$/)?c.parser.parse(this.file):c.parser.parse("'"+this.file+"'");this.oldFile=c.evalExpression(this.file);this.MyIFrame=document.createElement("iframe");this.MyIFrame.setAttribute("src",this.oldFile);this.MyIFrame.setAttribute("id",
this.id);this.MyIFrame.setAttribute("marginheight",0);this.MyIFrame.setAttribute("marginwidth",0);this.MyIFrame.setAttribute("frameborder",0);this.MyIFrame.setAttribute("scrolling","auto");this.MyIFrame.setAttribute("style","position: absolute; width: "+this.w+"px; height: "+this.h+"px; left: "+this.x+"px; top: "+this.y+"px;");this.MyIFrame.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none";this.parent.container.insertBefore(this.MyIFrame,this.parent.loader);var b=this;this.MyIFrame.onload=
function(){var a=this;b.evaluator.setFunction(b.id+".set",function(b,d){a.contentWindow.postMessage({type:"set",name:b,value:d},"*")});b.evaluator.setFunction(b.id+".update",function(){a.contentWindow.postMessage({type:"update"},"*")});b.evaluator.setFunction(b.id+".get",function(b,d){a.contentWindow.postMessage({type:"get",name:b,value:d},"*")});b.evaluator.setFunction(b.id+".exec",function(b,d){a.contentWindow.postMessage({type:"exec",name:b,value:d},"*")})}};a.extend(a.SpaceHTML_IFrame,a.Space);
a.SpaceHTML_IFrame.prototype.update=function(a){a&&(this.y=this.x=Math.Infinity);var d=this.evaluator,a=this.x!=d.evalExpression(this.xExpr)+this.displaceRegionWest,c=this.y!=d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth;this.x=a?d.evalExpression(this.xExpr)+this.displaceRegionWest:this.x;this.y=c?d.evalExpression(this.yExpr)+this.parent.plecaHeight+this.displaceRegionNorth:this.y;d=d.evalExpression(this.file);d!=this.oldFile&&(this.oldFile=d,this.MyIFrame.setAttribute("src",
d));a&&(this.MyIFrame.style.left=this.x+"px");c&&(this.MyIFrame.style.top=this.y+"px");this.MyIFrame.style.display=this.evaluator.evalExpression(this.drawif)?"block":"none"};return a}(descartesJS||{}),babel=function(a){a.falso=a["false"]=a.fals=a.gezurra=a.faux=a.fals="false";a.verdadero=a["true"]=a.veritable=a.egia=a.vrai=a.verdadeiro=a.veritable="true";a.no=a.ez=a.non=a["n\u00e3o"]="false";a["s\u00ed"]=a.yes=a.bai=a.oui=a.si=a["sim "]="true";a.negro=a.black=a.negre=a.beltza=a.noir=a.preto="#000000";
a.maxenta=a.magenta="#ff00ff";a.azul=a.blue=a.blau=a.urdina=a.bleu="#0000ff";a.turquesa=a.cyan=a.turkesa=a.turquoise="#00ffff";a.verde=a.green=a.verd=a.berdea=a.vert="#00ff00";a.amarillo=a.yellow=a.groc=a.horia=a.jaune=a.amarelo="#ffff00";a.naranja=a.orange=a.taronja=a.laranja=a.laranxa="#ffc800";a.rojo=a.red=a.vermell=a.gorria=a.rouge=a.vermello=a.vermelho="#ff0000";a.pink=a.rosa=a.arrosa=a.rose="#ffafaf";a.grisObscuro=a.darkGray=a.grisFosc=a["gris iluna"]=a.grisObscur=a.grisEscuro=a.cinzaEscuro=
"#404040";a.gris=a.gray=a.grisa=a.cinza="#808080";a.grisClaro=a.lightGray=a.grisClar=a["gris argia"]=a.grisClair=a.cinzaClaro="#c0c0c0";a.blanco=a.white=a.blanc=a.zuria=a.branco="#ffffff";a.escala=a.scale=a.eskala=a["\u00e9chelle"]="scale";a.nombre=a.name=a.nom=a.izena=a.nome="name";a.ikusgai=a["vis\u00edvel"]=a.visible="visible";a.rastro=a.trace=a.rastre=a.arrastoa="trace";a.fondo=a.background=a.fons=a.hondoa=a.fond=a.fundo="background";a.colour=a.color=a.kolorea=a.couleur=a.cor="color";a["par\u00e1metro"]=
a.parameter=a.parametroa=a["par\u00e2metro"]=a["par\u00e0metre"]="parameter";a["sucesi\u00f3n"]=a.sequence=a["successi\u00f3"]=a.segida=a.succession=a["seq\u00fc\u00eancia"]="sequence";a["tama\u00f1o"]=a.size=a.neurria=a.taille=a.tamanho=a["grand\u00e0ria"]="size";a.decimales=a.decimals=a.hamartarra=a["d\u00e9cimales"]=a.decimais="decimals";a.red=a.net=a.xarxa=a.sarea=a["r\u00e9seau"]=a.rede=a.malha="net";a.red10=a.net10=a.xarxa10=a.sarea10=a["r\u00e9seau10"]=a.rede10=a.malha10="net10";a.ejes=a.axes=
a.eixos=a.ardatzak=a.eixes="axes";a.texto=a.text=a.testua=a.texte="text";a["cr\u00e9ditos"]=a.about=a["cr\u00e8dits"]=a.kreditoak=a["cr\u00e9dits"]=a.sobre="about";a.config=a.konfig=a["configura\u00e7\u00e3o"]="config";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.limpiar=a.clear=a.neteja=a.ezabatu=a.nettoye=a.limpar="clear";a.incr=a.gehi=a.incremento="incr";a.min=a.inf="min";a.max=a.sup=a["m\u00e1x"]="max";a.relleno=a.fill=a.ple=a.betea=a.plein=a.recheo=a.preencher="fill";
a["relleno+"]=a["fill+"]=a["ple+"]=a["betea+"]=a["plein+"]=a["recheo+"]=a["preencher+"]="fillP";a["relleno-"]=a["fill-"]=a["ple-"]=a["betea-"]=a["plein-"]=a["recheo-"]=a["preencher-"]="fillM";a.flecha=a.arrow=a.fletxa=a.gezia=a["fl\u00e8che"]=a.frecha=a.seta="arrow";a.ancho=a.width=a.ample=a.zabalera=a.large=a.largura="width";a.punta=a.spear=a.muturra=a.pointe=a.ponta="spear";a["regi\u00f3n"]=a.region=a["regi\u00f3"]=a.eskualde=a["r\u00e9gion"]=a["rexi\u00f3n"]=a["regi\u00e3o"]="region";a.norte=a.north=
a.nord=a.ipar="north";a.sur=a.south=a.sud=a.hego=a.sul="south";a.este=a.east=a.est=a.ekialde=a.leste="east";a.oeste=a.west=a.oest=a.hegoalde=a.ouest="west";a.exterior=a.external=a.kanpoalde=a.externo="external";a["expresi\u00f3n"]=a.expresion=a["expresi\u00f3"]=a.adierazpen=a["express\u00e3o"]="expresion";a.tipo=a.type=a.tipus=a.mota="type";a["posici\u00f3n"]=a.position=a["posici\u00f3"]=a.posizio=a["posi\u00e7\u00e3o"]="position";a["constricci\u00f3n"]=a.constraint=a["constricci\u00f3"]=a.beharte=
a.constriction=a["constrici\u00f3n"]=a["restri\u00e7\u00e3o"]="constraint";a.valor=a.value=a.balio=a.valeur="value";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.curva=a.curve=a.corba=a.kurba=a.courbe="curve";a.texto=a.text=a.testu=a.texte="text";a.punto=a.point=a.punt=a.puntu=a.ponto="point";a.segmento=a.segment=a.zuzenki="segment";a.arco=a.arc=a.arku="arc";a["pol\u00edgono"]=a.polygon=a["pol\u00edgon"]=a.poligono=a.polygone="polygon";
a.imagen=a.image=a.imatge=a.irudi=a.imaxe=a.imagem="image";a["Versi\u00f3n"]=a.Version=a["Versi\u00f3"]=a["Vers\u00e3o"]="version";a.Idioma=a.Language=a.Hizkuntza=a.Langue="language";a["O.x"]="O.x";a["O.y"]="O.y";a.Botones=a.Buttons=a.Botons=a.Botoiak=a.Boutons=a["Bot\u00f3ns"]=a["Bot\u00f5es"]=a.Botons="Buttons";a["Animaci\u00f3n"]=a.Animation=a["Animaci\u00f3"]=a.Animazio=a["Anima\u00e7\u00e3o"]="Animation";a.constante=a.constant=a.Konstante="constant";a.fuente=a.font=a.iturri=a.source=a.fonte=
"font";a["num\u00e9rico"]=a.numeric=a["num\u00e8ric"]=a.zenbakizko=a["num\u00e9rique"]="numeric";a["gr\u00e1fico"]=a.graphic=a["gr\u00e0fic"]=a.grafiko=a.graphique="graphic";a.texto=a.text=a.testu=a.texte="text";a.inicio=a.init=a.inici=a.hasiera=a.commencement=a["in\u00edcio"]="init";a.hacer=a["do"]=a.fer=a.egin=a.faire=a.facer=a.fazer="do";a.mientras=a["while"]=a.mentre=a.bitartean=a["tandis que"]=a.mentres=a.enquanto="while";a.evaluar=a.evaluate=a.avalua=a.ebaluatu=a["\u00e9valuer"]=a.avaliar="evaluate";
a.variable=a.aldagaia=a["vari\u00e1vel"]="variable";a["funci\u00f3n"]=a["function"]=a["funci\u00f3"]=a.funtzio=a.fonction=a["fun\u00e7\u00e3o"]="function";a.algoritmo=a.algorithm=a.algorisme=a.algorithme="algorithm";a.vector=a.array=a.bektore=a.vecteur=a.matriz="array";a["dibujar-si"]=a["draw-if"]=a["marraztu-baldin"]=a["dessiner-si"]=a["debuxar-se"]=a["desenhar-se"]=a["dibuixa-si"]="drawif";a.dominio=a.range=a.domini=a["izate-eremua"]=a.domain=a["dom\u00ednio"]="range";a.pausa=a.delay=a.eten="delay";
a["eje-x"]=a["x-axis"]=a["eix-x"]=a["x-ardatza"]=a["axe-x"]=a["eixe-x"]=a["eixo-x"]="x-axis";a["eje-y"]=a["y-axis"]=a["eix-y"]=a["y-ardatza"]=a["axe-y"]=a["eixe-y"]=a["eixo-y"]="y-axis";a["n\u00fameros"]=a.numbers=a.nombres=a.zenbakiak="numbers";a["exponencial-si"]=a["exponential-if"]=a["esponentzial-baldin"]=a["exponentiel-si"]=a["exponencial-se"]="exponentialif";a.familia=a.family=a["fam\u00edlia"]=a.famille="family";a.intervalo=a.interval=a.tarte=a.intervalle="interval";a.pasos=a.steps=a.passos=
a.pausoak=a.pas="steps";a.centro=a.center=a.centre=a.zentro="center";a.radio=a.radius=a.radi=a.erradio=a.rayon=a.raio="radius";a.fin=a.end=a.fi=a.bukaera=a.fim="end";a["una-sola-vez"]=a["only-once"]=a["una-sola-vegada"]=a["behin-bakarrik"]=a["une-seule-fois"]=a["unha-soa-vez"]=a["apenas-uma-vez"]="onlyOnce";a.siempre=a.always=a.sempre=a.beti=a.toujours="always";a["color-int"]=a["int-colour"]=a["barruko-kolore"]=a["couleur-int"]=a["cor-int"]="colorInt";a.repetir=a.loop=a.repeteix=a.errepikatu=a["r\u00e9p\u00e9ter"]=
"loop";a.controles=a.controls=a.kontrolak=a["contr\u00f4les"]=a.controis="controls";a.animar=a.animate=a.anima=a.animatu=a.animer="animate";a.auto="auto";a.alto=a.height=a.alt=a.altu=a.haut=a.altura="height";a.x=a.left="x";a.y=a.top="y";a.espacio=a.space=a.espai=a.espazio=a.espace=a.espazo=a["espa\u00e7o"]="space";a.Nu="Nu";a.Nv="Nv";a.ancho=a.depth=a.amplada=a.zabalera=a.largeur=a.ancho=a.profundidade=a.amplada="width";a.largo=a.length=a.llargada=a.luzera=a.longueur=a.longo=a.comprimento=a.llargada=
"length";a.alto=a.height=a["al\u00e7ada"]=a.altu=a.hauteur=a.alto=a.altura=a["al\u00e7ada"]="height";a.color_reverso=a.backcolor=a.color_revers=a["atzealde kolorea"]=a.couleur_revers=a.cor_reverso=a.cor_de_fundo="backcolor";a.aristas=a.edges=a.arestes=a.ertzak=a["ar\u00eates"]=a.arestas="edges";a.rotini=a.inirot="inirot";a.posini=a.inipos="inipos";a["tri\u00e1ngulo"]=a.triangle=a.hirukia=a["tri\u00e2ngulo"]="triangle";a.cara=a.face=a.aurpegi="face";a.polireg=a.regpoly=a["pol\u00edgonoRegular"]="polireg";
a.superficie=a.surface=a["superf\u00edcie"]=a.azalera="surface";a.macro=a.makro="macro";a.id="id";a.modelo=a.model=a.eredu=a["mod\u00e8le"]="model";a.color=a.kolore=a.couleur=a.cor="color";a.luz=a.light=a.llum=a.argia=a["lumi\u00e8re"]="light";a.metal=a.metall=a["m\u00e9tal"]="metal";a.alambre=a.wire=a.filferro=a.alanbre=a["fil de fer"]=a.arame="wire";a.cortar=a.split=a.talla=a.moztu=a.couper=a.dividir="split";a.despliegue=a.render=a.desplegament=a.zabaltze=a["d\u00e8ploiement"]=a.despregamento=a.processar=
"render";a.orden=a.sort=a.ordre=a.ordena=a.orde=a.ordenar="sort";a.pintor=a.painter=a.margolari=a.peintre="painter";a["trazado de rayos"]=a["ray trace"]=a["tra\u00e7at de raigs"]=a["izpi trazadura"]=a["trace de rayons"]=a["trazado de raios"]=a["tra\u00e7ado de raios"]="raytrace";a.imagen=a.bg_image=a.imatge=a.irudia=a.imaxe=a.imagem_de_fundo="image";a.despl_imagen=a.bg_display=a.despl_imatge=a["irudi desplazamendu"]=a.despl_image=a.despr_imaxe=a["apresenta\u00e7\u00e3o_de_imagem"]="bg_display";a["arr-izq"]=
a.topleft=a["dalt-esq"]=a["goi-ezk"]=a["au-dessus-gau"]=a["arr-esq"]=a["acima-esquerda"]="topleft";a["expand."]=a.stretch=a.hedatu=a["expandir "]="stretch";a.mosaico=a.patch=a.mosaic=a.mosaiko=a["mosa\u00efque"]="patch";a.centrada=a.center=a.zentratu=a["centr\u00e9e"]=a.centrado="center";a.archivo=a.file=a.fitxer=a.artxibo=a.fichier=a.arquivo="file";a.filas_norte=a.rows_north=a.files_nord=a["HTML kodea"]=a.files_nord=a.filas_norte=a.linhas_norte=a.files_nord="rowsNorth";a.filas_sur=a.rows_south=a.files_sud=
a.ipar_lerro=a.files_sud=a.filas_sur=a.linhas_sul=a.files_sud="rowsSouth";a.ancho_este=a.width_east=a.ample_est=a.hego_lerro=a.ample_est=a.ancho_leste=a.largura_leste=a.ample_est="widthEast";a.ancho_oeste=a.width_west=a.ample_oest=a.ekialde_zabalera=a.ample_ouest=a.ancho_oeste=a.largura_oeste=a.ample_oest="widthWest";a.fijo=a.fixed=a.fix=a.hegoalde_zabalera=a.fixe=a.fixo="fixed";a["Reiniciar Animaci\u00f3n"]=a["Init Animation"]=a["Reinicia Animaci\u00f3"]=a.finko=a["Recommencer l'Animation"]=a["Reiniciar Anima\u00e7\u00e3o"]=
"initAnimation";a["Explicaci\u00f3n"]=a.Explanation=a.Azalpena=a.Explication=a["Explica\u00e7\u00e3o"]=a["Explicaci\u00f3"]="Explanation";a.tooltip=a.dica="tooltip";a.discreto=a.discrete=a.discret=a.diskretu="discrete";a.interfaz=a.gui=a["interf\u00edcie"]=a.interfaze=a["interface"]="gui";a.pulsador=a.spinner=a.polsador=a.pultsadore=a.bouton="spinner";a["campo de texto"]=a.textfield=a["camp de text"]=a["testu esarrua"]=a["champ de texte"]="textfield";a["men\u00fa"]=a.choice=a.menu=a.escolha="menu";
a.barra=a.scrollbar=a.barre="scrollbar";a.opciones=a.options=a.opcions=a.aukerak=a["opci\u00f3ns"]=a["op\u00e7\u00f5es"]="options";a.interior=a.barruko=a["int\u00e9rieur"]="interior";a["condici\u00f3n"]=a.condition=a["condici\u00f3"]=a.baldintza=a["condi\u00e7\u00e3o"]="condition";a["acci\u00f3n"]=a.action=a["acci\u00f3"]=a.ekintza=a["a\u00e7\u00e3o"]="action";a.evento=a.event=a.esdeveniment=a.gertaera=a["\u00e9v\u00e9nement"]="event";a["abrir URL"]=a["open URL"]=a["obre URL"]=a["URL zabaldu"]=a["ouvrir URL"]=
"openURL";a["abrir Escena"]=a["open Scene"]=a["obre Escena"]=a["eszena zabaldu"]=a["ouvrir Escena"]=a["abrir Cena"]="openScene";a["bot\u00f3n"]=a.button=a["bot\u00f3"]=a.botoi=a.bouton=a["bot\u00e3o"]="button";a.mensaje=a.message=a.mezua=a.mensaxe=a.mensagem=a.missatge="message";a.alternar=a.alternate=a.alterna=a.txandakatu=a.alterner="alternate";a["ejecuci\u00f3n"]=a.execution=a["execuci\u00f3"]=a.gauzatze=a["ex\u00e9cution"]=a["execuci\u00f3n"]=a["execu\u00e7\u00e3o"]="execution";a.calcular=a.calculate=
a.calcula=a.kalkulatu=a.calculer="calculate";a.coord_abs=a.abs_coord=a.koor_abs="abs_coord";a.negrita=a.bold=a.negreta=a.lodi=a["caract\u00e8re gras"]=a.negra=a.negrito="bold";a.cursiva=a.italics=a.etzana=a.italique=a["it\u00e1lico"]="italics";a.subrayada=a.underlined=a.subratllat=a.azpimarratua=a.soulignement=a["subli\u00f1ada"]=a.sublinhado="underlined";a.imagen=a.image=a.imatge=a.irundia=a.imaxe=a.imagem="image";a.pos_mensajes=a.msg_pos=a.pos_missatges=a.mezuen_pos=a.pos_messages=a.pos_mensaxes=
"msg_pos";a.izquierda=a.left=a.esquerra=a.eskerrean=a.gauche=a.esquerda=a.esquerda=a.esquerra="left";a.derecha=a.right=a.dreta=a.eskuinan=a.droite=a.dereita=a.direita=a.dreta="right";a["sensible_a_los_movimientos_del_rat\u00f3n"]=a.sensitive_to_mouse_movements=a["sensible_als_moviments_del_ratol\u00ed"]=a["xagu mugimenduarekiko sentikorra"]=a.sensible_aux_mouvements_du_souris=a.sensible_aos_movementos_do_rato=a["sens\u00edvel_aos_movimentos_do_mouse"]="sensitive_to_mouse_movements";a.reproducir=a.play=
a.reprodueix=a.erreproduzitu=a.reproduire=a.reproduzir="playAudio";a["activo-si"]=a["active-if"]=a["actiu-si"]=a["altiboa-baldin"]=a["actif-si"]=a["activo-se"]=a["ativo-se"]="activeif";a.rotfin=a.finrot=a.bukrot="endrot";a.posfin=a.finpos=a.bukpos="endpos";a.editable=a.editagarria=a["edit\u00e1vel"]="editable";a.tipo=a.type=a.tipus=a.mota="type";a.R2="R2";a.R3="R3";a.vectores=a.bektoreak=a.vecteurs=a.vetores=a.vectors="vectors";a["fuente puntos"]=a["font size"]=a["font punts"]=a["puntu iturria"]=
a["source points"]=a["fonte puntos"]=a["fonte pontos"]="font_size";a.SansSerif="SansSerif";a.Serif="Serif";a.Monoespaciada=a.Monospaced=a.Monoespazada="Monospaced";a["ecuaci\u00f3n"]=a.equation=a["equaci\u00f3"]=a.ekuazio=a["\u00e9quation"]=a["equa\u00e7\u00e3o"]="equation";a.punto=a.dot=a.punt=a.puntu=a.point=a.ponto="point";a.escenario=a.scenario=a.escenari=a.agertoki=a["sc\u00e8ne"]=a["cen\u00e1rio"]="scenario";a.cID="cID";a.matriz=a.matrix=a.matriu=a.matrice="matrix";a.filas=a.rows=a.files="rows";
a.columnas=a.columns=a.colonnes="columns";a.solo_texto=a.only_text=a.seulement_texte=a["s\u00f3_texto"]=a.tan_sols_texte="onlyText";a.evaluar=a.evaluate="evaluate";a.respuesta=a.answer="answer";a.decimal_symbol=a["signo decimal"]=a["decimal symbol"]="decimal_symbol";a.info="info";a.color_contorn_text=a.color_text_border=a.color_borde_texto=a.muga_testuaren_kolorea=a.couleur_contour_texte=a.cor_borde_texto=a.colore_bordo_testo=a.cor_borda_texto=a.color_contorn_text="border";a.video=a["vid\u00e9o"]=
"video";a.audio=a["\u00e0udio"]="audio";a.autoplay="autoplay";a.loop="loop";a.poster="poster";a.opacidad=a.opacity=a["opacit\u00e9"]=a.opacitat=a.opacidade="opacity";a.alinear=a.align=a["ali\u00f1ar"]=a.aligner="align";return a}(babel||{}),descartesJS=function(a){if(a.loadLib)return a;a.Vector2D=function(a,d){this.x=a;this.y=d};a.Vector2D.AXIS_X=new a.Vector2D(1,0);a.Vector2D.AXIS_Y=new a.Vector2D(0,1);a.Vector2D.prototype.vectorLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};a.Vector2D.prototype.dotProduct=
function(a){return this.x*a.x+this.y*a.y};a.Vector2D.prototype.angleBetweenVectors=function(a){return Math.acos(this.dotProduct(a)/(this.vectorLength()*a.vectorLength()))};return a}(descartesJS||{}),descartesJS=function(a){if(a.loadLib)return a;a.DescartesApp=function(a){this.applet=a;this.externalVariables={};this.parentContainer=a.parentNode;this.width=a.getAttribute("width");this.height=a.getAttribute("height");this.decimal_symbol=".";this.childs=a.getElementsByTagName("param");this.code=a.getAttribute("code");
this.saveState=[];this.images={};this.images.length=-1;this.audios={};this.audios.length=-1;this.firstRun=!0;this.arquimedes=this.code.match("descinst.DescartesWeb2_0.class");this.init()};a.DescartesApp.prototype.init=function(){this.spaces=[];this.externalSpace={container:document.createElement("div"),controls:[]};this.northSpace={container:document.createElement("div"),controls:[]};this.southSpace={container:document.createElement("div"),controls:[]};this.eastSpace={container:document.createElement("div"),
controls:[]};this.westSpace={container:document.createElement("div"),controls:[]};this.specialSpace={container:document.createElement("div"),controls:[]};this.editableRegion={container:document.createElement("div"),textFields:[]};this.controls=[];this.auxiliaries=[];this.events=[];this.evaluator=new a.Evaluator(this);this.plecaHeight=this.tabindex=this.zIndex=0;this.lessonParser=new a.LessonParser(this);this.numberOfIframes=0;void 0!=this.container&&this.parentContainer.removeChild(this.container);
this.container=document.createElement("div");this.loader=document.createElement("div");this.parentContainer.appendChild(this.container);this.container.width=this.width;this.container.height=this.height;this.container.setAttribute("class","DescartesAppContainer");this.container.setAttribute("style","width: "+this.width+"px; height:"+this.height+"px;");this.container.appendChild(this.loader);this.loader.width=this.width;this.loader.height=this.height;this.loader.setAttribute("class","DescartesLoader");
this.loader.setAttribute("style","width: "+this.width+"px; height:"+this.height+"px; z-index: 1000;");if(this.firstRun){var d=this,c="url("+g(this.loader.width,this.loader.height)+")";this.imageLoader=document.createElement("div");this.imageLoader.width=this.width;this.imageLoader.height=this.height;this.imageLoader.setAttribute("class","DescartesLoaderImage");this.imageLoader.setAttribute("style","background-image: "+c+"; width: "+this.width+"px; height:"+this.height+"px;");this.loader.appendChild(this.imageLoader);
c=new Image;c.onload=function(){d.imageLoader.setAttribute("style","background-image: url("+this.src+"); width: "+d.width+"px; height:"+d.height+"px; top: 0px; left: 0px")};c.src="images/DescartesLoader.png";this.loaderBar=document.createElement("canvas");this.loaderBar.width=this.width;this.loaderBar.height=this.height;this.loaderBar.setAttribute("class","DescartesLoaderBar");this.loaderBar.setAttribute("style","width: "+this.width+"px; height:"+this.height+"px;");this.loaderBar.ctx=this.loaderBar.getContext("2d");
this.loader.appendChild(this.loaderBar);this.barWidth=Math.floor(this.loader.width/10);this.barHeight=Math.floor(this.loader.height/70);this.timer=setInterval(function(){d.drawLoaderGraph(d.loaderBar.ctx,d.loaderBar.width,d.loaderBar.height)},10);this.firstRun=!1;this.initPreloader()}else this.initBuildApp()};a.DescartesApp.prototype.initAudio=function(d){var c=this;this.audios[d]=new Audio(d);this.audios[d].filename=d;var b=function(){this.ready=1},f=function(){!this.canPlayType("audio/"+this.filename.substring(this.filename.length-
3))&&"mp3"==this.filename.substring(this.filename.length-3)?(c.audios[d]=new Audio(this.filename.replace("mp3","ogg")),c.audios[d].filename=this.filename.replace("mp3","ogg"),c.audios[d].addEventListener("canplaythrough",b,!1),c.audios[d].addEventListener("load",b,!1),c.audios[d].addEventListener("error",f,!1),c.audios[d].load()):(console.log("El archivo '"+d+"' no puede ser reproducido"),this.errorload=1)};this.audios[d].addEventListener("canplaythrough",b,!1);this.audios[d].addEventListener("load",
b,!1);this.audios[d].addEventListener("error",f,!1);a.hasTouchSupport?(this.audios[d].load(),this.audios[d].play(),setTimeout(function(){console.log("detenido");c.audios[d].pause()},10),this.audios[d].ready=1):this.audios[d].load()};a.DescartesApp.prototype.initPreloader=function(){for(var a=0,c=this.childs.length;a<c;a++){var b=this.childs[a].value.match(/[\w-//]*(.png|.jpg|.gif|.svg|.PNG|.JPG|.GIF|.SVG)/g);if(b)for(var f,e=0,g=b.length;e<g;e++)f=b[e],!f.toLowerCase().match(/vacio.gif$/)&&""!=f.substring(0,
f.length-4)&&(this.images[f]=new Image,this.images[f].addEventListener("load",function(){this.ready=1},!1),this.images[f].addEventListener("error",function(){this.errorload=1},!1),this.images[f].src=f);if(b=this.childs[a].value.match(/[\w-//]*(.mp3|.wav|.MP3|.WAV)/g)){e=0;for(g=b.length;e<g;e++)f=b[e],this.initAudio(f)}this.childs[a].value.match(/vector|array|bektore|vecteur|matriz/g)&&this.childs[a].value.match(/archivo|file|fitxer|artxibo|fichier|arquivo/g)&&this.lessonParser.parseAuxiliar(this.childs[a].value)}var h=
this,i;for(i in this.images)this.images.hasOwnProperty(i)&&this.images.length++;for(i in this.audios)this.audios.hasOwnProperty(i)&&this.audios.length++;var j=function(){h.readys=0;var a=h.images.length,b;for(b in h.images)h.images.hasOwnProperty(b)&&(h.images[b].ready||h.images[b].errorload)&&h.readys++;var d=h.audios.length;for(b in h.audios)h.audios.hasOwnProperty(b)&&(h.audios[b].ready||h.audios[b].errorload)&&h.readys++;h.readys!=a+d?setTimeout(j,30):h.initBuildApp()};j()};a.DescartesApp.prototype.getImage=
function(a){if(a)return this.images[a]||(this.images[a]=new Image,this.images[a].src=a,this.images[a].addEventListener("load",function(){this.ready=1},!1),this.images[a].addEventListener("error",function(){this.errorload=1},!1)),this.images[a]};a.DescartesApp.prototype.getAudio=function(a){var c=this;if(!this.audios[a]){this.audios[a]=new Audio(a);this.audios[a].addEventListener("canplaythrough",function(){this.ready=1},!1);var b=function(){!this.canPlayType("audio/"+a.substring(a.length-3))&&"mp3"==
a.substring(a.length-3)?(c.audios[a]=new Audio(a.replace("mp3","ogg")),c.audios[a].addEventListener("canplaythrough",onCanPlayThrough,!1),c.audios[a].addEventListener("load",onCanPlayThrough,!1),c.audios[a].addEventListener("error",b,!1),c.audios[a].load()):(console.log("El archivo '"+a+"' no puede ser reproducido"),this.errorload=1)};this.audios[a].addEventListener("error",b,!1);this.audios[a].play();setTimeout(function(){c.audios[a].pause()},10)}return this.audios[a]};a.DescartesApp.prototype.drawLoaderGraph=
function(a,c,b){var f=2*(this.barWidth-2)/(this.images.length+this.audios.length);a.translate(c/2,b-50);a.scale(2,2);a.strokeRect(-this.barWidth,-this.barHeight,2*this.barWidth,this.barHeight);a.fillStyle="gray";a.fillRect(-this.barWidth+2,-this.barHeight+2,2*(this.barWidth-2),this.barHeight-4);a.fillStyle="#1f375d";a.fillRect(-this.barWidth+2,-this.barHeight+2,this.readys*f,this.barHeight-4);a.setTransform(1,0,0,1,0,0)};var g=function(a,c){var b=document.createElement("canvas");b.width=a;b.height=
c;var f=b.getContext("2d");f.save();f.strokeStyle="#1f375d";f.fillStyle="#1f375d";f.lineCap="round";f.lineWidth=2;f.beginPath();f.translate((a-360)/2,(c-195)/2);f.scale(3,3);f.moveTo(3,25);f.lineTo(3,1);f.lineTo(21,1);f.bezierCurveTo(33,1,41,15,41,25);f.stroke();f.beginPath();f.moveTo(1,63);f.lineTo(1,64);f.moveTo(5,62);f.lineTo(5,64);f.moveTo(9,61);f.lineTo(9,64);f.moveTo(13,60);f.lineTo(13,64);f.moveTo(17,58);f.lineTo(17,64);f.moveTo(21,56);f.lineTo(21,64);f.moveTo(25,53);f.lineTo(25,64);f.moveTo(29,
50);f.lineTo(29,64);f.moveTo(33,46);f.lineTo(33,64);f.moveTo(37,41);f.lineTo(37,64);f.moveTo(41,32);f.lineTo(41,64);f.stroke();f.font="20px Arial";f.fillText("escartes",45,33);f.fillText("JS",98,64);f.restore();return b.toDataURL()};a.DescartesApp.prototype.initBuildApp=function(){for(var a=this.childs,c=this.lessonParser,b=[],f=[],e=[],g=[],h=[],i=[],j,k=0,m=a.length;k<m;k++){j=a[k];if("pleca"==j.name){var o=c.parsePleca(j.value,this.width);this.container.insertBefore(o,this.loader);this.plecaHeight=
o.imageHeight?o.imageHeight:o.offsetHeight}"Buttons"==babel[j.name]?this.buttonsConfig=c.parseButtonsConfig(j.value):"decimal_symbol"==babel[j.name]?this.decimal_symbol=j.value:"version"==babel[j.name]?this.version=parseInt(j.value):"language"==babel[j.name]?this.language=j.value:"enable"==babel[j.getAttribute("enable")]?this.enable=babel[j.getAttribute("enable")]:j.name.match("rtf")?g.push("space='descartesJS_scenario' type='text' expresion='[10,20]' background='yes' text='"+j.value+"'"):"E"==j.name.charAt(0)?
(j.value.match(/'HTMLIFrame'/)&&this.numberOfIframes++,b.push(j.value)):"C"==j.name.charAt(0)&&"_"==j.name.charAt(1)?f.push(j.value):"A"==j.name.charAt(0)&&"Animation"!=babel[j.name]?e.push(j.value):"G"==j.name.charAt(0)?g.push(j.value):"S"==j.name.charAt(0)?h.push(j.value):"Animation"==babel[j.name]&&i.push(j.value)}this.scenarioRegion={container:document.createElement("div"),scroll:0};this.scenarioRegion.container.setAttribute("id","descartesJS_Scenario_Region");this.scenarioRegion.scenarioSpace=
this.lessonParser.parseSpace("tipo='R2' id='descartesJS_scenario' x='0' y='0' fijo='yes' red='no' red10='no' ejes='no' text='no' ancho='"+this.width+"' alto='"+this.height+"'");this.scenarioRegion.container.appendChild(this.scenarioRegion.scenarioSpace.container);this.arquimedes&&(this.container.appendChild(this.scenarioRegion.container),this.spaces.push(this.scenarioRegion.scenarioSpace));k=0;for(m=b.length;k<m;k++)a=c.parseSpace(b[k]),this.arquimedes&&this.scenarioRegion.container.appendChild(a.container),
this.spaces.push(a),this.zIndex++;k=0;for(m=g.length;k<m;k++)if(b=c.parseGraphic(g[k]))b.visible&&(this.editableRegionVisible=!0),b.space.addGraph(b);k=0;for(m=h.length;k<m;k++)(b=c.parse3DGraphic(h[k]))&&b.space.addGraph(b);k=0;for(m=f.length;k<m;k++)this.controls.push(c.parseControl(f[k]));k=0;for(m=e.length;k<m;k++)c.parseAuxiliar(e[k]);k=0;for(m=i.length;k<m;k++)this.animation=c.parseAnimation(i[k]);this.configRegions();this.updateAuxiliaries();k=0;for(m=this.controls.length;k<m;k++)this.controls[k].init();
this.updateControls();this.updateSpaces(!0);var q=this;this.numberOfIframes?setTimeout(function(){q.finishInit()},250*this.numberOfIframes):this.finishInit()};a.DescartesApp.prototype.finishInit=function(){this.update();this.loader.style.display="none";this.parentContainer.style="overflow: hidden;";clearTimeout(this.timer);this.enable&&(this.blocker=document.createElement("div"),this.blocker.setAttribute("class","blocker"),this.blocker.setAttribute("style","width: "+this.width+"px; height: "+this.height+
"px"),this.container.appendChild(this.blocker))};a.DescartesApp.prototype.configRegions=function(){var d=this.evaluator.parser,c=this.buttonsConfig,b=this.container,f=0,e=0,g=0,h=g=0,i=0,j=0,k=0,m=0,j=this.northSpace.controls,o=this.southSpace.controls,q=this.eastSpace.controls,p=this.westSpace.controls;if(0<c.rowsNorth||0<j.length||c.about||c.config){0>=c.rowsNorth?(f=c.height,c.rowsNorth=1):f=c.height*c.rowsNorth;var r=this.northSpace.container;r.setAttribute("id","descartesJS_northRegion");r.setAttribute("style",
"width: "+b.width+"; height: "+f+"px; background: #c0c0c0; position: absolute; left: 0px; top: 0px; z-index: 100;");b.insertBefore(r,this.loader);var i=b.width,n=0;c.about&&(n=100,i-=n);c.config&&(i-=100);for(var r=Math.ceil(j.length/c.rowsNorth),t=i/r,g=0,v=j.length;g<v;g++)j[g].expresion=d.parse("("+(n+t*(g%r))+","+c.height*Math.floor(g/r)+","+t+","+c.height+")"),j[g].drawif=d.parse("1");if(c.about){var u;"espa\u00f1ol"==this.language?u="cr\u00e9ditos":"english"==this.language&&(u="about");new a.Button(this,
{region:"north",name:u,font_size:d.parse("15"),expresion:d.parse("(0, 0, 100, "+f+")")})}c.config&&("espa\u00f1ol"==this.language?u="config":"english"==this.language&&(u="config"),new a.Button(this,{region:"north",name:u,font_size:d.parse("15"),action:"config",expresion:d.parse("("+(i+100)+", 0, 100, "+f+")")}))}if(0<c.rowsSouth||0<o.length||c.init||c.clear){0>=c.rowsSouth?(e=c.height,c.rowsSouth=1):e=c.height*c.rowsSouth;j=b.width;n=0;c.init&&(n=100,j-=n);c.clear&&(j-=100);r=this.southSpace.container;
r.setAttribute("id","descartesJS_southRegion");r.setAttribute("style","width: "+b.width+"; height: "+e+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+(b.height-e)+"px; z-index: 100;");b.insertBefore(r,this.loader);r=Math.ceil(o.length/c.rowsSouth);t=j/r;g=0;for(v=o.length;g<v;g++)o[g].expresion=d.parse("("+(n+t*(g%r))+","+c.height*Math.floor(g/r)+","+t+","+c.height+")"),o[g].drawif=d.parse("1");c.init&&("espa\u00f1ol"==this.language?u="inicio":"english"==this.language&&(u="init"),
new a.Button(this,{region:"south",name:u,font_size:d.parse("15"),action:"init",expresion:d.parse("(0, 0, 100, "+e+")")}));c.clear&&("espa\u00f1ol"==this.language?u="limpiar":"english"==this.language&&(u="clear"),new a.Button(this,{region:"south",name:u,font_size:d.parse("15"),action:"clear",expresion:d.parse("("+(j+100)+", 0, 100, "+e+")")}))}if(0<q.length){g=b.height-f-e;k=c.widthEast;r=this.eastSpace.container;r.setAttribute("id","descartesJS_eastRegion");r.setAttribute("style","width: "+k+"; height: "+
g+"px; background: #c0c0c0; position: absolute; left: "+(b.width-k)+"px; top: "+f+"px; z-index: 100;");b.insertBefore(r,this.loader);g=0;for(v=q.length;g<v;g++)q[g].expresion=d.parse("(0,"+c.height*g+","+k+","+c.height+")"),q[g].drawif=d.parse("1")}if(0<p.length){g=b.height-f-e;m=c.widthWest;r=this.westSpace.container;r.setAttribute("id","descartesJS_westRegion");r.setAttribute("style","width: "+m+"; height: "+g+"px; background: #c0c0c0; position: absolute; left: 0px; top: "+f+"px; z-index: 100;");
b.insertBefore(r,this.loader);g=0;for(v=p.length;g<v;g++)p[g].expresion=d.parse("(0,"+c.height*g+","+m+","+c.height+")"),p[g].drawif=d.parse("1")}if(this.editableRegionVisible){h=c.height;r=this.editableRegion.container;r.setAttribute("id","descartesJS_editableRegion");r.setAttribute("style","width: "+b.width+"px; height: "+h+"px; position: absolute; left: 0px; top: "+(b.height-e-c.height)+"px; z-index: 100; background: #c0c0c0; overflow: hidden;");b.insertBefore(r,this.loader);d=this.editableRegion.textFields;
c=b.width/d.length;g=0;for(v=d.length;g<v;g++)"div"==d[g].type?(r.appendChild(d[g].container),d[g].container.setAttribute("style","font-family: Arial; width: "+(c-4)+"px; height: "+(h-5)+"px; position: absolute; left: "+g*c+"px; top: 0px; border: 2px groove white;"),p=d[g].container.firstChild,u=p.offsetWidth,p.setAttribute("style","font-family: Arial; padding-top: 0%; background-color: lightgray; position: absolute; left: 0px; top: 0px; width: "+u+"px;"),p.firstChild.textContent=p.firstChild.textContent.substring(1,
p.firstChild.textContent.length-1),d[g].container.lastChild.setAttribute("style","font-family: 'Courier New'; width: "+(c-u-8)+"px; height: "+(h-9)+"px; position: absolute; left: "+u+"px; top: 0px; border: 2px groove white;")):(r.appendChild(d[g]),d[g].setAttribute("style","font-family: 'Courier New'; width: "+c+"px; height: "+h+"px; position: absolute; left: "+g*c+"px; top: 0px; border: 2px groove white;"))}this.displaceRegionNorth=f;this.displaceRegionWest=m;b.width-=k;b.height=b.height-e-h;g=0;
for(v=this.spaces.length;g<v;g++)this.spaces[g].init("joel")};a.DescartesApp.prototype.update=function(){this.updateAuxiliaries();this.updateEvents();this.updateControls();this.updateSpaces()};a.DescartesApp.prototype.deactivateGraphiControls=function(){for(var a,c=0,b=this.controls.length;c<b;c++)a=this.controls[c],"graphic"==a.type&&a.deactivate()};a.DescartesApp.prototype.updateAuxiliaries=function(){for(var a=0,c=this.auxiliaries.length;a<c;a++)this.auxiliaries[a].update()};a.DescartesApp.prototype.updateEvents=
function(){for(var a=0,c=this.events.length;a<c;a++)this.events[a].update()};a.DescartesApp.prototype.updateControls=function(){for(var a=0,c=this.controls.length;a<c;a++)this.controls[a].update()};a.DescartesApp.prototype.updateSpaces=function(a){for(var c=0,b=this.spaces.length;c<b;c++)this.spaces[c].update(a)};a.DescartesApp.prototype.clear=function(){for(var a=0,c=this.spaces.length;a<c;a++)this.spaces[a].spaceChange=!0,this.spaces[a].drawBackground()};a.DescartesApp.prototype.play=function(){this.animation&&
this.animation.play()};a.DescartesApp.prototype.stop=function(){this.animation&&this.animation.stop()};a.DescartesApp.prototype.reinitAnimation=function(){this.animation&&this.animation.reinit()};a.DescartesApp.prototype.getControlById=function(a){for(var c,b=0,f=this.controls.length;b<f;b++)if(c=this.controls[b],c.id==a)return c;return{update:function(){}}};a.DescartesApp.prototype.getSpaceByCId=function(a){for(var c,b=0,f=this.spaces.length;b<f;b++)if(c=this.spaces[b],c.cID==a)return c;return{update:function(){},
w:0}};a.DescartesApp.prototype.getControlByCId=function(a){for(var c,b=0,f=this.controls.length;b<f;b++)if(c=this.controls[b],c.cID==a)return c;return{update:function(){},w:0}};a.DescartesApp.prototype.getState=function(){var a=this.evaluator.variables,c,b="",f;for(f in a)a.hasOwnProperty(f)&&(c=a[f],"string"==typeof c&&(c="'"+c+"'"),"rnd"!=f&&"pi"!=f&&"e"!=f&&"Infinity"!=f&&"-Infinity"!=f&&"object"!=typeof c&&(b=""!=b?b+"\n"+f+"="+c:f+"="+c));return b};a.DescartesApp.prototype.setState=function(a){for(var a=
a.split("\\n"),c,b=0,f=a.length;b<f;b++)c=this.evaluator.parser.parse(a[b],!0),this.evaluator.evalExpression(c),this.saveState.push(c)};a.DescartesApp.prototype.getEvaluation=function(){for(var a=0,c=0,b="",f=0,e=this.controls.length;f<e;f++)"textfield"==this.controls[f].gui&&this.controls[f].evaluate&&(a++,c+=this.controls[f].ok,this.controls[f].value=""==this.controls[f].value?"''":this.controls[f].value,b+=" \\n "+this.controls[f].id+"="+this.controls[f].value+"|"+this.controls[f].ok);return"questions="+
a+" \\n correct="+c+" \\n wrong="+(a-c)+b};a.DescartesApp.prototype.showSolution=function(){for(var a=0,c=this.controls.length;a<c;a++)"textfield"==this.controls[a].gui&&this.controls[a].evaluate&&this.controls[a].changeValue(this.controls[a].getFirstAnswer());this.update()};a.DescartesApp.prototype.showAnswer=function(){for(var a=0,c=this.saveState.length;a<c;a++)this.evaluator.evalExpression(this.saveState[a]);this.update()};return a}(descartesJS||{}),descartesJS=function(a){function g(){var a=
document.getElementById("StyleDescartesApps");a&&a.parentNode.removeChild(a);a=document.createElement("style");a.id="StyleDescartesApps";a.type="text/css";a.setAttribute("rel","stylesheet");a.innerHTML="applet.DescartesJS {display:none;} applet {display:none;}";document.head.appendChild(a)}function d(){for(var b=0,c=a.apps.length;b<c;b++)for(var d=0,g=a.apps[b].spaces.length;d<g;d++)a.apps[b].spaces[d].findOffset()}function c(){a.getFeatures();if(a.hasCanvasSupport){for(var b=document.getElementsByTagName("*"),
c=[],e=0,g=b.length;e<g;e++)"DescartesAppContainer"==b[e].className&&c.push(b[e]);e=0;for(g=c.length;e<g;e++)c[e].parentNode.removeChild(c[e]);for(var c=document.getElementsByTagName("applet"),b=[],g=0,h=c.length;g<h;g++)e=c[g],(e.getAttribute("code").match("DescartesJS")||e.getAttribute("code").match("Descartes.class"))&&b.push(e);e=0;for(g=b.length;e<g;e++)c=b[e],a.apps.push(new a.DescartesApp(c)),c.className="DescartesJS";document.getElementById("StyleDescartesApps").innerHTML="applet.DescartesJS {display:none;}";
window.addEventListener("resize",d,!1)}else document.getElementById("StyleDescartesApps").innerHTML="applet {display:block;}"}a.apps=[];a.getDescartesApps=function(){return a.apps};(!window.hasOwnProperty("debugDescartesJS")||!debugDescartesJS)&&g();a.receiveMessage=function(b){if(0!==a.apps.length)if((b=b.data)&&"set"===b.type)a.apps[0].evaluator.setVariable(b.name,b.value);else if(b&&"update"===b.type)a.apps[0].update();else if(b&&"exec"===b.type){var c=a.apps[0].evaluator.getFunction(b.name),d=
[];""!==b.value&&(d=b.value.toString().split(","));c&&c.apply(a.evaluator,d)}};void 0===a.loadLib&&(a.loadLib=!0,window.addEventListener("load",c,!1),window.addEventListener("message",a.receiveMessage,!1));return a}(descartesJS||{});
